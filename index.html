<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1">
<title>極楽街 — Gokurakugai Fan Community</title>
<link rel="icon" href="favicon-180.png" id="fav">
<link href="https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&family=Cinzel:wght@400;600;700;900&family=Crimson+Pro:ital,wght@0,300;0,400;0,600;1,300;1,400&display=swap" rel="stylesheet">
<style>
/* ════════════════════════════════════════
   VARIABLES
════════════════════════════════════════ */
:root{
  --crimson:#8B1A1A;--crimson-deep:#5C0F0F;--crimson-bright:#C0272D;
  --gold:#C9A84C;--gold-light:#E8C96A;
}
[data-theme="dark"]{
  --bg:#0A0303;--bg2:#130808;--surface:#1A0808;--surface2:#220D0D;--surface3:#2C1010;
  --text:#F0DFC0;--text-dim:#A08060;--text-muted:#6B4A30;
  --accent:var(--gold);--accent2:var(--gold-light);
  --border-img:url('assets/images/light-border.png');
  --pattern:url('assets/images/pattern-dark.png');
  --header-bg:url('assets/images/header-bg-dark.jpg');
  --nav-bg:rgba(10,3,3,0.97);
  --card-bg:rgba(26,8,8,0.93);
  --glow:0 0 18px rgba(201,168,76,0.3);
  --glow2:0 0 35px rgba(201,168,76,0.14);
  --hr:rgba(201,168,76,0.22);
  --modal-bg:rgba(0,0,0,0.9);
  --in-bg:#180606;--in-border:rgba(201,168,76,0.28);
  --tag-bg:rgba(201,168,76,0.1);
  --disc:#5865F2;
}
[data-theme="light"]{
  --bg:#FFF5E8;--bg2:#FAE8D0;--surface:#FFF0E0;--surface2:#FAE5CE;--surface3:#F5D8B8;
  --text:#1A0505;--text-dim:#5C2020;--text-muted:#8B3A3A;
  --accent:var(--crimson);--accent2:var(--crimson-bright);
  --border-img:url('assets/images/dark-border.png');
  --pattern:url('assets/images/pattern-light.png');
  --header-bg:url('assets/images/header-bg-light.jpg');
  --nav-bg:rgba(255,245,232,0.97);
  --card-bg:rgba(255,240,224,0.93);
  --glow:0 0 18px rgba(139,26,26,0.2);
  --glow2:0 0 35px rgba(139,26,26,0.1);
  --hr:rgba(139,26,26,0.22);
  --modal-bg:rgba(40,5,5,0.87);
  --in-bg:#FFF8F0;--in-border:rgba(139,26,26,0.28);
  --tag-bg:rgba(139,26,26,0.08);
  --disc:#5865F2;
}

/* ════════════════════════════════════════
   BASE
════════════════════════════════════════ */
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0;}
html{scroll-behavior:smooth;}
body{font-family:'Crimson Pro',Georgia,serif;background:var(--bg);color:var(--text);min-height:100vh;overflow-x:hidden;transition:background .4s,color .4s;}
body::before{content:'';position:fixed;inset:0;background:var(--pattern);background-size:80px 80px;opacity:.055;pointer-events:none;z-index:0;}
::-webkit-scrollbar{width:5px;}
::-webkit-scrollbar-track{background:var(--bg2);}
::-webkit-scrollbar-thumb{background:var(--accent);border-radius:3px;}
a{color:inherit;text-decoration:none;}
img{max-width:100%;}
p{line-height:1.8;}

/* ════════════════════════════════════════
   COUNTDOWN
════════════════════════════════════════ */
#cd-bar{
  position:sticky;top:0;z-index:101;
  background:linear-gradient(110deg,#3a0a0a,var(--crimson-deep) 40%,var(--crimson) 80%,#3a0a0a);
  color:#fff;text-align:center;padding:.5rem 1rem;
  display:flex;align-items:center;justify-content:center;gap:1rem;flex-wrap:wrap;
  box-shadow:0 2px 12px rgba(0,0,0,.5);
}
#cd-bar.hidden{display:none;}
.cd-label{font-family:'Cinzel',serif;font-size:.65rem;letter-spacing:.22em;opacity:.8;white-space:nowrap;}
.cd-units{display:flex;gap:.6rem;align-items:center;}
.cd-unit{display:flex;flex-direction:column;align-items:center;min-width:38px;}
.cd-n{font-family:'Cinzel',serif;font-size:1.25rem;font-weight:700;line-height:1;text-shadow:0 0 10px rgba(255,255,255,.35);}
.cd-t{font-size:.5rem;letter-spacing:.15em;opacity:.65;text-transform:uppercase;margin-top:.1rem;}
.cd-sep{font-size:1rem;opacity:.45;margin-bottom:.25rem;}
.cd-ev{font-family:'Cinzel',serif;font-size:.68rem;letter-spacing:.14em;opacity:.88;white-space:nowrap;}
.cd-x{cursor:pointer;opacity:.55;font-size:.9rem;padding:.2rem .4rem;background:rgba(255,255,255,.14);border:none;color:#fff;border-radius:2px;transition:opacity .2s;flex-shrink:0;}
.cd-x:hover{opacity:1;}

/* ════════════════════════════════════════
   HEADER
════════════════════════════════════════ */
#hdr{
  position:relative;width:100%;min-height:310px;
  background:var(--header-bg) center/cover no-repeat;
  display:flex;flex-direction:column;align-items:center;justify-content:center;
  overflow:hidden;z-index:1;
}
#hdr::before{
  content:'';position:absolute;inset:0;z-index:1;
  background:linear-gradient(to bottom,rgba(4,0,0,.52) 0%,rgba(4,0,0,.18) 45%,rgba(4,0,0,.72) 100%);
}
[data-theme="light"] #hdr::before{background:linear-gradient(to bottom,rgba(255,240,220,.45) 0%,rgba(255,240,220,.1) 45%,rgba(255,240,220,.62) 100%);}
.hdr-inner{position:relative;z-index:2;text-align:center;padding:1.5rem 1rem;}

/* ── Glitch logo: EN default → glitch → JP → glitch → EN loop ── */
.glitch-wrap{position:relative;display:inline-block;cursor:pointer;height:82px;min-width:180px;}
.logo-en-gl,.logo-jp-gl{
  max-height:82px;width:auto;display:block;
  position:absolute;top:0;left:50%;transform:translateX(-50%);
  filter:drop-shadow(0 0 11px var(--accent));
}
.logo-jp-gl{opacity:0;}
.gl-r,.gl-b{position:absolute;top:0;left:50%;transform:translateX(-50%);pointer-events:none;}
.gl-r img,.gl-b img{max-height:82px;width:auto;display:block;opacity:0;position:relative;}
/* Timing: 8s cycle. EN 0-74%, glitch1 75-77%, JP 78-87%, glitch2 88-89%, EN 90-100% */
.logo-en-gl{animation:enShow 8s steps(1) infinite;}
.logo-jp-gl{animation:jpShow 8s steps(1) infinite;}
.gl-r img{animation:glR2 8s steps(1) infinite;filter:hue-rotate(175deg) saturate(2.5) drop-shadow(3px 0 0 #ff003c);}
.gl-b img{animation:glB2 8s steps(1) infinite;filter:hue-rotate(-50deg) saturate(2.5) drop-shadow(-3px 0 0 #00a8ff);}
@keyframes enShow{
  0%,74.9%{opacity:1;}
  75%,89.9%{opacity:0;}
  90%,100%{opacity:1;}
}
@keyframes jpShow{
  0%,77.9%{opacity:0;}
  78%,87.9%{opacity:1;}
  88%,100%{opacity:0;}
}
@keyframes glR2{
  0%,74.9%,77.9%,89.9%,100%{opacity:0;clip-path:inset(100% 0 0 0);}
  75%{opacity:.85;clip-path:inset(8% 0 68% 0);transform:translateX(-4px);}
  75.5%{opacity:.85;clip-path:inset(45% 0 38% 0);transform:translateX(4px);}
  76%{opacity:.85;clip-path:inset(72% 0 12% 0);transform:translateX(-2px);}
  77%{opacity:0;}
  88%{opacity:.85;clip-path:inset(15% 0 62% 0);transform:translateX(4px);}
  88.5%{opacity:.85;clip-path:inset(55% 0 22% 0);transform:translateX(-4px);}
  89%{opacity:0;}
}
@keyframes glB2{
  0%,74.9%,77.9%,89.9%,100%{opacity:0;clip-path:inset(100% 0 0 0);}
  75%{opacity:.85;clip-path:inset(72% 0 12% 0);transform:translateX(4px);}
  75.5%{opacity:.85;clip-path:inset(38% 0 45% 0);transform:translateX(-4px);}
  76%{opacity:.85;clip-path:inset(8% 0 68% 0);transform:translateX(2px);}
  77%{opacity:0;}
  88%{opacity:.85;clip-path:inset(62% 0 15% 0);transform:translateX(-4px);}
  88.5%{opacity:.85;clip-path:inset(22% 0 55% 0);transform:translateX(4px);}
  89%{opacity:0;}
}
@media(max-width:768px){
  .glitch-wrap{height:62px;min-width:140px;}
  .logo-en-gl,.logo-jp-gl,.gl-r img,.gl-b img{max-height:62px;}
}
.hdr-tag{font-family:'Cinzel',serif;font-size:.68rem;letter-spacing:.38em;color:var(--accent);text-transform:uppercase;margin-top:.65rem;opacity:.88;}

/* ════════════════════════════════════════
   NAV
════════════════════════════════════════ */
#nav{
  position:sticky;top:0;z-index:100;
  background:var(--nav-bg);border-bottom:1px solid var(--accent);
  backdrop-filter:blur(14px);-webkit-backdrop-filter:blur(14px);
  box-shadow:0 2px 22px rgba(0,0,0,.38),var(--glow);
}
.nav-in{max-width:1200px;margin:0 auto;display:flex;align-items:stretch;justify-content:space-between;padding:0 .8rem;}
.nav-tabs{display:flex;list-style:none;overflow-x:auto;scrollbar-width:none;flex-shrink:1;min-width:0;}
.nav-tabs::-webkit-scrollbar{display:none;}
.nav-tabs li{position:relative;flex-shrink:0;}
.nav-tabs li>a,.nav-tabs li>button{
  display:flex;align-items:center;gap:.22rem;padding:.82rem .82rem;
  font-family:'Cinzel',serif;font-size:.64rem;font-weight:600;letter-spacing:.09em;text-transform:uppercase;
  color:var(--text-dim);cursor:pointer;background:none;border:none;border-bottom:3px solid transparent;
  transition:all .2s;white-space:nowrap;text-decoration:none;
}
.nav-tabs li>a:hover,.nav-tabs li>button:hover{color:var(--accent);border-bottom-color:var(--accent);}
.nav-tabs li>a.active,.nav-tabs li>button.active{color:var(--accent2);border-bottom-color:var(--accent2);}
.da{font-size:.5rem;transition:transform .2s;}
.has-dd:hover .da{transform:rotate(180deg);}
.dd-menu{
  position:absolute;top:100%;left:50%;transform:translateX(-50%);
  background:var(--surface);border:1px solid var(--accent);border-top:none;
  min-width:150px;box-shadow:0 8px 24px rgba(0,0,0,.42);display:none;z-index:200;
}
.has-dd:hover .dd-menu{display:block;}
.dd-menu a{
  display:block;padding:.58rem .95rem;
  font-family:'Cinzel',serif;font-size:.62rem;letter-spacing:.09em;text-transform:uppercase;
  color:var(--text-dim);text-decoration:none;transition:all .14s;border-bottom:1px solid var(--hr);
}
.dd-menu a:last-child{border-bottom:none;}
.dd-menu a:hover{background:var(--surface2);color:var(--accent);padding-left:1.25rem;}
.dd-menu a.active{color:var(--accent2);background:var(--surface2);}

/* Nav right */
.nav-ctrl{display:flex;align-items:center;gap:.45rem;padding-left:.4rem;flex-shrink:0;}
.tt{display:flex;align-items:center;gap:.35rem;}
.tt-track{position:relative;width:38px;height:19px;background:var(--surface2);border-radius:10px;border:1px solid var(--accent);cursor:pointer;flex-shrink:0;}
.tt-thumb{position:absolute;top:2px;left:2px;width:13px;height:13px;background:var(--accent);border-radius:50%;transition:transform .3s;box-shadow:0 0 5px var(--accent);}
[data-theme="light"] .tt-thumb{transform:translateX(19px);}
.tt-icon{font-size:.78rem;color:var(--accent);}

/* Discord */
.dc-zone{position:relative;}
#dc-login-btn{
  display:flex;align-items:center;gap:.4rem;padding:.38rem .72rem;
  font-family:'Cinzel',serif;font-size:.62rem;letter-spacing:.09em;text-transform:uppercase;
  background:#5865F2;color:#fff;border:none;cursor:pointer;border-radius:3px;transition:opacity .2s;white-space:nowrap;
}
#dc-login-btn:hover{opacity:.83;}
#dc-login-btn svg{width:15px;height:15px;flex-shrink:0;}
#dc-user-wrap{display:none;position:relative;}
.dc-btn{
  display:flex;align-items:center;gap:.42rem;padding:.28rem .55rem;
  background:var(--surface2);border:1px solid var(--hr);border-radius:4px;cursor:pointer;transition:border-color .2s;
}
.dc-btn:hover{border-color:var(--accent);}
.dc-av{width:24px;height:24px;border-radius:50%;border:1px solid var(--accent);object-fit:cover;flex-shrink:0;}
.dc-av-ph{width:24px;height:24px;border-radius:50%;background:#5865F2;display:flex;align-items:center;justify-content:center;color:#fff;font-size:.62rem;font-family:'Cinzel',serif;flex-shrink:0;}
.dc-uname{font-family:'Cinzel',serif;font-size:.62rem;letter-spacing:.05em;color:var(--text);max-width:85px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}
.dc-dot{width:7px;height:7px;background:#57F287;border-radius:50%;flex-shrink:0;box-shadow:0 0 5px #57F287;}
/* ── Discord profile card dropdown ── */
.dc-dd{
  position:absolute;top:calc(100% + 4px);right:0;
  background:var(--surface);border:1px solid var(--hr);
  min-width:280px;max-width:300px;z-index:300;display:none;
  box-shadow:0 8px 32px rgba(0,0,0,.65);overflow:hidden;
}
.dc-dd.open{display:block;animation:fadeUp .18s ease;}
@keyframes fadeUp{from{opacity:0;transform:translateY(6px);}to{opacity:1;transform:translateY(0);}}
.dc-profile-card{}
.dpc-banner{height:60px;background:linear-gradient(135deg,var(--crimson-deep) 0%,var(--crimson) 50%,#3a0505 100%);}
.dpc-avatar-row{display:flex;align-items:flex-end;justify-content:space-between;padding:0 .9rem;margin-top:-24px;margin-bottom:.4rem;}
.dpc-av-wrap{position:relative;}
.dpc-av{width:52px;height:52px;border-radius:50%;background:var(--surface2);border:3px solid var(--surface);overflow:hidden;display:flex;align-items:center;justify-content:center;font-family:'Cinzel',serif;font-size:1.1rem;color:var(--accent);}
.dpc-av img{width:100%;height:100%;object-fit:cover;}
.dpc-status{position:absolute;bottom:2px;right:2px;width:13px;height:13px;border-radius:50%;background:#57F287;border:2px solid var(--surface);}
.dpc-badges{display:flex;gap:.3rem;flex-wrap:wrap;align-items:center;padding-bottom:.3rem;}
.dpc-badge{font-size:.65rem;background:var(--surface2);border:1px solid var(--hr);padding:.15rem .42rem;color:var(--text-muted);}
.dpc-body{padding:.25rem .9rem .7rem;}
.dpc-displayname{font-family:'Cinzel',serif;font-size:.9rem;color:var(--text);font-weight:700;letter-spacing:.04em;margin-bottom:.08rem;}
.dpc-username{font-size:.76rem;color:var(--text-muted);margin-bottom:.05rem;}
.dpc-divider{height:1px;background:var(--hr);margin:.55rem 0;}
.dpc-label{font-size:.58rem;font-family:'Cinzel',serif;letter-spacing:.14em;color:var(--text-muted);text-transform:uppercase;margin-bottom:.2rem;}
.dpc-val{font-size:.82rem;color:var(--text-dim);}
.dpc-mono{font-family:monospace;font-size:.76rem;color:var(--text-muted);}
.dpc-fields{display:flex;flex-direction:column;gap:.42rem;}
.dpc-bio{font-size:.83rem;color:var(--text-dim);line-height:1.55;}
.dpc-roles{display:flex;flex-wrap:wrap;gap:.3rem;}
.dpc-role{font-size:.63rem;padding:.16rem .48rem;border-radius:3px;font-weight:600;letter-spacing:.04em;}
.dpc-role-member{background:rgba(88,101,242,.22);color:#818cf8;border:1px solid rgba(88,101,242,.38);}
.dpc-role-staff{background:rgba(201,168,76,.18);color:var(--accent);border:1px solid rgba(201,168,76,.32);}
.dpc-role-og{background:rgba(192,39,45,.18);color:var(--crimson-bright);border:1px solid rgba(192,39,45,.32);}
.dpc-actions{border-top:1px solid var(--hr);}
.dpc-actions button{display:block;width:100%;padding:.58rem .95rem;background:none;border:none;text-align:left;cursor:pointer;font-size:.82rem;font-family:'Cinzel',serif;letter-spacing:.07em;color:var(--text-dim);transition:all .14s;}
.dpc-actions button:hover{background:var(--surface2);color:var(--accent);padding-left:1.3rem;}
.dc-out{color:var(--crimson-bright)!important;}

/* ── New footer grid layout ── */
#ft{background:#0d0000;border-top:1px solid rgba(255,255,255,.08);padding:2.8rem 1.5rem 0;}
.ft-grid{max-width:1100px;margin:0 auto;display:grid;grid-template-columns:1.2fr 1fr 0.8fr 1fr;gap:2.5rem;padding-bottom:2.2rem;}
@media(max-width:760px){.ft-grid{grid-template-columns:1fr 1fr;}}
@media(max-width:460px){.ft-grid{grid-template-columns:1fr;}}
.ft-col-title{font-family:'Cinzel',serif;font-size:.62rem;letter-spacing:.18em;color:var(--accent);text-transform:uppercase;margin-bottom:1rem;font-weight:700;}
.ft-col-brand{font-family:'Cinzel',serif;font-size:.88rem;color:var(--accent);letter-spacing:.1em;font-weight:700;margin-bottom:.7rem;}
.ft-col-desc{font-size:.85rem;color:var(--text-muted);line-height:1.72;max-width:220px;}
.ft-col ul{list-style:none;}
.ft-col ul li{margin-bottom:.48rem;}
.ft-col ul a{font-size:.85rem;color:var(--text-muted);transition:color .18s;display:flex;align-items:center;gap:.38rem;}
.ft-col ul a::before{content:'↗';font-size:.62rem;opacity:.45;}
.ft-col ul a:hover{color:var(--accent);}
.ft-disc-label{font-family:'Cinzel',serif;font-size:.62rem;letter-spacing:.18em;color:var(--accent);text-transform:uppercase;margin-bottom:.6rem;font-weight:700;}
.ft-disc-btn{display:inline-flex;align-items:center;gap:.5rem;background:#5865F2;color:#fff;font-family:'Cinzel',serif;font-size:.72rem;letter-spacing:.09em;padding:.55rem 1rem;cursor:pointer;text-decoration:none;transition:background .2s,transform .15s;}
.ft-disc-btn:hover{background:#4752c4;transform:translateY(-1px);}
.ft-divider{max-width:1100px;margin:0 auto;height:1px;background:rgba(255,255,255,.07);}
.ft-bottom{max-width:1100px;margin:0 auto;display:flex;align-items:center;justify-content:space-between;padding:.85rem 0;flex-wrap:wrap;gap:.4rem;}
.ft-copy{font-size:.76rem;color:var(--text-muted);}
.ft-rights{font-size:.76rem;color:var(--text-muted);}

/* ── Redesigned Discord widget ── */
.dc-wgt-v2{background:var(--surface);border:1px solid var(--accent);padding:1.2rem 1.5rem;margin-bottom:1.5rem;display:flex;align-items:center;gap:1.2rem;flex-wrap:wrap;}
.dc-wgt-v2-left{flex:1;min-width:170px;}
.dc-wgt-v2-title{font-family:'Cinzel',serif;font-size:.82rem;color:var(--accent);letter-spacing:.1em;margin-bottom:.32rem;}
.dc-wgt-v2-count{display:flex;align-items:center;gap:.45rem;font-size:.93rem;color:var(--text-dim);}
.dc-wgt-v2-count .od{width:9px;height:9px;border-radius:50%;background:#57F287;flex-shrink:0;animation:pulse 2s ease-in-out infinite;}
@keyframes pulse{0%,100%{box-shadow:0 0 0 0 rgba(87,242,135,.5);}50%{box-shadow:0 0 0 5px rgba(87,242,135,0);}}

/* ════════════════════════════════════════
   MAIN CONTENT
════════════════════════════════════════ */
#content{position:relative;z-index:1;max-width:1100px;margin:0 auto;padding:2.8rem 1.5rem 6rem;}
.sec{display:none;}
.sec.active{display:block;animation:fi .32s ease;}
.subsec{display:none;}
.subsec.active{display:block;animation:fi .32s ease;}
@keyframes fi{from{opacity:0;transform:translateY(9px);}to{opacity:1;transform:translateY(0);}}

/* ════════════════════════════════════════
   TYPOGRAPHY
════════════════════════════════════════ */
/* ── Unified section header (JP large + EN below) ── */
.sec-hdr{text-align:center;padding:2rem 1rem 1.6rem;margin-bottom:.5rem;}
.sec-hdr .jp{font-family:'Ma Shan Zheng',serif;font-size:2.5rem;color:var(--accent);display:block;margin-bottom:.15rem;letter-spacing:.05em;line-height:1.1;}
.sec-hdr .en{font-family:'Cinzel',serif;font-size:1.42rem;font-weight:700;letter-spacing:.14em;color:var(--text);display:block;}
.sec-hdr .sub{font-size:.97rem;color:var(--text-dim);max-width:560px;margin:.7rem auto 0;line-height:1.7;}
/* Keep legacy .st/.st-jp for internal sub-headers */
.st{font-family:'Cinzel',serif;font-size:1.2rem;font-weight:700;color:var(--accent);text-align:center;letter-spacing:.14em;margin-bottom:.25rem;}
.st-jp{font-family:'Ma Shan Zheng',serif;font-size:.9rem;color:var(--text-muted);text-align:center;letter-spacing:.28em;margin-bottom:1.5rem;}
.sdiv{display:flex;align-items:center;gap:.9rem;margin-bottom:1.8rem;}
.sdiv::before,.sdiv::after{content:'';flex:1;height:1px;background:linear-gradient(to right,transparent,var(--accent),transparent);}
.sdiv span{font-family:'Ma Shan Zheng',serif;font-size:1.2rem;color:var(--accent);}
.orn{display:flex;align-items:center;gap:.9rem;margin:1.8rem 0;color:var(--accent);font-family:'Ma Shan Zheng',serif;font-size:1.05rem;}
.orn::before,.orn::after{content:'';flex:1;height:1px;background:var(--accent);opacity:.3;}

/* ════════════════════════════════════════
   BUTTONS
════════════════════════════════════════ */
.btn{
  display:inline-flex;align-items:center;gap:.38rem;
  padding:.52rem 1rem;font-family:'Cinzel',serif;font-size:.65rem;letter-spacing:.11em;text-transform:uppercase;
  border:1px solid var(--accent);color:var(--accent);background:transparent;cursor:pointer;transition:all .2s;
}
.btn:hover{background:var(--accent);color:var(--bg);box-shadow:var(--glow);}
.btn-p{background:var(--accent);color:var(--bg);}
.btn-p:hover{background:var(--accent2);border-color:var(--accent2);}
.btn-sm{padding:.32rem .65rem;font-size:.58rem;}
.btn-dc{background:#5865F2;border-color:#5865F2;color:#fff;}
.btn-dc:hover{background:#4752c4;border-color:#4752c4;color:#fff;}
.subnav{display:flex;gap:.45rem;margin-bottom:2rem;justify-content:center;flex-wrap:wrap;}
.sn-btn{padding:.45rem .95rem;font-family:'Cinzel',serif;font-size:.62rem;letter-spacing:.09em;text-transform:uppercase;border:1px solid var(--hr);color:var(--text-dim);background:transparent;cursor:pointer;transition:all .2s;}
.sn-btn:hover{border-color:var(--accent);color:var(--accent);}
.sn-btn.active{border-color:var(--accent);color:var(--accent);background:var(--tag-bg);}

/* ════════════════════════════════════════
   CARDS
════════════════════════════════════════ */
.card{background:var(--surface);border:1px solid var(--hr);padding:1.4rem;transition:border-color .22s;}
.card:hover{border-color:var(--accent);}
.fbox{position:relative;border:1px solid var(--accent);background:var(--card-bg);padding:1.7rem;}
.fbox::before{content:'';position:absolute;top:4px;left:4px;right:4px;bottom:4px;border:1px solid var(--accent);opacity:.18;pointer-events:none;}
.igrid{display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:.85rem;margin-top:1.6rem;}
.ic{background:var(--surface);border:1px solid var(--hr);padding:1rem;text-align:center;transition:all .2s;}
.ic:hover{border-color:var(--accent);transform:translateY(-2px);box-shadow:var(--glow);}
.ic .icl{font-family:'Cinzel',serif;font-size:.58rem;letter-spacing:.18em;color:var(--text-muted);text-transform:uppercase;margin-bottom:.28rem;}
.ic .icv{font-size:.95rem;font-weight:600;color:var(--accent);}
.qlinks{display:flex;flex-wrap:wrap;gap:.65rem;margin-top:1.6rem;justify-content:center;}

/* ════════════════════════════════════════
   ABOUT
════════════════════════════════════════ */
.about-g{display:grid;grid-template-columns:1fr 1fr;gap:2.2rem;align-items:start;margin-bottom:2.2rem;}
@media(max-width:680px){.about-g{grid-template-columns:1fr;}}
.about-text .lead{font-size:1.18rem;font-style:italic;color:var(--text-dim);border-left:3px solid var(--accent);padding-left:.95rem;margin-bottom:1.2rem;}
.about-text p{font-size:1.02rem;line-height:1.85;margin-bottom:.9rem;}
.synopsis h3{font-family:'Cinzel',serif;font-size:.75rem;letter-spacing:.18em;color:var(--accent);margin-bottom:.65rem;}
.synopsis p{font-size:.98rem;line-height:1.8;font-style:italic;}

/* ════════════════════════════════════════
   NEWS
════════════════════════════════════════ */
.news-list{display:flex;flex-direction:column;gap:1.3rem;}
.nc{display:grid;grid-template-columns:72px 1fr;gap:1.1rem;background:var(--surface);border:1px solid var(--hr);padding:1.2rem;transition:all .22s;cursor:default;}
.nc:hover{border-color:var(--accent);box-shadow:var(--glow2);}
.nc-date{display:flex;flex-direction:column;align-items:center;gap:.1rem;padding-top:.15rem;}
.nc-d{font-family:'Cinzel',serif;font-size:1.5rem;font-weight:700;color:var(--accent);line-height:1;}
.nc-m{font-family:'Cinzel',serif;font-size:.55rem;letter-spacing:.14em;color:var(--text-muted);text-transform:uppercase;}
.nc-y{font-size:.68rem;color:var(--text-muted);}
.nc-cat{display:inline-block;padding:.12rem .45rem;border:1px solid var(--accent);font-family:'Cinzel',serif;font-size:.55rem;letter-spacing:.08em;color:var(--accent);margin-bottom:.42rem;}
.nc-title{font-family:'Cinzel',serif;font-size:.95rem;color:var(--text);margin-bottom:.42rem;letter-spacing:.04em;}
.nc-exc{font-size:.93rem;line-height:1.68;color:var(--text-dim);}
.nc-meta{display:flex;gap:.9rem;margin-top:.6rem;font-size:.76rem;color:var(--text-muted);}
@media(max-width:440px){.nc{grid-template-columns:55px 1fr;gap:.7rem;padding:.9rem;}.nc-d{font-size:1.2rem;}}

/* Articles */
.art-card{background:var(--surface);border:1px solid var(--hr);margin-bottom:1.2rem;overflow:hidden;transition:border-color .22s;}
.art-card:hover{border-color:var(--accent);}
.art-card-body{padding:1.3rem;}
.art-cat{display:inline-block;padding:.12rem .45rem;border:1px solid var(--accent);font-family:'Cinzel',serif;font-size:.55rem;letter-spacing:.08em;color:var(--accent);margin-bottom:.42rem;}
.art-title{font-family:'Cinzel',serif;font-size:1.05rem;color:var(--text);margin-bottom:.5rem;letter-spacing:.04em;}
.art-meta{font-size:.78rem;color:var(--text-muted);margin-bottom:.7rem;}
.art-body{font-size:.97rem;line-height:1.78;color:var(--text-dim);}

/* Discussion / Comments */
.post-box{background:var(--surface);border:1px solid var(--accent);padding:1.4rem;margin-bottom:1.8rem;}
.post-box label{display:block;font-family:'Cinzel',serif;font-size:.62rem;letter-spacing:.14em;color:var(--accent);margin-bottom:.38rem;text-transform:uppercase;}
.post-box select,.post-box textarea,.post-box input{
  width:100%;background:var(--in-bg);border:1px solid var(--in-border);color:var(--text);
  font-family:'Crimson Pro',serif;font-size:1rem;padding:.65rem .88rem;transition:border-color .2s;
}
.post-box select:focus,.post-box textarea:focus,.post-box input:focus{outline:none;border-color:var(--accent);}
.post-box textarea{min-height:95px;resize:vertical;}
.post-box .fr{margin-bottom:.95rem;}
.post-box select{appearance:none;-webkit-appearance:none;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='11' height='7'%3E%3Cpath d='M1 1l4.5 4.5L10 1' stroke='%23C9A84C' fill='none' stroke-width='1.5'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right .9rem center;}
[data-theme="light"] .post-box select{background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='11' height='7'%3E%3Cpath d='M1 1l4.5 4.5L10 1' stroke='%238B1A1A' fill='none' stroke-width='1.5'/%3E%3C/svg%3E");}

.dp{background:var(--surface);border:1px solid var(--hr);padding:1.15rem;margin-bottom:.9rem;transition:border-color .2s;}
.dp:hover{border-color:var(--accent);}
.dp-top{display:flex;align-items:center;gap:.75rem;margin-bottom:.65rem;}
.dp-av{width:34px;height:34px;border-radius:50%;background:var(--surface2);border:1px solid var(--hr);overflow:hidden;display:flex;align-items:center;justify-content:center;font-family:'Cinzel',serif;font-size:.75rem;color:var(--accent);flex-shrink:0;}
.dp-av img{width:100%;height:100%;object-fit:cover;}
.dp-n{font-family:'Cinzel',serif;font-size:.78rem;color:var(--accent);}
.dp-t{font-size:.72rem;color:var(--text-muted);}
.dp-body{font-size:.97rem;line-height:1.72;}
.dp-acts{display:flex;gap:.75rem;margin-top:.62rem;}
.dp-act{background:none;border:none;color:var(--text-muted);font-family:'Crimson Pro',serif;font-size:.83rem;cursor:pointer;transition:color .2s;padding:0;}
.dp-act:hover{color:var(--accent);}

/* Gate */
.gate{text-align:center;padding:2.5rem 1.5rem;background:var(--surface);border:1px dashed var(--accent);}
.gate-ico{font-size:2.2rem;margin-bottom:.9rem;opacity:.45;}
.gate h3{font-family:'Cinzel',serif;color:var(--accent);font-size:1.05rem;margin-bottom:.55rem;letter-spacing:.1em;}
.gate p{font-size:.93rem;color:var(--text-dim);line-height:1.7;max-width:440px;margin:0 auto 1.1rem;}

/* ════════════════════════════════════════
   THEORIES
════════════════════════════════════════ */
.th-card{background:var(--surface);border:1px solid var(--hr);padding:1.3rem;margin-bottom:1.1rem;transition:border-color .22s;}
.th-card:hover{border-color:var(--accent);}
.th-hdr{display:flex;align-items:flex-start;gap:.75rem;margin-bottom:.75rem;}
.th-av{width:38px;height:38px;border-radius:50%;border:1px solid var(--accent);background:var(--surface2);display:flex;align-items:center;justify-content:center;font-family:'Cinzel',serif;font-size:.8rem;color:var(--accent);flex-shrink:0;overflow:hidden;}
.th-av img{width:100%;height:100%;object-fit:cover;}
.th-meta .tn{font-family:'Cinzel',serif;font-size:.78rem;color:var(--accent);}
.th-meta .tt{font-size:.72rem;color:var(--text-muted);}
.th-title{font-family:'Cinzel',serif;font-size:1.02rem;color:var(--text);margin-bottom:.45rem;}
.th-body{font-size:.97rem;line-height:1.74;color:var(--text);}
.th-foot{display:flex;gap:.9rem;margin-top:.85rem;flex-wrap:wrap;align-items:center;}
.th-tag{padding:.12rem .45rem;border:1px solid var(--hr);font-family:'Cinzel',serif;font-size:.55rem;letter-spacing:.06em;color:var(--text-muted);}
.vbtn{display:flex;align-items:center;gap:.28rem;background:none;border:1px solid var(--hr);color:var(--text-muted);font-family:'Cinzel',serif;font-size:.62rem;padding:.18rem .55rem;cursor:pointer;transition:all .2s;}
.vbtn:hover{border-color:var(--accent);color:var(--accent);}
.vbtn.voted{border-color:var(--accent);color:var(--accent);background:var(--tag-bg);}

/* ════════════════════════════════════════
   RULES
════════════════════════════════════════ */
.rules-intro{background:var(--surface);border-left:4px solid var(--accent);padding:1.8rem;margin-bottom:2.5rem;}
.rules-intro p{font-size:1rem;line-height:1.82;color:var(--text-dim);margin-bottom:.9rem;}
.rules-intro p:last-child{margin-bottom:0;}
.rules-intro .ri-title{font-family:'Cinzel',serif;font-size:1rem;color:var(--accent);letter-spacing:.12em;margin-bottom:.9rem;}
.rule-item{display:flex;gap:1rem;padding:1.2rem 1.4rem;background:var(--surface);border:1px solid var(--hr);border-left:3px solid var(--accent);margin-bottom:.85rem;transition:all .2s;}
.rule-item:hover{background:var(--surface2);}
.rule-num{font-family:'Ma Shan Zheng',serif;font-size:1.65rem;color:var(--accent);opacity:.45;flex-shrink:0;line-height:1;padding-top:.1rem;min-width:30px;}
.rule-b h4{font-family:'Cinzel',serif;font-size:.78rem;letter-spacing:.1em;color:var(--accent);margin-bottom:.4rem;}
.rule-b p{font-size:.97rem;line-height:1.75;}
.strike-system{margin-top:2.5rem;}
.strike-grid{display:flex;flex-direction:column;gap:.75rem;}
.strike{display:flex;align-items:flex-start;gap:1rem;padding:1rem 1.3rem;background:var(--surface);border:1px solid var(--hr);}
.strike-num{font-family:'Cinzel',serif;font-size:.65rem;letter-spacing:.12em;color:#fff;background:var(--accent);padding:.2rem .55rem;white-space:nowrap;flex-shrink:0;margin-top:.15rem;}
.strike.s5 .strike-num{background:var(--crimson);}
.strike.s6 .strike-num{background:var(--crimson-deep);}
.strike-body h4{font-family:'Cinzel',serif;font-size:.78rem;color:var(--accent);margin-bottom:.32rem;letter-spacing:.08em;}
.strike.s5 .strike-body h4,.strike.s6 .strike-body h4{color:var(--crimson-bright);}
.strike-body p{font-size:.95rem;line-height:1.7;}

/* ════════════════════════════════════════
   MANGA / GALLERY / CHARS
════════════════════════════════════════ */
.gal-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(250px,1fr));gap:1.2rem;}
.gal-item{position:relative;overflow:hidden;border:1px solid var(--hr);cursor:pointer;transition:all .3s;background:var(--surface);}
.gal-item:hover{border-color:var(--accent);box-shadow:var(--glow2);transform:translateY(-3px);}
.gal-item img{width:100%;height:195px;object-fit:cover;display:block;transition:transform .5s;}
.gal-item:hover img{transform:scale(1.06);}
.gal-ov{position:absolute;bottom:0;left:0;right:0;background:linear-gradient(transparent,rgba(0,0,0,.82));padding:1.3rem 1rem .65rem;transform:translateY(100%);transition:transform .3s;}
.gal-item:hover .gal-ov{transform:translateY(0);}
.gal-ov p{font-family:'Cinzel',serif;font-size:.7rem;color:var(--accent);letter-spacing:.07em;}
.read-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(195px,1fr));gap:.85rem;margin-top:1.8rem;}
.rc{border:1px solid var(--accent);padding:1rem 1.2rem;display:flex;align-items:center;gap:.85rem;background:var(--surface);transition:all .2s;color:var(--text);}
.rc:hover{background:var(--surface2);box-shadow:var(--glow);transform:translateX(4px);}
.rc-ico{font-size:1.5rem;flex-shrink:0;}
.rc-title{font-family:'Cinzel',serif;font-size:.72rem;letter-spacing:.07em;color:var(--accent);}
.rc-sub{font-size:.8rem;color:var(--text-muted);}
.ch-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:1.6rem;}
.ch{display:grid;grid-template-columns:105px 1fr;gap:.95rem;background:var(--surface);border:1px solid var(--hr);padding:1rem;transition:all .28s;position:relative;overflow:hidden;}
.ch::after{content:'';position:absolute;top:0;left:0;width:3px;height:0;background:var(--accent);transition:height .28s;}
.ch:hover{border-color:var(--accent);box-shadow:var(--glow2);}
.ch:hover::after{height:100%;}
.ch-img{width:105px;height:105px;object-fit:cover;object-position:top;border:1px solid var(--hr);}
.ch-info h3{font-family:'Cinzel',serif;font-size:.88rem;color:var(--accent);margin-bottom:.1rem;letter-spacing:.06em;}
.ch-info .ct{font-size:.73rem;color:var(--text-muted);font-style:italic;margin-bottom:.45rem;}
.ch-info p{font-size:.84rem;line-height:1.62;}
.ch-tag{display:inline-block;padding:.1rem .42rem;border:1px solid var(--accent);font-family:'Cinzel',serif;font-size:.56rem;letter-spacing:.07em;color:var(--accent);margin-top:.42rem;}
@media(max-width:640px){.ch-grid{grid-template-columns:1fr;}.ch{grid-template-columns:88px 1fr;}.ch-img{width:88px;height:88px;}}

/* ════════════════════════════════════════
   INFO
════════════════════════════════════════ */
.sl-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(188px,1fr));gap:.72rem;}
.sl{display:flex;align-items:center;gap:.72rem;padding:.72rem .95rem;background:var(--surface);border:1px solid var(--hr);color:var(--text);transition:all .2s;font-size:.86rem;}
.sl:hover{border-color:var(--accent);background:var(--surface2);color:var(--accent);transform:translateX(3px);}
.sl-ico{font-size:1.05rem;}
.sl-name{font-family:'Cinzel',serif;font-size:.65rem;letter-spacing:.09em;color:var(--accent);}
.sl-sub{font-size:.73rem;color:var(--text-muted);}
.ls-sec{margin-bottom:2rem;}
.ls-sec h3{font-family:'Cinzel',serif;font-size:.78rem;letter-spacing:.18em;color:var(--accent);text-transform:uppercase;margin-bottom:.85rem;padding-bottom:.42rem;border-bottom:1px solid var(--hr);}
.au-card{display:flex;gap:1.6rem;align-items:center;padding:1.6rem;background:var(--surface);border:1px solid var(--accent);}
.au-img{width:105px;height:105px;object-fit:cover;border:2px solid var(--accent);flex-shrink:0;}
.au-info h3{font-family:'Cinzel',serif;font-size:1.05rem;color:var(--accent);margin-bottom:.18rem;letter-spacing:.07em;}
.au-info .au-jp{font-family:'Ma Shan Zheng',serif;font-size:.95rem;color:var(--text-muted);margin-bottom:.62rem;}
.au-info p{font-size:.92rem;line-height:1.7;margin-bottom:.85rem;}
@media(max-width:560px){.au-card{flex-direction:column;align-items:flex-start;}.au-img{width:80px;height:80px;}}

/* ════════════════════════════════════════
   STAFF
════════════════════════════════════════ */
.staff-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(195px,1fr));gap:1.2rem;margin-bottom:2.2rem;}
.sc{background:var(--surface);border:1px solid var(--hr);overflow:hidden;text-align:center;transition:all .28s;cursor:pointer;position:relative;}
.sc:hover{border-color:var(--accent);box-shadow:var(--glow2);transform:translateY(-4px);}
.sc img{width:100%;height:158px;object-fit:cover;object-position:top;display:block;filter:saturate(.82);transition:filter .3s,transform .5s;}
.sc:hover img{filter:saturate(1.1);transform:scale(1.06);}
.sc-body{padding:.95rem .85rem;}
.sc-role{font-family:'Cinzel',serif;font-size:.55rem;letter-spacing:.2em;color:var(--accent);text-transform:uppercase;margin-bottom:.22rem;}
.sc-name{font-family:'Cinzel',serif;font-size:.88rem;font-weight:600;color:var(--text);margin-bottom:.14rem;}
.sc-handle{font-size:.76rem;color:var(--text-muted);font-style:italic;}
.sc-view{
  position:absolute;bottom:0;left:0;right:0;
  background:var(--accent);color:var(--bg);
  font-family:'Cinzel',serif;font-size:.58rem;letter-spacing:.14em;text-transform:uppercase;
  padding:.38rem;text-align:center;transform:translateY(100%);transition:transform .22s;
  border:none;cursor:pointer;width:100%;
}
.sc:hover .sc-view{transform:translateY(0);}

/* ════════════════════════════════════════
   STAFF MODAL
════════════════════════════════════════ */
.m-ov{
  position:fixed;inset:0;background:var(--modal-bg);z-index:1000;
  display:none;align-items:center;justify-content:center;padding:1rem;
  backdrop-filter:blur(7px);-webkit-backdrop-filter:blur(7px);
}
.m-ov.open{display:flex;animation:fi .22s ease;}
.modal{
  background:var(--bg2);border:1px solid var(--accent);
  max-width:580px;width:100%;max-height:90vh;overflow-y:auto;position:relative;
}
.modal::-webkit-scrollbar{width:4px;}
.modal::-webkit-scrollbar-thumb{background:var(--accent);}
.m-hdr{display:grid;grid-template-columns:155px 1fr;border-bottom:1px solid var(--accent);min-height:190px;}
@media(max-width:480px){.m-hdr{grid-template-columns:1fr;}}
.m-hdr-img{width:155px;height:190px;object-fit:cover;object-position:top;display:block;}
@media(max-width:480px){.m-hdr-img{width:100%;height:210px;}}
.m-hdr-info{padding:1.3rem 1.3rem .9rem;display:flex;flex-direction:column;justify-content:flex-end;}
.m-role{font-family:'Cinzel',serif;font-size:.6rem;letter-spacing:.2em;color:var(--accent);text-transform:uppercase;margin-bottom:.28rem;}
.m-name{font-family:'Cinzel',serif;font-size:1.32rem;color:var(--text);margin-bottom:.18rem;}
.m-handle{font-size:.87rem;color:var(--text-muted);font-style:italic;margin-bottom:.5rem;}
.m-badge{display:inline-block;padding:.12rem .45rem;border:1px solid var(--accent);font-family:'Cinzel',serif;font-size:.56rem;letter-spacing:.08em;color:var(--accent);}
.m-body{padding:1.4rem;}
.m-sec{margin-bottom:1.2rem;}
.m-sec h4{font-family:'Cinzel',serif;font-size:.68rem;letter-spacing:.17em;color:var(--accent);text-transform:uppercase;margin-bottom:.45rem;padding-bottom:.28rem;border-bottom:1px solid var(--hr);}
.m-sec p{font-size:.96rem;line-height:1.74;}
.m-tags{display:flex;flex-wrap:wrap;gap:.38rem;margin-top:.42rem;}
.m-tag{padding:.18rem .55rem;border:1px solid var(--hr);font-family:'Cinzel',serif;font-size:.58rem;letter-spacing:.06em;color:var(--text-muted);}
.m-close{position:absolute;top:.62rem;right:.62rem;background:var(--surface2);border:1px solid var(--hr);color:var(--text-muted);width:26px;height:26px;cursor:pointer;font-size:.95rem;display:flex;align-items:center;justify-content:center;transition:all .18s;}
.m-close:hover{border-color:var(--accent);color:var(--accent);}

/* ════════════════════════════════════════
   APPLY
════════════════════════════════════════ */
.apply-wrap{max-width:720px;margin:0 auto;}
.apply-intro{text-align:center;margin-bottom:2.2rem;}
.apply-intro p{font-size:1.02rem;color:var(--text-dim);line-height:1.8;}
.af .fr{margin-bottom:1.2rem;}
.af label{display:block;font-family:'Cinzel',serif;font-size:.62rem;letter-spacing:.14em;color:var(--accent);margin-bottom:.38rem;text-transform:uppercase;}
.af input,.af select,.af textarea{
  width:100%;background:var(--in-bg);border:1px solid var(--in-border);color:var(--text);
  font-family:'Crimson Pro',serif;font-size:1rem;padding:.7rem .95rem;transition:border-color .2s;
}
.af input:focus,.af select:focus,.af textarea:focus{outline:none;border-color:var(--accent);}
.af select{appearance:none;-webkit-appearance:none;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='11' height='7'%3E%3Cpath d='M1 1l4.5 4.5L10 1' stroke='%23C9A84C' fill='none' stroke-width='1.5'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right .9rem center;}
[data-theme="light"] .af select{background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='11' height='7'%3E%3Cpath d='M1 1l4.5 4.5L10 1' stroke='%238B1A1A' fill='none' stroke-width='1.5'/%3E%3C/svg%3E");}
.af textarea{min-height:105px;resize:vertical;}
.af .fhint{font-size:.79rem;color:var(--text-muted);margin-top:.3rem;font-style:italic;}
.af .fg{display:grid;grid-template-columns:1fr 1fr;gap:1.1rem;}
@media(max-width:520px){.af .fg{grid-template-columns:1fr;}}
.apply-ok{display:none;text-align:center;padding:3rem;background:var(--surface);border:1px solid var(--accent);}
.apply-ok .ao-ico{font-size:2.3rem;margin-bottom:.9rem;}
.apply-ok h3{font-family:'Cinzel',serif;color:var(--accent);font-size:1.15rem;margin-bottom:.55rem;letter-spacing:.1em;}
.apply-ok p{font-size:.97rem;color:var(--text-dim);line-height:1.72;}

/* ════════════════════════════════════════
   LEADERBOARD / DISCORD WIDGET
════════════════════════════════════════ */
.lb-note{text-align:center;padding:1.3rem;background:var(--surface);border:1px solid var(--hr);margin-bottom:1.8rem;}
.lb-note p{font-size:.88rem;color:var(--text-muted);line-height:1.62;}
.dc-wgt{background:var(--surface);border:1px solid var(--accent);padding:1.4rem;margin-bottom:1.5rem;}
.dc-wgt-hdr{display:flex;align-items:center;gap:.75rem;margin-bottom:1.1rem;}
.dc-wgt-hdr h3{font-family:'Cinzel',serif;font-size:.88rem;color:var(--accent);letter-spacing:.09em;}
.dc-online-ct{font-family:'Cinzel',serif;font-size:.65rem;color:var(--text-muted);margin-left:auto;}
.dc-mems{display:flex;flex-wrap:wrap;gap:.45rem;}
.dc-chip{display:flex;align-items:center;gap:.38rem;padding:.28rem .6rem;background:var(--surface2);border:1px solid var(--hr);border-radius:18px;font-size:.76rem;color:var(--text-dim);}
.dc-chip .od{width:6px;height:6px;border-radius:50%;background:#57F287;flex-shrink:0;}
.dc-load{text-align:center;padding:1.4rem;color:var(--text-muted);font-style:italic;font-size:.88rem;}
.lb-placeholder{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:360px;background:var(--surface);border:1px dashed var(--accent);gap:.85rem;padding:2rem;text-align:center;}
.lb-placeholder .lbico{font-size:2.6rem;opacity:.38;}
.lb-placeholder h3{font-family:'Cinzel',serif;font-size:.95rem;color:var(--accent);letter-spacing:.1em;}
.lb-placeholder p{font-size:.88rem;color:var(--text-muted);max-width:380px;line-height:1.62;}

/* ════════════════════════════════════════
   FOOTER
════════════════════════════════════════ */
#ft{position:relative;z-index:1;background:var(--bg2);border-top:1px solid var(--accent);padding:2.3rem 1.5rem 1.8rem;}
.ft-in{max-width:1100px;margin:0 auto;}
.ft-logo{text-align:center;margin-bottom:1.6rem;}
.ft-logo img{max-height:34px;opacity:.52;filter:drop-shadow(0 0 5px var(--accent));}
.ft-links{display:flex;flex-wrap:wrap;justify-content:center;gap:.48rem;margin-bottom:1.6rem;}
.ft-links a{font-family:'Cinzel',serif;font-size:.6rem;letter-spacing:.07em;color:var(--text-muted);transition:color .2s;}
.ft-links a:hover{color:var(--accent);}
.ft-links span{color:var(--hr);font-size:.58rem;}
.ft-bot{text-align:center;font-size:.78rem;color:var(--text-muted);line-height:1.8;}
.ft-bot a{color:var(--accent);}

/* ════════════════════════════════════════
   TOAST
════════════════════════════════════════ */
#toast{
  position:fixed;bottom:1.3rem;right:1.3rem;z-index:2000;
  background:var(--surface);border:1px solid var(--accent);
  padding:.72rem 1.2rem;font-family:'Cinzel',serif;font-size:.68rem;letter-spacing:.07em;
  color:var(--accent);opacity:0;transform:translateY(8px);
  transition:opacity .28s,transform .28s;pointer-events:none;max-width:280px;
}
#toast.show{opacity:1;transform:translateY(0);}
#toast.err{border-color:var(--crimson-bright);color:var(--crimson-bright);}

/* ════════════════════════════════════════
   RESPONSIVE
════════════════════════════════════════ */
@media(max-width:768px){
  #hdr{min-height:230px;}
  .glitch-wrap img.main-logo{max-height:62px;}
  .logo-jp-img{max-height:36px;}
  #content{padding:1.6rem .9rem 4rem;}
  .st{font-size:1.3rem;}
  .staff-grid{grid-template-columns:repeat(auto-fill,minmax(155px,1fr));}
  .sc img{height:140px;}
  .gal-grid{grid-template-columns:repeat(auto-fill,minmax(220px,1fr));}
  .about-g{gap:1.6rem;}
  .igrid{grid-template-columns:repeat(auto-fit,minmax(140px,1fr));}
}
@media(max-width:560px){
  .nav-in{padding:0 .3rem;}
  .nav-tabs li>a,.nav-tabs li>button{padding:.72rem .48rem;font-size:.56rem;letter-spacing:.03em;}
  .dc-uname{display:none;}
  .tt-icon:first-child{display:none;}
  #dc-login-btn span{display:none;}
  .nav-ctrl{gap:.3rem;}
  .au-card{flex-direction:column;}
  .staff-grid{grid-template-columns:repeat(2,1fr);}
}
@media(max-width:380px){
  .nav-tabs li>a,.nav-tabs li>button{padding:.68rem .35rem;font-size:.52rem;}
  .staff-grid{grid-template-columns:repeat(2,1fr);}
  .cd-ev{display:none;}
}

/* ════════════════════════════════════════
   MOBILE NAV
════════════════════════════════════════ */

/* Hidden by default on desktop */
.mob-bar,
.mob-drawer,
.mob-drawer-ov{ display:none; }

/* Overlay — fixed full-screen dim */
.mob-drawer-ov{
  position:fixed;inset:0;
  background:rgba(0,0,0,.75);
  z-index:998;display:none;
}
.mob-drawer-ov.open{ display:block; }

/* Drawer — slides in from left */
.mob-drawer{
  position:fixed;top:0;left:0;
  width:82%;max-width:360px;height:100%;
  background:var(--bg);
  border-right:2px solid var(--accent);
  transform:translateX(-100%);
  transition:transform .3s ease;
  z-index:999;display:flex;flex-direction:column;
}
.mob-drawer.open{ transform:translateX(0); }

/* Drawer header */
.mob-drawer-hdr{
  display:flex;justify-content:space-between;align-items:center;
  padding:1.2rem 1.4rem;
  border-bottom:1px solid var(--accent);
}
.mob-drawer-title{
  font-family:'Cinzel',serif;font-size:.75rem;
  letter-spacing:.4em;color:var(--accent);
}
.mob-drawer-close{
  background:none;border:none;color:var(--accent);
  font-size:1.2rem;cursor:pointer;line-height:1;
}
.mob-drawer-close:hover{ opacity:.7; }

/* Nav list */
.mob-nav-list{ list-style:none;padding:0;margin:0;flex:1;overflow-y:auto; }

.mob-nav-item{ border-bottom:1px solid rgba(201,168,76,.22);cursor:pointer; }

.mob-nav-label,
.mob-nav-row{
  display:flex;justify-content:space-between;align-items:center;
  padding:1.2rem 1.4rem;
  font-family:'Cinzel',serif;font-size:.78rem;
  letter-spacing:.25em;text-transform:uppercase;
  color:var(--text-dim);cursor:pointer;
}
.mob-nav-item.active{ background:rgba(201,168,76,.08); }
.mob-nav-item.active .mob-nav-label{ color:var(--accent); }

.mob-nav-arrow{ font-size:1rem;transition:transform .2s; }
.mob-nav-item.sub-open .mob-nav-arrow{ transform:rotate(180deg); }

.mob-sub-list{ display:none;background:#1a0606; }
.mob-sub-item{
  padding:1rem 2rem;
  font-family:'Cinzel',serif;font-size:.7rem;letter-spacing:.18em;
  border-top:1px solid rgba(201,168,76,.15);
  color:var(--text-muted);cursor:pointer;
}
.mob-sub-item:hover{ color:var(--accent); }

/* Bottom controls bar inside drawer */
.mob-drawer-ctrl{
  border-top:1px solid var(--accent);
  padding:1.1rem 1.4rem;
  display:flex;align-items:center;gap:1rem;flex-wrap:wrap;
}

@media(max-width:768px){
  /* Hide desktop nav, show mobile bar */
  #nav .nav-tabs,
  #nav .nav-ctrl{ display:none !important; }

  .mob-bar{
    display:flex;
    align-items:center;justify-content:space-between;
    padding:1rem 1.3rem;
    background:var(--nav-bg);
    border-top:2px solid var(--accent);
    border-bottom:1px solid var(--accent);
    position:sticky;top:0;z-index:150;
  }
  .mob-bar-label{
    font-family:'Cinzel',serif;font-size:.75rem;
    letter-spacing:.35em;color:var(--accent);
  }
  .mob-menu-btn{
    background:none;border:1px solid var(--accent);
    color:var(--accent);font-size:1.1rem;
    padding:.35rem .7rem;cursor:pointer;line-height:1;
  }
  .mob-menu-btn:hover{ background:rgba(201,168,76,.1); }
}
   
/* ════════════════════════════════════════
   NEWS REDESIGN
════════════════════════════════════════ */
.news-page-header{
  text-align:center;padding:2.5rem 1rem 2rem;
  position:relative;overflow:hidden;
  background:var(--surface);
  border:1px solid var(--hr);
  margin-bottom:2.5rem;
}
.news-page-header::before{
  content:'';position:absolute;inset:0;
  background:var(--pattern);background-size:60px 60px;opacity:.08;pointer-events:none;
}
.news-jp{font-family:'Ma Shan Zheng',serif;font-size:2.4rem;color:var(--accent);margin-bottom:.2rem;position:relative;}
.news-en{font-family:'Cinzel',serif;font-size:1.5rem;font-weight:700;letter-spacing:.12em;color:var(--text);margin-bottom:.8rem;position:relative;}
.news-desc{font-size:.97rem;color:var(--text-dim);max-width:560px;margin:0 auto;line-height:1.7;position:relative;}

/* Pinned/featured post */
.news-pinned{
  position:relative;border:2px solid var(--accent);
  display:grid;grid-template-columns:1fr 1fr;
  margin-bottom:2.5rem;background:var(--surface);overflow:hidden;
}
@media(max-width:680px){.news-pinned{grid-template-columns:1fr;}}
.news-pin-badge{
  position:absolute;top:.9rem;left:.9rem;z-index:2;
  background:var(--accent);color:var(--bg);
  font-family:'Cinzel',serif;font-size:.6rem;letter-spacing:.12em;
  padding:.28rem .7rem;display:flex;align-items:center;gap:.35rem;
}
.news-pin-img{
  position:relative;overflow:hidden;min-height:280px;
}
@media(max-width:680px){.news-pin-img{min-height:200px;}}
.news-pin-img-bg{
  width:100%;height:100%;object-fit:cover;display:block;
  background:linear-gradient(135deg,var(--crimson-deep),#1a0505);
  /* Fallback decorative pattern when no real image */
  min-height:280px;
}
.news-pin-timer{
  position:absolute;bottom:.7rem;left:.7rem;
  background:rgba(0,0,0,.7);color:#fff;
  font-family:'Cinzel',serif;font-size:.6rem;letter-spacing:.08em;
  padding:.2rem .5rem;display:flex;align-items:center;gap:.3rem;
}
.news-pin-content{padding:2rem 1.8rem;display:flex;flex-direction:column;justify-content:flex-end;}
@media(max-width:680px){.news-pin-content{padding:1.4rem;}}
.news-pin-badges{display:flex;gap:.5rem;margin-bottom:.9rem;flex-wrap:wrap;}
.nb{font-family:'Cinzel',serif;font-size:.6rem;letter-spacing:.1em;padding:.25rem .65rem;font-weight:700;}
.nb-featured{background:var(--accent);color:var(--bg);}
.nb-editors{background:#F5A623;color:#fff;}
.nb-chapter{background:#7B2D8B;color:#fff;}
.nb-announce{background:#2ECC71;color:#fff;}
.nb-date{font-size:.8rem;color:var(--text-muted);}
.news-pin-title{font-family:'Cinzel',serif;font-size:1.4rem;color:var(--accent);margin-bottom:.9rem;line-height:1.35;letter-spacing:.04em;}
@media(max-width:680px){.news-pin-title{font-size:1.1rem;}}
.news-pin-body{font-size:.97rem;color:var(--text-dim);line-height:1.75;margin-bottom:1.2rem;}
.news-pin-author{display:flex;align-items:center;gap:.65rem;}
.np-av{width:32px;height:32px;border-radius:50%;background:var(--surface2);border:1px solid var(--accent);display:flex;align-items:center;justify-content:center;font-family:'Cinzel',serif;font-size:.72rem;color:var(--accent);flex-shrink:0;}
.np-name{font-family:'Cinzel',serif;font-size:.75rem;color:var(--text);letter-spacing:.05em;}
.np-read{font-size:.72rem;color:var(--text-muted);display:flex;align-items:center;gap:.25rem;}
.np-stats{margin-left:auto;font-size:.78rem;color:var(--text-muted);display:flex;align-items:center;gap:.9rem;}
@media(max-width:500px){.np-stats{display:none;}}

/* News card grid (3-col) */
.news-grid-3{display:grid;grid-template-columns:repeat(3,1fr);gap:1.3rem;margin-bottom:2rem;}
@media(max-width:900px){.news-grid-3{grid-template-columns:repeat(2,1fr);}}
@media(max-width:560px){.news-grid-3{grid-template-columns:1fr;}}
.ngc{background:var(--surface);border:1px solid var(--hr);overflow:hidden;transition:all .25s;display:flex;flex-direction:column;}
.ngc:hover{border-color:var(--accent);box-shadow:var(--glow2);transform:translateY(-3px);}
.ngc-img{position:relative;overflow:hidden;}
.ngc-img-inner{
  width:100%;height:165px;object-fit:cover;display:block;
  background:linear-gradient(135deg,var(--crimson-deep) 0%,#2a0808 100%);
  transition:transform .5s;
}
.ngc:hover .ngc-img-inner{transform:scale(1.06);}
.ngc-badge{
  position:absolute;top:.65rem;left:.65rem;
  font-family:'Cinzel',serif;font-size:.55rem;letter-spacing:.1em;
  padding:.2rem .55rem;font-weight:700;color:#fff;text-transform:uppercase;
}
.ngc-share{
  position:absolute;top:.55rem;right:.55rem;
  display:flex;flex-direction:column;gap:.3rem;opacity:0;transition:opacity .2s;
}
.ngc:hover .ngc-share{opacity:1;}
.ngc-share-btn{
  width:26px;height:26px;border-radius:50%;
  display:flex;align-items:center;justify-content:center;
  font-size:.7rem;cursor:pointer;border:none;color:#fff;
  transition:transform .15s;
}
.ngc-share-btn:hover{transform:scale(1.1);}
.ngc-timer{position:absolute;bottom:.55rem;left:.65rem;background:rgba(0,0,0,.7);color:#fff;font-size:.6rem;padding:.2rem .45rem;font-family:'Cinzel',serif;display:flex;align-items:center;gap:.25rem;}
.ngc-body{padding:1rem .95rem;flex:1;display:flex;flex-direction:column;}
.ngc-meta{display:flex;align-items:center;gap:.5rem;margin-bottom:.6rem;}
.ngc-av{width:22px;height:22px;border-radius:50%;background:var(--surface2);border:1px solid var(--hr);display:flex;align-items:center;justify-content:center;font-size:.55rem;font-family:'Cinzel',serif;color:var(--accent);flex-shrink:0;}
.ngc-author{font-family:'Cinzel',serif;font-size:.62rem;color:var(--text-dim);}
.ngc-date{font-size:.62rem;color:var(--text-muted);}
.ngc-title{font-family:'Cinzel',serif;font-size:.88rem;color:var(--accent);margin-bottom:.5rem;line-height:1.38;letter-spacing:.03em;}
.ngc-excerpt{font-size:.85rem;color:var(--text-dim);line-height:1.65;flex:1;margin-bottom:.8rem;}
.ngc-tags{display:flex;flex-wrap:wrap;gap:.35rem;margin-bottom:.75rem;}
.ngc-tag{padding:.12rem .45rem;border:1px solid var(--hr);border-radius:20px;font-size:.62rem;color:var(--text-muted);}
.ngc-footer{display:flex;align-items:center;justify-content:space-between;padding-top:.65rem;border-top:1px solid var(--hr);}
.ngc-likes{font-size:.78rem;color:var(--text-muted);display:flex;align-items:center;gap:.25rem;}
.ngc-read-btn{
  font-family:'Cinzel',serif;font-size:.6rem;letter-spacing:.1em;text-transform:uppercase;
  border:1px solid var(--accent);color:var(--accent);background:transparent;
  padding:.28rem .7rem;cursor:pointer;transition:all .2s;
}
.ngc-read-btn:hover{background:var(--accent);color:var(--bg);}

/* News filter row */
.news-filters{display:flex;gap:.5rem;flex-wrap:wrap;align-items:center;margin-bottom:1.5rem;}
.nf-btn{
  padding:.38rem .85rem;font-family:'Cinzel',serif;font-size:.62rem;letter-spacing:.09em;
  border:1px solid var(--hr);color:var(--text-dim);background:transparent;cursor:pointer;
  border-radius:20px;transition:all .2s;
}
.nf-btn:hover{border-color:var(--accent);color:var(--accent);}
.nf-btn.active{border-color:var(--accent);color:var(--accent);background:var(--tag-bg);}
.news-section-title{
  display:flex;align-items:center;gap:.9rem;margin:2.2rem 0 1.3rem;
}
.news-section-title h3{font-family:'Cinzel',serif;font-size:.88rem;letter-spacing:.15em;color:var(--text);text-transform:uppercase;}
.news-section-title::after{content:'';flex:1;height:1px;background:var(--hr);}

/* Never-miss box */
.never-miss{
  text-align:center;padding:2.5rem 2rem;
  background:var(--surface);border:2px solid var(--accent);
  margin-top:2.5rem;position:relative;overflow:hidden;
}
.never-miss::before{content:'';position:absolute;inset:0;background:var(--pattern);background-size:60px 60px;opacity:.06;pointer-events:none;}
.nm-icon{
  width:56px;height:56px;border-radius:50%;border:2px solid var(--accent);
  display:flex;align-items:center;justify-content:center;margin:0 auto 1rem;
  font-size:1.5rem;background:var(--tag-bg);position:relative;
}
.never-miss h3{font-family:'Cinzel',serif;font-size:1.1rem;color:var(--accent);letter-spacing:.1em;margin-bottom:.6rem;position:relative;}
.never-miss p{font-size:.95rem;color:var(--text-dim);max-width:440px;margin:0 auto 1.4rem;line-height:1.7;position:relative;}

/* Discussion in news */
.disc-header-area{
  display:flex;align-items:center;justify-content:space-between;
  margin-bottom:1.5rem;flex-wrap:wrap;gap:.8rem;
}
.disc-header-area h3{font-family:'Cinzel',serif;font-size:.88rem;letter-spacing:.15em;color:var(--text);}

/* ════════════════════════════════════════
   THEORIES REDESIGN
════════════════════════════════════════ */
.th-page-header{
  text-align:center;padding:2rem 1rem 1.5rem;margin-bottom:2rem;
  position:relative;
}
.th-page-header h2{font-family:'Cinzel',serif;font-size:1.6rem;font-weight:700;color:var(--accent);letter-spacing:.14em;margin-bottom:.3rem;display:flex;align-items:center;justify-content:center;gap:.6rem;}
.th-page-header p{font-size:.97rem;color:var(--text-dim);max-width:560px;margin:0 auto;line-height:1.72;}

/* Guidelines box */
.th-guidelines{
  background:var(--surface);border:2px solid var(--accent);padding:1.5rem 1.8rem;margin-bottom:2rem;
  position:relative;overflow:hidden;
}
.th-guidelines::before{content:'';position:absolute;inset:0;background:var(--tag-bg);pointer-events:none;}
.th-guidelines h3{font-family:'Cinzel',serif;font-size:.88rem;letter-spacing:.12em;color:var(--accent);margin-bottom:1rem;display:flex;align-items:center;gap:.5rem;position:relative;}
.th-gl-list{list-style:none;display:flex;flex-direction:column;gap:.55rem;position:relative;}
.th-gl-list li{display:flex;align-items:flex-start;gap:.65rem;font-size:.95rem;color:var(--text-dim);line-height:1.6;}
.th-gl-list li::before{content:'✦';color:var(--accent);font-size:.7rem;flex-shrink:0;margin-top:.2rem;}

/* Theory submit form */
.th-submit-wrap{background:var(--surface);border:2px solid var(--accent);padding:1.8rem;margin-bottom:2.5rem;position:relative;overflow:hidden;}
.th-submit-wrap::before{content:'';position:absolute;top:0;left:0;right:0;height:3px;background:linear-gradient(90deg,var(--accent),var(--accent2),var(--accent));pointer-events:none;}
.th-form-title{font-family:'Cinzel',serif;font-size:1.2rem;color:var(--accent);letter-spacing:.1em;margin-bottom:1.5rem;}
.th-form-grid{display:grid;grid-template-columns:1fr 1fr;gap:1rem;margin-bottom:1rem;}
@media(max-width:560px){.th-form-grid{grid-template-columns:1fr;}}
.th-form-group{margin-bottom:1rem;}
.th-form-group label{display:block;font-family:'Cinzel',serif;font-size:.62rem;letter-spacing:.14em;color:var(--accent);margin-bottom:.38rem;text-transform:uppercase;}
.th-form-group input,.th-form-group select,.th-form-group textarea{
  width:100%;background:var(--in-bg);border:1px solid var(--in-border);color:var(--text);
  font-family:'Crimson Pro',serif;font-size:.97rem;padding:.68rem .9rem;transition:border-color .2s;
}
.th-form-group input:focus,.th-form-group select:focus,.th-form-group textarea:focus{outline:none;border-color:var(--accent);}
.th-form-group select{appearance:none;-webkit-appearance:none;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='11' height='7'%3E%3Cpath d='M1 1l4.5 4.5L10 1' stroke='%23C9A84C' fill='none' stroke-width='1.5'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right .9rem center;}
[data-theme="light"] .th-form-group select{background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='11' height='7'%3E%3Cpath d='M1 1l4.5 4.5L10 1' stroke='%238B1A1A' fill='none' stroke-width='1.5'/%3E%3C/svg%3E");}
.th-form-group textarea{min-height:120px;resize:vertical;}
.th-char-count{font-size:.72rem;color:var(--text-muted);margin-top:.25rem;text-align:right;}
.th-hr{border:none;border-top:1px solid var(--hr);margin:1.3rem 0;}
.th-check-row{display:flex;align-items:flex-start;gap:.75rem;margin-bottom:.85rem;cursor:pointer;}
.th-check-row input[type=checkbox]{width:16px;height:16px;margin-top:.12rem;accent-color:var(--accent);flex-shrink:0;cursor:pointer;}
.th-check-row span{font-size:.93rem;color:var(--text-dim);line-height:1.5;}
.th-check-row strong{color:var(--text);}
.th-submit-btn{
  width:100%;padding:.88rem;
  background:var(--accent);color:var(--bg);
  font-family:'Cinzel',serif;font-size:.82rem;letter-spacing:.15em;text-transform:uppercase;
  border:none;cursor:pointer;transition:all .22s;
  display:flex;align-items:center;justify-content:center;gap:.6rem;
}
.th-submit-btn:hover{background:var(--accent2);box-shadow:var(--glow);}

/* Popular theories grid */
.th-popular-title{
  font-family:'Cinzel',serif;font-size:1.2rem;color:var(--accent);letter-spacing:.12em;
  text-align:center;margin:2.5rem 0 1.5rem;display:flex;align-items:center;justify-content:center;gap:.6rem;
}
.th-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:1.2rem;}
@media(max-width:620px){.th-grid{grid-template-columns:1fr;}}
.th-gc{background:var(--surface);border:1px solid var(--accent);padding:1.2rem;transition:all .25s;position:relative;overflow:hidden;}
.th-gc:hover{box-shadow:var(--glow2);transform:translateY(-2px);}
.th-gc-top{display:flex;align-items:center;justify-content:space-between;margin-bottom:.75rem;}
.th-gc-cat{
  font-family:'Cinzel',serif;font-size:.6rem;letter-spacing:.08em;
  padding:.2rem .55rem;background:var(--tag-bg);color:var(--accent);border:1px solid var(--accent);
}
.th-gc-likes{display:flex;align-items:center;gap:.3rem;font-size:.82rem;color:var(--text-muted);}
.th-gc-likes span{color:var(--accent);font-size:.95rem;}
.th-gc-title{font-family:'Cinzel',serif;font-size:.95rem;color:var(--text);margin-bottom:.5rem;line-height:1.38;letter-spacing:.03em;}
.th-gc-body{font-size:.87rem;color:var(--text-dim);line-height:1.65;margin-bottom:.8rem;}
.th-gc-footer{font-size:.78rem;color:var(--text-muted);}
/* ════════════════════════════════════════
   RULES REDESIGN
════════════════════════════════════════ */
.rules-page-hdr{
  text-align:center;padding:2rem 1rem 1.5rem;margin-bottom:2.2rem;
}
.rules-page-hdr h2{font-family:'Cinzel',serif;font-size:1.65rem;font-weight:700;color:var(--accent);letter-spacing:.14em;margin-bottom:.7rem;}
.rules-page-hdr p{font-size:.97rem;color:var(--text-dim);max-width:540px;margin:0 auto;line-height:1.72;}
.rules-card-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:1.2rem;margin-bottom:2.5rem;}
@media(max-width:640px){.rules-card-grid{grid-template-columns:1fr;}}
.rule-card{
  background:var(--surface);border:2px solid var(--accent);padding:1.4rem 1.4rem 1.4rem 1.2rem;
  display:flex;gap:1.1rem;align-items:flex-start;transition:all .22s;
}
.rule-card:hover{background:var(--surface2);box-shadow:var(--glow2);transform:translateY(-2px);}
.rule-card-icon{
  width:50px;height:50px;border-radius:50%;border:2px solid var(--accent);
  display:flex;align-items:center;justify-content:center;font-size:1.2rem;
  flex-shrink:0;background:var(--tag-bg);
}
.rule-card-body h4{font-family:'Cinzel',serif;font-size:.88rem;color:var(--accent);letter-spacing:.07em;margin-bottom:.5rem;}
.rule-card-body p{font-size:.9rem;line-height:1.72;color:var(--text-dim);}

/* Consequences block */
.consequences-box{
  background:var(--surface);border:2px solid var(--accent);padding:2rem 1.8rem;margin-bottom:1.5rem;
  position:relative;overflow:hidden;
}
.consequences-box::before{content:'';position:absolute;inset:0;background:var(--tag-bg);pointer-events:none;}
.consequences-title{font-family:'Cinzel',serif;font-size:1.15rem;color:var(--accent);letter-spacing:.1em;text-align:center;margin-bottom:1.8rem;position:relative;}
.consequences-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:1.2rem;position:relative;}
@media(max-width:600px){.consequences-grid{grid-template-columns:1fr;}}
.cq-item{text-align:center;}
.cq-icon{
  width:52px;height:52px;border-radius:50%;border:2px solid var(--accent);
  display:flex;align-items:center;justify-content:center;font-size:1.3rem;
  margin:0 auto .9rem;background:var(--tag-bg);
}
.cq-title{font-family:'Cinzel',serif;font-size:.82rem;letter-spacing:.1em;color:var(--text);margin-bottom:.6rem;}
.cq-body{font-size:.88rem;line-height:1.68;color:var(--text-dim);}
.cq-body strong{color:var(--text);}

/* Strike system redesign */
.strikes-wrap{margin-bottom:1.5rem;}
.strikes-title{font-family:'Cinzel',serif;font-size:1rem;letter-spacing:.15em;color:var(--accent);text-transform:uppercase;margin-bottom:1.2rem;text-align:center;}
.strikes-list{display:flex;flex-direction:column;gap:.75rem;}
.sk{display:flex;align-items:flex-start;gap:1rem;padding:1rem 1.3rem;background:var(--surface);border:1px solid var(--hr);transition:background .2s;}
.sk:hover{background:var(--surface2);}
.sk-num{
  font-family:'Cinzel',serif;font-size:.62rem;letter-spacing:.1em;color:#fff;
  padding:.22rem .55rem;white-space:nowrap;flex-shrink:0;margin-top:.12rem;font-weight:700;
}
.sk-num.s1,.sk-num.s2,.sk-num.s3,.sk-num.s4{background:var(--accent);color:var(--bg);}
.sk-num.s5{background:var(--crimson);}
.sk-num.s6{background:var(--crimson-deep);}
.sk-body h4{font-family:'Cinzel',serif;font-size:.78rem;color:var(--accent);margin-bottom:.3rem;letter-spacing:.07em;}
.sk.s5 .sk-body h4,.sk.s6 .sk-body h4{color:var(--crimson-bright);}
.sk-body p{font-size:.93rem;line-height:1.7;}

/* Questions box */
.questions-box{
  background:var(--surface);border:2px solid var(--accent);padding:2.2rem 1.8rem;
  text-align:center;position:relative;overflow:hidden;
}
.questions-box::before{content:'';position:absolute;inset:0;background:var(--tag-bg);pointer-events:none;}
.qb-icon{font-size:2rem;margin-bottom:.8rem;position:relative;}
.qb-title{font-family:'Cinzel',serif;font-size:1.1rem;color:var(--accent);letter-spacing:.1em;margin-bottom:.7rem;position:relative;}
.qb-body{font-size:.97rem;color:var(--text-dim);line-height:1.72;max-width:500px;margin:0 auto 1.3rem;position:relative;}

/* ════════════════════════════════════════
   ARTICLE MODAL
════════════════════════════════════════ */
.art-modal-ov{
  position:fixed;inset:0;background:rgba(0,0,0,.88);z-index:1001;
  display:none;align-items:flex-start;justify-content:center;
  padding:1.5rem 1rem;overflow-y:auto;
  backdrop-filter:blur(8px);-webkit-backdrop-filter:blur(8px);
}
.art-modal-ov.open{display:flex;animation:fi .22s ease;}
.art-modal{
  background:var(--bg);border:1px solid var(--accent);
  max-width:720px;width:100%;position:relative;margin:auto;
}
.art-modal-hero{
  position:relative;min-height:260px;overflow:hidden;
  background:linear-gradient(135deg,var(--crimson-deep),#3a0505);
  display:flex;align-items:flex-end;
}
@media(max-width:540px){.art-modal-hero{min-height:180px;}}
.art-modal-hero-bg{
  position:absolute;inset:0;display:flex;align-items:center;justify-content:center;
  font-size:6rem;opacity:.18;
}
.art-modal-hero-overlay{
  position:absolute;inset:0;
  background:linear-gradient(to top,rgba(0,0,0,.85) 0%,rgba(0,0,0,.2) 60%,transparent 100%);
}
.art-modal-hero-content{position:relative;z-index:2;padding:1.5rem 1.8rem 1.4rem;}
.art-modal-badges{display:flex;flex-wrap:wrap;gap:.45rem;margin-bottom:.75rem;}
.art-modal-title{font-family:'Cinzel',serif;font-size:1.4rem;color:#fff;line-height:1.3;letter-spacing:.04em;}
@media(max-width:540px){.art-modal-title{font-size:1.1rem;}}
.art-modal-close{
  position:absolute;top:.75rem;right:.75rem;z-index:10;
  width:34px;height:34px;border-radius:50%;background:rgba(0,0,0,.72);border:none;color:#fff;
  font-size:1rem;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:background .2s;
}
.art-modal-close:hover{background:var(--crimson);}
.art-modal-meta-bar{
  display:flex;align-items:center;gap:1rem;padding:.9rem 1.8rem;
  border-bottom:1px solid var(--hr);flex-wrap:wrap;
}
.am-av{width:36px;height:36px;border-radius:50%;background:var(--surface2);border:1px solid var(--accent);display:flex;align-items:center;justify-content:center;font-family:'Cinzel',serif;font-size:.78rem;color:var(--accent);flex-shrink:0;}
.am-name{font-family:'Cinzel',serif;font-size:.82rem;color:var(--text);letter-spacing:.05em;}
.am-date{font-size:.78rem;color:var(--text-muted);}
.am-read{font-size:.78rem;color:var(--text-muted);display:flex;align-items:center;gap:.25rem;}
.am-stats{margin-left:auto;display:flex;gap:.9rem;font-size:.82rem;color:var(--text-muted);}
.art-modal-body{padding:1.6rem 1.8rem;}
@media(max-width:540px){.art-modal-body{padding:1.2rem 1.1rem;}}
.art-modal-body p{font-size:1.02rem;line-height:1.85;color:var(--text);margin-bottom:1.1rem;}
.art-modal-body p:last-child{margin-bottom:0;}
.art-modal-body h3{font-family:'Cinzel',serif;font-size:.92rem;color:var(--accent);letter-spacing:.1em;margin-bottom:.6rem;margin-top:1.2rem;}
/* Share bar */
.art-share-bar{
  display:flex;align-items:center;justify-content:space-between;
  padding:.85rem 1.8rem;border-top:1px solid var(--hr);border-bottom:1px solid var(--hr);
}
.art-share-label{font-family:'Cinzel',serif;font-size:.62rem;letter-spacing:.18em;color:var(--text-muted);text-transform:uppercase;}
.art-share-btns{display:flex;gap:.5rem;}
.art-share-btn{
  width:36px;height:36px;border-radius:50%;border:1px solid var(--hr);background:var(--surface);
  display:flex;align-items:center;justify-content:center;font-size:.85rem;cursor:pointer;
  transition:border-color .2s,transform .15s;color:var(--text-dim);
}
.art-share-btn:hover{border-color:var(--accent);transform:scale(1.1);}
/* Comments in article modal */
.art-comments{padding:1.4rem 1.8rem;}
@media(max-width:540px){.art-comments{padding:1.1rem 1.1rem;}}
.art-comments-title{font-family:'Cinzel',serif;font-size:.95rem;color:var(--accent);letter-spacing:.1em;margin-bottom:1.2rem;display:flex;align-items:center;gap:.5rem;}
.ac{background:var(--surface);border:1px solid var(--hr);border-radius:2px;padding:1rem 1.1rem;margin-bottom:.9rem;}
.ac-top{display:flex;align-items:center;gap:.7rem;margin-bottom:.6rem;flex-wrap:wrap;}
.ac-av{width:32px;height:32px;border-radius:50%;background:var(--surface2);border:1px solid var(--hr);overflow:hidden;flex-shrink:0;display:flex;align-items:center;justify-content:center;font-family:'Cinzel',serif;font-size:.7rem;color:var(--accent);}
.ac-av img{width:100%;height:100%;object-fit:cover;}
.ac-name{font-family:'Cinzel',serif;font-size:.8rem;color:var(--text);}
.ac-date{font-size:.75rem;color:var(--text-muted);margin-left:auto;}
.ac-body{font-size:.95rem;line-height:1.7;color:var(--text-dim);margin-bottom:.55rem;}
.ac-acts{display:flex;gap:.75rem;}
.ac-act{background:none;border:none;font-size:.82rem;color:var(--text-muted);cursor:pointer;padding:0;transition:color .2s;font-family:'Crimson Pro',serif;}
.ac-act:hover{color:var(--accent);}
/* Comment form / gate inside article */
.art-comment-form{padding:0 1.8rem 1.8rem;}
@media(max-width:540px){.art-comment-form{padding:0 1.1rem 1.2rem;}}
.art-disc-cta{
  border:2px dashed var(--accent);padding:1.4rem;text-align:center;
}
.art-disc-cta p{font-size:.93rem;color:var(--text-dim);margin-bottom:1rem;}
.art-comment-input{
  width:100%;background:var(--in-bg);border:1px solid var(--in-border);color:var(--text);
  font-family:'Crimson Pro',serif;font-size:.97rem;padding:.7rem .95rem;min-height:80px;resize:vertical;
  transition:border-color .2s;margin-bottom:.75rem;display:block;
}
.art-comment-input:focus{outline:none;border-color:var(--accent);}
/* ── Stats Grid ── */
.stats-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:1.1rem;margin-bottom:2.5rem;}
@media(max-width:640px){.stats-grid{grid-template-columns:repeat(2,1fr);}}
.stat-card{
  background:var(--surface);border:2px solid var(--accent);
  padding:1.5rem 1rem;text-align:center;position:relative;overflow:hidden;
  transition:transform .22s,box-shadow .22s;
}
.stat-card:hover{transform:translateY(-3px);box-shadow:var(--glow2);}
.stat-card::before{content:'';position:absolute;inset:0;background:var(--tag-bg);pointer-events:none;}
.stat-icon{font-size:1.8rem;margin-bottom:.5rem;position:relative;}
.stat-val{
  font-family:'Cinzel',serif;font-size:2rem;font-weight:700;
  color:var(--accent);line-height:1;margin-bottom:.3rem;position:relative;
  text-shadow:0 0 12px rgba(201,168,76,.35);
}
.stat-label{font-family:'Cinzel',serif;font-size:.6rem;letter-spacing:.18em;color:var(--text-muted);text-transform:uppercase;position:relative;}

/* ── What We Offer Grid ── */
.offer-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:1.2rem;margin-bottom:2rem;}
@media(max-width:760px){.offer-grid{grid-template-columns:repeat(2,1fr);}}
@media(max-width:480px){.offer-grid{grid-template-columns:1fr;}}
.offer-card{
  background:var(--surface);border:1px solid var(--hr);padding:1.4rem;
  transition:all .22s;position:relative;
}
.offer-card:hover{border-color:var(--accent);box-shadow:var(--glow2);transform:translateY(-2px);}
.offer-card::after{content:'';position:absolute;top:0;left:0;right:0;height:2px;background:var(--accent);transform:scaleX(0);transform-origin:left;transition:transform .3s;}
.offer-card:hover::after{transform:scaleX(1);}
.offer-icon{font-size:1.6rem;margin-bottom:.6rem;}
.offer-card h4{font-family:'Cinzel',serif;font-size:.82rem;color:var(--accent);letter-spacing:.1em;margin-bottom:.5rem;}
.offer-card p{font-size:.9rem;line-height:1.7;color:var(--text-dim);}

/* ── Theory voting ── */
.th-vote-row{display:flex;align-items:center;gap:.5rem;margin-top:.5rem;}
.vote-btn{
  display:flex;align-items:center;gap:.3rem;
  background:none;border:1px solid var(--hr);color:var(--text-dim);
  font-size:.78rem;padding:.22rem .55rem;cursor:pointer;transition:all .2s;
  font-family:'Cinzel',serif;
}
.vote-btn:hover{border-color:var(--accent);color:var(--accent);}
.vote-btn.voted-up{border-color:#57F287;color:#57F287;background:rgba(87,242,135,.1);}
.vote-btn.voted-down{border-color:var(--crimson-bright);color:var(--crimson-bright);background:rgba(192,39,45,.1);}
.vote-score{font-family:'Cinzel',serif;font-size:.82rem;color:var(--accent);min-width:28px;text-align:center;}

/* ── News cards fully clickable ── */
.ngc{cursor:pointer;}
.news-pinned{cursor:pointer;}
.news-pinned:hover{box-shadow:var(--glow2);}

/* ── Theory form auto-fill read-only fields ── */
.th-readonly{
  background:var(--surface2)!important;border-color:var(--hr)!important;
  color:var(--text-dim)!important;cursor:default!important;opacity:1!important;
}
.th-readonly:focus{border-color:var(--hr)!important;}

/* ── Comment gate inside article ── */
.comment-gate{
  background:var(--surface);border:1px solid var(--accent);
  padding:1.2rem;text-align:center;margin-top:.5rem;
}
.comment-gate p{font-size:.93rem;color:var(--text-dim);margin-bottom:.8rem;}

/* ── News empty state ── */
.news-empty{
  text-align:center;padding:3.5rem 2rem;background:var(--surface);
  border:1px dashed var(--hr);margin-bottom:1.5rem;
}
.news-empty-ico{font-size:2.4rem;margin-bottom:.7rem;opacity:.5;}
.news-empty h3{font-family:'Cinzel',serif;font-size:.9rem;color:var(--text-muted);letter-spacing:.1em;margin-bottom:.4rem;}
.news-empty p{font-size:.88rem;color:var(--text-muted);}

/* ── Discussion form ── */
.disc-form-wrap{
  background:var(--surface);border:1px solid var(--accent);
  padding:1.2rem;margin-bottom:1.2rem;
}
.disc-av-row{display:flex;align-items:center;gap:.8rem;margin-bottom:.8rem;}
.disc-form-av{
  width:38px;height:38px;border-radius:50%;background:var(--surface2);
  border:2px solid var(--accent);flex-shrink:0;overflow:hidden;
  display:flex;align-items:center;justify-content:center;
  font-family:'Cinzel',serif;font-size:.9rem;color:var(--accent);
}
.disc-form-av img{width:100%;height:100%;object-fit:cover;}
.disc-select{
  width:100%;background:var(--in-bg);border:1px solid var(--in-border);
  color:var(--text);font-family:'Crimson Pro',serif;font-size:.95rem;
  padding:.5rem .75rem;
}
.disc-textarea{
  width:100%;background:var(--in-bg);border:1px solid var(--in-border);
  color:var(--text);font-family:'Crimson Pro',serif;font-size:.97rem;
  padding:.7rem .95rem;min-height:90px;resize:vertical;
  margin-bottom:.75rem;display:block;transition:border-color .2s;
}
.disc-textarea:focus{outline:none;border-color:var(--accent);}
.disc-list{display:flex;flex-direction:column;gap:.8rem;}

/* ── Theory card meta row (avatar + author + date) ── */
.th-gc-meta{display:flex;align-items:center;gap:.5rem;margin-bottom:.5rem;flex-wrap:wrap;}
.th-gc-av{
  width:24px;height:24px;border-radius:50%;
  background:var(--surface2);border:1px solid var(--hr);
  overflow:hidden;flex-shrink:0;display:flex;align-items:center;
  justify-content:center;font-family:'Cinzel',serif;font-size:.58rem;color:var(--accent);
}
.th-gc-av img{width:100%;height:100%;object-fit:cover;}
.th-gc-date{font-size:.73rem;color:var(--text-muted);}
/* Force readable colors in all themes */
.th-gc-title{font-family:'Cinzel',serif;font-size:.95rem;color:var(--text)!important;margin-bottom:.4rem;line-height:1.38;letter-spacing:.03em;}
.th-gc-body{font-size:.87rem;color:var(--text-dim)!important;line-height:1.65;margin-bottom:.6rem;opacity:1!important;}
.th-gc-footer{font-size:.76rem;color:var(--text-muted)!important;opacity:1!important;}
/* ac-name readable */
.ac-name{font-family:'Cinzel',serif;font-size:.78rem;color:var(--text)!important;}
.th-autofill-notice{
  display:flex;align-items:center;gap:.5rem;
  font-size:.82rem;color:var(--text-muted);font-style:italic;
  margin-bottom:1rem;padding:.55rem .85rem;
  background:rgba(201,168,76,.08);border-left:2px solid var(--accent);
}

/* ── Theory card vote buttons ── */
.th-gc-actions{
  display:flex;align-items:center;gap:.5rem;
  padding-top:.6rem;border-top:1px solid var(--hr);margin-top:.5rem;
}
.th-vote-up,.th-vote-down{
  display:flex;align-items:center;gap:.28rem;
  background:none;border:1px solid var(--hr);
  color:var(--text-muted);font-size:.78rem;
  padding:.2rem .55rem;cursor:pointer;transition:all .2s;
}
.th-vote-up:hover,.th-vote-up.active{border-color:#57F287;color:#57F287;background:rgba(87,242,135,.1);}
.th-vote-down:hover,.th-vote-down.active{border-color:var(--crimson-bright);color:var(--crimson-bright);background:rgba(192,39,45,.1);}
.th-vote-score{font-family:'Cinzel',serif;font-size:.82rem;color:var(--accent);min-width:24px;text-align:center;margin-left:auto;}

/* ── Article clickable cursor ── */
.ngc,.news-pinned{cursor:pointer;transition:transform .2s,box-shadow .2s;}
.ngc:hover{transform:translateY(-3px);box-shadow:var(--glow2);}

/* ── Comment role badge ── */
.ac-role{
  font-size:.58rem;font-family:'Cinzel',serif;letter-spacing:.1em;
  padding:.12rem .38rem;margin-left:.4rem;
  background:rgba(88,101,242,.2);color:#818cf8;border:1px solid rgba(88,101,242,.3);
}
.ac-role.staff{background:rgba(201,168,76,.15);color:var(--accent);border-color:rgba(201,168,76,.3);}

   /* existing responsive styles above */

@media(max-width:380px){
  .nav-tabs li>a,.nav-tabs li>button{padding:.68rem .35rem;font-size:.52rem;}
  .staff-grid{grid-template-columns:repeat(2,1fr);}
  .cd-ev{display:none;}
}

/* ════════════════════════════════════════
   MOBILE NAVIGATION DRAWER
════════════════════════════════════════ */

/* Hide desktop nav on mobile */
@media(max-width:768px){
  #nav{ display:none !important; }
  .mob-bar{ display:flex !important; }
}
@media(min-width:769px){
  .mob-bar{ display:none !important; }
  .mob-drawer,.mob-drawer-ov{ display:none !important; }
}

/* Mobile sticky bar */
.mob-bar{
  display:none;
  position:sticky;top:0;z-index:500;
  align-items:center;justify-content:space-between;
  padding:.55rem 1.1rem;
  background:var(--nav-bg);
  border-bottom:1px solid var(--accent);
}

/* Overlay */
.mob-drawer-ov{
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.72);
  z-index:900;
}
.mob-drawer-ov.open{ display:block; }

/* Drawer */
.mob-drawer{
  position:fixed;
  top:0;
  left:0;
  width:min(82vw,360px);
  height:100%;
  background:var(--nav-bg);
  z-index:901;
  transform:translateX(-100%);
  transition:transform .3s ease;
}
.mob-drawer.open{ transform:translateX(0); }

   /* ════════════════════════════════════════
   MOBILE NAVIGATION — DRAWER STYLE
════════════════════════════════════════ */

@media(max-width:768px){

  /* Hide desktop nav */
  #nav{display:none !important;}

  /* Top mobile bar */
  .mob-bar{
    display:flex;
    position:sticky;
    top:0;
    z-index:500;
    align-items:center;
    justify-content:space-between;
    padding:.9rem 1.2rem;
    background:var(--nav-bg);
    border-top:2px solid var(--accent);
    border-bottom:1px solid var(--accent);
  }

  .mob-bar-label{
    font-family:'Cinzel',serif;
    font-size:.7rem;
    letter-spacing:.35em;
    color:var(--accent);
  }

  .mob-menu-btn{
    background:none;
    border:1px solid var(--accent);
    color:var(--accent);
    padding:.35rem .7rem;
    font-size:1.1rem;
    cursor:pointer;
  }

  /* Overlay */
  .mob-drawer-ov{
    display:none;
    position:fixed;
    inset:0;
    background:rgba(0,0,0,.75);
    z-index:900;
  }

  .mob-drawer-ov.open{display:block;}

  /* Drawer */
  .mob-drawer{
    position:fixed;
    top:0;
    left:0;
    width:85%;
    max-width:360px;
    height:100%;
    background:var(--bg);
    border-right:2px solid var(--accent);
    transform:translateX(-100%);
    transition:transform .3s ease;
    z-index:901;
    display:flex;
    flex-direction:column;
  }

  .mob-drawer.open{transform:translateX(0);}

  /* Drawer header */
  .mob-drawer-hdr{
    display:flex;
    justify-content:space-between;
    align-items:center;
    padding:1.2rem 1.4rem;
    border-bottom:1px solid var(--accent);
  }

  .mob-drawer-title{
    font-family:'Cinzel',serif;
    font-size:.75rem;
    letter-spacing:.4em;
    color:var(--accent);
  }

  .mob-drawer-close{
    background:none;
    border:none;
    color:var(--accent);
    font-size:1.2rem;
    cursor:pointer;
  }

  /* Nav list */
  .mob-nav-list{
    list-style:none;
    padding:0;
    margin:0;
    flex:1;
  }

  .mob-nav-item{
    border-bottom:1px solid rgba(201,168,76,.25);
  }

  .mob-nav-row,
  .mob-nav-label{
    display:flex;
    justify-content:space-between;
    align-items:center;
    padding:1.15rem 1.4rem;
    font-family:'Cinzel',serif;
    font-size:.78rem;
    letter-spacing:.25em;
    text-transform:uppercase;
    color:var(--text-dim);
    cursor:pointer;
  }

  .mob-nav-item.active{
    background:rgba(201,168,76,.08);
  }

  .mob-nav-item.active .mob-nav-label{
    color:var(--accent);
  }

  .mob-nav-arrow{
    font-size:1rem;
    transition:transform .2s;
  }

  .mob-nav-item.sub-open .mob-nav-arrow{
    transform:rotate(180deg);
  }

  /* Sub items */
  .mob-sub-list{
    display:none;
    list-style:none;
    padding:0;
    margin:0;
    background:#1a0606;
  }

  .mob-sub-item{
    padding:1rem 1.8rem;
    font-family:'Cinzel',serif;
    font-size:.7rem;
    letter-spacing:.18em;
    color:var(--text-muted);
    border-top:1px solid rgba(201,168,76,.15);
    cursor:pointer;
  }

  .mob-sub-item:hover{
    color:var(--accent);
  }

  /* Bottom controls */
  .mob-drawer-ctrl{
    padding:1rem 1.4rem;
    border-top:1px solid var(--accent);
    display:flex;
    gap:.8rem;
    align-items:center;
  }

}
   
</style>
</head>
<body>

<!-- ════ COUNTDOWN ════ -->
<div id="cd-bar">
  <span class="cd-label">Next Chapter Drop</span>
  <div class="cd-units">
    <div class="cd-unit"><span class="cd-n" id="cd-d">--</span><span class="cd-t">Days</span></div>
    <span class="cd-sep">:</span>
    <div class="cd-unit"><span class="cd-n" id="cd-h">--</span><span class="cd-t">Hrs</span></div>
    <span class="cd-sep">:</span>
    <div class="cd-unit"><span class="cd-n" id="cd-m">--</span><span class="cd-t">Min</span></div>
    <span class="cd-sep">:</span>
    <div class="cd-unit"><span class="cd-n" id="cd-s">--</span><span class="cd-t">Sec</span></div>
  </div>
  <span class="cd-ev">— Chapter Release —</span>
  <button class="cd-x" id="cd-x">✕</button>
</div>

<!-- ════ HEADER ════ -->
<header id="hdr">
  <div class="hdr-inner">
    <div class="glitch-wrap" id="gl">
      <img src="assets/images/logo-en.png" alt="Gokurakugai" class="logo-en-gl" id="logo-main">
      <img src="assets/images/logo-jp.png" alt="極楽街" class="logo-jp-gl" id="logo-jp-gl">
      <div class="gl-r"><img src="
      <div class="gl-r"><img src="assets/images/logo-en.png" alt="" aria-hidden="true"></div>
      <div class="gl-b"><img src="assets/images/logo-en.png" alt="" aria-hidden="true"></div>
    </div>
    <p class="hdr-tag">Fan Community · Est. 2022</p>
  </div>
</header>

<div class="mob-bar" id="mob-bar">
  <span class="mob-bar-label">NAVIGATION</span>
  <button class="mob-menu-btn" id="mob-menu-btn" aria-label="Open navigation">&#9776;</button>
</div>

<nav id="nav">
  <div class="nav-in">
    <ul class="nav-tabs">
      <li><a href="#" class="tab active" data-tab="about">About</a></li>
      <li>
        <a href="#" class="tab" data-tab="manga">Manga</a>
      </li>
      <li>
        <a href="#" class="tab" data-tab="news">News</a>
      </li>
      <li><a href="#" class="tab" data-tab="theories">Theories</a></li>
      <li><a href="#" class="tab" data-tab="rules">Rules</a></li>
      <li><a href="#" class="tab" data-tab="info">Info</a></li>
      <li><a href="#" class="tab" data-tab="staff">Staff</a></li>
    </ul>
    <div class="nav-ctrl">
      <div class="tt" title="Toggle theme">
        <span class="tt-icon">🌙</span>
        <div class="tt-track" id="tt" role="switch" tabindex="0">
          <div class="tt-thumb"></div>
        </div>
        <span class="tt-icon">☀️</span>
      </div>
      <div class="dc-zone" id="dc-zone">
        <button id="dc-login-btn" title="Login with Discord">
          <svg viewBox="0 0 71 55" fill="currentColor"><path d="M60.1 4.9A58.5 58.5 0 0 0 45.4.6a.2.2 0 0 0-.2.1c-.6 1.1-1.3 2.5-1.8 3.7a54.1 54.1 0 0 0-16.2 0 38 38 0 0 0-1.8-3.7.22.22 0 0 0-.2-.1A58.4 58.4 0 0 0 10.5 4.9a.2.2 0 0 0-.1.1C1.6 18.1-.9 31 .3 43.6a.2.2 0 0 0 .1.2 58.8 58.8 0 0 0 17.7 8.9.22.22 0 0 0 .2-.1 42 42 0 0 0 3.6-5.9.2.2 0 0 0-.1-.3 38.7 38.7 0 0 1-5.5-2.6.2.2 0 0 1 0-.3l1.1-.9a.2.2 0 0 1 .2 0c11.5 5.3 24 5.3 35.4 0a.2.2 0 0 1 .2 0l1.1.9a.2.2 0 0 1 0 .3 36.1 36.1 0 0 1-5.5 2.6.2.2 0 0 0-.1.3 47.1 47.1 0 0 0 3.6 5.9.2.2 0 0 0 .2.1 58.6 58.6 0 0 0 17.7-8.9.2.2 0 0 0 .1-.2c1.5-14.8-2.5-27.7-10.4-39.1a.2.2 0 0 0-.1-.1zM23.7 36.2c-3.5 0-6.4-3.2-6.4-7.1s2.9-7.1 6.4-7.1c3.5 0 6.4 3.2 6.4 7.1-.1 3.9-2.9 7.1-6.4 7.1zm23.6 0c-3.5 0-6.4-3.2-6.4-7.1s2.9-7.1 6.4-7.1c3.5 0 6.4 3.2 6.4 7.1 0 3.9-2.9 7.1-6.4 7.1z"/></svg>
          <span>Login</span>
        </button>
        <div id="dc-user-wrap">
          <div class="dc-btn" id="dc-btn">
            <div class="dc-av-ph" id="dc-av-ph">?</div>
            <img class="dc-av" id="dc-av-img" src="" alt="" style="display:none">
            <span class="dc-uname" id="dc-uname">User</span>
            <div class="dc-dot" id="dc-dot" style="display:none" title="Server Member"></div>
          </div>
          <div class="dc-dd" id="dc-dd">
            <!-- Profile Card -->
            <div class="dc-profile-card" id="dc-profile-card">
              <div class="dpc-banner" id="dpc-banner"></div>
              <div class="dpc-avatar-row">
                <div class="dpc-av-wrap">
                  <div class="dpc-av" id="dpc-av"></div>
                  <span class="dpc-status"></span>
                </div>
                <div class="dpc-badges" id="dpc-badges">
                  <span class="dpc-badge">🔮 Member</span>
                </div>
              </div>
              <div class="dpc-body">
                <div class="dpc-displayname" id="dpc-displayname">—</div>
                <div class="dpc-username" id="dpc-username">@—</div>
                <div class="dpc-divider"></div>
                <div class="dpc-fields">
                  <div class="dpc-field" id="dpc-pronouns-row" style="display:none">
                    <div class="dpc-label">PRONOUNS</div>
                    <div class="dpc-val" id="dpc-pronouns">—</div>
                  </div>
                  <div class="dpc-field">
                    <div class="dpc-label">USER ID</div>
                    <div class="dpc-val dpc-mono" id="dpc-uid">—</div>
                  </div>
                  <div class="dpc-field">
                    <div class="dpc-label">SERVER MEMBER SINCE</div>
                    <div class="dpc-val" id="dpc-joined">—</div>
                  </div>
                </div>
                <div id="dpc-bio-row" style="display:none">
                  <div class="dpc-divider"></div>
                  <div class="dpc-label" style="margin-bottom:.3rem">ABOUT ME</div>
                  <div class="dpc-bio" id="dpc-bio">—</div>
                </div>
                <div class="dpc-divider"></div>
                <div class="dpc-label" style="margin-bottom:.4rem">ROLES</div>
                <div class="dpc-roles" id="dpc-roles">
                  <span class="dpc-role dpc-role-member">Member</span>
                </div>
              </div>
            </div>
            <div class="dpc-actions">
              <button class="dc-out" id="dc-logout">⬡ Logout</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</nav>
<!-- Mobile nav drawer -->
<div class="mob-drawer-ov" id="mob-drawer-ov" onclick="closeMobDrawer()"></div>

<div class="mob-drawer" id="mob-drawer">
  <div class="mob-drawer-hdr">
    <span class="mob-drawer-title">NAVIGATION</span>
    <button class="mob-drawer-close" id="mob-drawer-close" onclick="closeMobDrawer()">&#10005;</button>
  </div>
  <ul class="mob-nav-list" id="mob-nav-list">
    <li class="mob-nav-item active" data-tab="about">
      <span class="mob-nav-label">ABOUT</span>
    </li>
    <li class="mob-nav-item has-sub" data-tab="manga">
      <div class="mob-nav-row">
        <span>MANGA</span>
        <span class="mob-nav-arrow">&#8964;</span>
      </div>
      <ul class="mob-sub-list" id="mob-manga-sub" style="display:none;">
        <li class="mob-sub-item" data-tab="manga" data-sub="gallery">Gallery</li>
        <li class="mob-sub-item" data-tab="manga" data-sub="chars">Characters</li>
      </ul>
    </li>
    <li class="mob-nav-item" data-tab="rules">
      <span class="mob-nav-label">RULES</span>
    </li>
    <li class="mob-nav-item" data-tab="info">
      <span class="mob-nav-label">INFO</span>
    </li>
    <li class="mob-nav-item" data-tab="news">
      <span class="mob-nav-label">NEWS</span>
    </li>
    <li class="mob-nav-item" data-tab="theories">
      <span class="mob-nav-label">THEORIES</span>
    </li>
    <li class="mob-nav-item" data-tab="staff">
      <span class="mob-nav-label">STAFF</span>
    </li>
  </ul>
  <div class="mob-drawer-ctrl" id="mob-drawer-ctrl"></div>
</div>

<!-- ════ MAIN ════ -->
<main id="content">

<!-- ══ ABOUT ══ -->
<section id="about" class="sec active">
  <div class="sec-hdr">
    <span class="jp">極楽街へようこそ</span>
    <span class="en">Welcome to Gokurakugai</span>
  </div>
  <div class="sdiv"><span>✦</span></div>
  <div class="about-g">
    <div class="about-text">
      <p class="lead">"In the labyrinthine streets of a crimson city, two unlikely partners navigate the shadows between the living and the damned."</p>
      <p>Welcome to the <strong style="color:var(--accent)">Gokurakugai Fan Community</strong> — your premier destination for everything related to Yuto Sano's thrilling manga series. Whether you're a longtime devotee or just discovering the world of Alma and Tao, you've found your home.</p>
      <p>This community brings together fans from across the globe to discuss, celebrate, and explore the atmospheric underworld of Gokurakugai. Share your theories, connect with fellow fans, and stay updated on all the latest news from the series.</p>
      <div class="qlinks">
        <a href="https://x.com/i/communities/1923913403464286699" target="_blank" class="btn btn-p">Join Community</a>
        <a href="https://www.reddit.com/r/Saragi/" target="_blank" class="btn">Reddit</a>
        <a href="https://mangaplus.shueisha.co.jp/titles/100230" target="_blank" class="btn">Read Manga</a>
      </div>
    </div>
    <div class="fbox synopsis">
      <h3>Series Synopsis</h3>
      <p>In <em>Gokurakugai</em>, an unassuming town district harbors a dark secret — a sanctuary where lost souls and sinister entities find refuge. Enter Tao and Alma: a composed, gun-wielding exterminator and her impulsive, demon-blood companion, who together take on supernatural assignments in the district's treacherous underworld.</p>
      <br>
      <p>Part action, part dark fantasy, Yuto Sano's series blends kinetic fight sequences with rich worldbuilding and deeply compelling characters, set against an aesthetic fusing Chinese aesthetics with gritty noir.</p>
    </div>
  </div>
  <div class="orn">❧ Manga Details ❧</div>
  <div class="igrid">
    <div class="ic"><div class="icl">Title</div><div class="icv">Gokurakugai</div></div>
    <div class="ic"><div class="icl">Japanese</div><div class="icv">極楽街</div></div>
    <div class="ic"><div class="icl">Author</div><div class="icv">Yuto Sano</div></div>
    <div class="ic"><div class="icl">Magazine</div><div class="icv">Jump SQ</div></div>
    <div class="ic"><div class="icl">Publisher</div><div class="icv">Shueisha</div></div>
    <div class="ic"><div class="icl">English</div><div class="icv">VIZ Media</div></div>
    <div class="ic"><div class="icl">Genre</div><div class="icv">Action · Dark Fantasy</div></div>
    <div class="ic"><div class="icl">Status</div><div class="icv">Ongoing ✦</div></div>
  </div>
  <div class="orn">❧ Read Online ❧</div>
  <p style="text-align:center;max-width:540px;margin:0 auto 1.4rem;font-size:.97rem;color:var(--text-dim);">Support the official release. Read Gokurakugai through legitimate platforms.</p>
  <div class="read-grid">
    <a href="https://mangaplus.shueisha.co.jp/titles/100230" target="_blank" class="rc"><div class="rc-ico">📖</div><div><div class="rc-title">Manga Plus</div><div class="rc-sub">Free · Official · English</div></div></a>
    <a href="https://www.viz.com/shonenjump/chapters/gokurakugai" target="_blank" class="rc"><div class="rc-ico">🇺🇸</div><div><div class="rc-title">VIZ Media</div><div class="rc-sub">Official English Release</div></div></a>
    <a href="https://jumpsq.shueisha.co.jp/rensai/gokurakugai/" target="_blank" class="rc"><div class="rc-ico">🇯🇵</div><div><div class="rc-title">Jump SQ</div><div class="rc-sub">Official Japanese</div></div></a>
    <a href="https://jumpsq.shueisha.co.jp/sqrise/2020winter/gokuraku.html" target="_blank" class="rc"><div class="rc-ico">✨</div><div><div class="rc-title">Original Oneshot</div><div class="rc-sub">Winter 2020 · Jump SQ Rise</div></div></a>
  </div>

  <!-- ── Community Stats ── -->
  <div class="orn">❧ Community Stats ❧</div>
  <div class="stats-grid">
    <div class="stat-card">
      <div class="stat-icon">🎮</div>
      <div class="stat-val" id="stat-discord">—</div>
      <div class="stat-label">Discord Members</div>
    </div>
    <div class="stat-card">
      <div class="stat-icon">📖</div>
      <div class="stat-val" id="stat-chapters">—</div>
      <div class="stat-label">Chapters Released</div>
    </div>
    <div class="stat-card">
      <div class="stat-icon">📚</div>
      <div class="stat-val" id="stat-volumes">6</div>
      <div class="stat-label">Volumes Published</div>
    </div>
    <div class="stat-card">
      <div class="stat-icon">⚔️</div>
      <div class="stat-val" id="stat-staff">—</div>
      <div class="stat-label">Staff Members</div>
    </div>
  </div>

  <!-- ── What We Offer ── -->
  <div class="orn">❧ What We Offer ❧</div>
  <div class="offer-grid">
    <div class="offer-card">
      <div class="offer-icon">💬</div>
      <h4>Chapter Discussions</h4>
      <p>Dive into in-depth discussions for every new chapter the moment it drops, with dedicated spoiler-safe channels for every reading pace.</p>
    </div>
    <div class="offer-card">
      <div class="offer-icon">🔮</div>
      <h4>Fan Theories</h4>
      <p>Submit and explore community fan theories on characters, plot, and hidden symbolism — upvote your favorites and spark new conversations.</p>
    </div>
    <div class="offer-card">
      <div class="offer-icon">🎨</div>
      <h4>Fan Art Gallery</h4>
      <p>Browse and share original fan artwork celebrating the world of Gokurakugai, with regular community art contests and showcases.</p>
    </div>
    <div class="offer-card">
      <div class="offer-icon">📰</div>
      <h4>News & Updates</h4>
      <p>Stay up to date with the latest official announcements, volume releases, author news, and community milestones all in one place.</p>
    </div>
    <div class="offer-card">
      <div class="offer-icon">📋</div>
      <h4>Community Rules</h4>
      <p>A welcoming, well-moderated space with clear, fair rules enforced by a dedicated volunteer staff team passionate about Gokurakugai.</p>
    </div>
    <div class="offer-card">
      <div class="offer-icon">🤝</div>
      <h4>Join the Team</h4>
      <p>Passionate about the series? Apply to join our staff team and help shape the community as a moderator or content creator.</p>
    </div>
  </div>
</section>

<!-- ══ MANGA ══ -->
<section id="manga" class="sec">
  <div class="sec-hdr">
    <span class="jp">極楽街</span>
    <span class="en">Manga</span>
  </div>
  <div class="subnav" id="manga-subnav">
    <button class="sn-btn active" data-sub="gallery" data-parent="manga">Gallery</button>
    <button class="sn-btn" data-sub="chars" data-parent="manga">Characters</button>
  </div>
  <div id="gallery" class="subsec active">
    <h2 class="st">Gallery</h2><p class="st-jp">ギャラリー</p>
    <div class="sdiv"><span>✦</span></div>
    <div class="gal-grid">
      <div class="gal-item"><img src="assets/images/staff1.png" alt="Key Art Dark" loading="lazy"><div class="gal-ov"><p>Key Visual — Dark Ver.</p></div></div>
      <div class="gal-item"><img src="assets/images/staff2.png" alt="Key Art Light" loading="lazy"><div class="gal-ov"><p>Key Visual — Light Ver.</p></div></div>
      <div class="gal-item"><img src="assets/images/staff3.png" alt="Alma" loading="lazy" style="object-position:top"><div class="gal-ov"><p>Alma</p></div></div>
      <div class="gal-item"><img src="assets/images/staff4.png" alt="Tao" loading="lazy" style="object-position:top"><div class="gal-ov"><p>Tao</p></div></div>
      <div class="gal-item"><img src="assets/images/staff5.png" alt="Shinju" loading="lazy" style="object-position:top"><div class="gal-ov"><p>Chiba Shinju</p></div></div>
      <div class="gal-item"><img src="assets/images/staff6.png" alt="Author Art" loading="lazy"><div class="gal-ov"><p>Yuto Sano — Author Art</p></div></div>
    </div>
    <p style="text-align:center;margin-top:1.3rem;font-size:.82rem;color:var(--text-muted);font-style:italic;">All artwork © Yuto Sano / Shueisha. Fan use only.</p>
  </div>
  <div id="chars" class="subsec">
    <h2 class="st">Characters</h2><p class="st-jp">登場人物</p>
    <div class="sdiv"><span>✦</span></div>
    <div class="ch-grid">
      <div class="ch"><img src="assets/images/staff1.png" alt="Alma" class="ch-img"><div class="ch-info"><h3>Alma</h3><div class="ct">アルマ — The Ghoul</div><p>A young ghoul with exceptional combat abilities and an insatiable craving for taiyaki. Good-natured and fiercely loyal, Alma serves as Tao's partner in the district.</p><span class="ch-tag">Protagonist</span></div></div>
      <div class="ch"><img src="assets/images/staff2.png" alt="Tao" class="ch-img"><div class="ch-info"><h3>Tao</h3><div class="ct">タオ — The Exterminator</div><p>A composed and enigmatic exterminator armed with a powerful firearm and deep knowledge of the district's supernatural underworld. Serves as Alma's caretaker and partner.</p><span class="ch-tag">Protagonist</span></div></div>
      <div class="ch"><img src="assets/images/staff3.png" alt="Shinju" class="ch-img"><div class="ch-info"><h3>Chiba Shinju</h3><div class="ct">千葉真珠 — The Restaurateur</div><p>Energetic proprietor of the district's beloved dim sum restaurant. A key figure in Gokurakugai's community life, with more ties to the supernatural than she lets on.</p><span class="ch-tag">Supporting</span></div></div>
      <div class="ch"><img src="assets/images/staff4.png" alt="???" class="ch-img"><div class="ch-info"><h3>???</h3><div class="ct">Unknown Affiliation</div><p>A pale-eyed figure whose allegiances remain shrouded in mystery. Their calm demeanor conceals a power that commands both respect and dread within Gokurakugai.</p><span class="ch-tag">Unknown</span></div></div>
      <div class="ch"><img src="assets/images/staff5.png" alt="Elder" class="ch-img"><div class="ch-info"><h3>???</h3><div class="ct">Elder of the District</div><p>A world-weary figure who has seen Gokurakugai in its earliest, darkest days. Slow to speak, impossible to ignore.</p><span class="ch-tag">Side Character</span></div></div>
      <div class="ch"><img src="assets/images/staff6.png" alt="Shadow" class="ch-img"><div class="ch-info"><h3>???</h3><div class="ct">Shadow of the District</div><p>A dark, gothic presence who moves through Gokurakugai with quiet menace. The eyepatch conceals a power that few have lived to describe.</p><span class="ch-tag">Antagonist</span></div></div>
    </div>
    <div style="margin-top:1.8rem;padding:.9rem 1.2rem;background:var(--surface);border-left:3px solid var(--accent);font-size:.85rem;color:var(--text-muted);font-style:italic;">✦ Community interpretations only. Official lore belongs to Yuto Sano / Shueisha.</div>
  </div><!-- end chars subsec -->
</section>

<!-- ══ NEWS ══ -->
<section id="news" class="sec">
  <div class="subnav" id="news-subnav">
    <button class="sn-btn active" data-sub="nfeed" data-parent="news">News</button>
    <button class="sn-btn" data-sub="articles" data-parent="news">Articles</button>
    <button class="sn-btn" data-sub="discussion" data-parent="news">Discussion</button>
  </div>

  <!-- ── News Feed ── -->
  <div id="nfeed" class="subsec active">
    <div class="news-page-header">
      <div class="news-jp">ニュース</div>
      <div class="news-en">News &amp; Discussions</div>
      <p class="news-desc">Stay updated with the latest chapter discussions, community announcements, and fan theories from the Gokurakugai community.</p>
    </div>

    <!-- Filter row -->
    <div class="news-filters">
      <button class="nf-btn active" onclick="filterNews(this,'all')">All</button>
      <button class="nf-btn" onclick="filterNews(this,'chapter')">Chapter</button>
      <button class="nf-btn" onclick="filterNews(this,'announcement')">Announcement</button>
      <button class="nf-btn" onclick="filterNews(this,'community')">Community</button>
      <button class="nf-btn" onclick="filterNews(this,'official')">Official</button>
    </div>

    <!-- Empty state — shown when no articles exist -->
    <div class="news-empty" id="news-empty" style="display:none;">
      <div class="news-empty-ico">📰</div>
      <h3>No Posts Yet</h3>
      <p>Community news and announcements will appear here. Check back soon!</p>
    </div>

    <!-- Live news grid — populated by JS; no placeholders -->
    <div class="news-grid-3" id="news-grid"></div>

    <!-- Never miss updates -->
    <div class="never-miss">
      <div class="nm-icon">🔔</div>
      <h3>Never Miss an Update</h3>
      <p>Join our Discord server for real-time chapter drops, event announcements, and community discussions.</p>
      <a href="https://x.com/i/communities/1923913403464286699" target="_blank" class="btn btn-p" style="margin:0 auto;">🎮 Join Discord</a>
    </div>
  </div>

  <!-- ── Articles ── -->
  <div id="articles" class="subsec">
    <div class="news-page-header">
      <div class="news-jp">記事</div>
      <div class="news-en">Featured Articles</div>
      <p class="news-desc">In-depth analyses, character studies, and lore explorations written by our community.</p>
    </div>
    <!-- Empty state -->
    <div class="news-empty" id="articles-empty" style="display:none;">
      <div class="news-empty-ico">✍️</div>
      <h3>No Articles Yet</h3>
      <p>Community articles and analyses will appear here.</p>
    </div>
    <!-- Articles grid — populated by JS -->
    <div class="news-grid-3" id="articles-grid"></div>
  </div>

  <!-- ── Discussion ── -->
  <div id="discussion" class="subsec">
    <div class="news-page-header">
      <div class="news-jp">掲示板</div>
      <div class="news-en">Community Discussion</div>
    </div>

    <!-- Not-a-member gate -->
    <div id="disc-gate" class="gate" style="display:none;">
      <div class="gate-ico">💬</div>
      <h3>Join the Discord server to comment</h3>
      <p>You must be a verified member of our Discord server to participate in discussions.</p>
      <div style="display:flex;gap:.65rem;justify-content:center;flex-wrap:wrap;">
        <button class="btn btn-dc" onclick="dcLogin()">Login with Discord</button>
        <a href="https://x.com/i/communities/1923913403464286699" target="_blank" class="btn">Join Server</a>
      </div>
    </div>

    <!-- Post form (members only) -->
    <div id="disc-post-form" style="display:none;">
      <div class="disc-form-wrap">
        <div class="disc-av-row">
          <div class="disc-form-av" id="disc-form-av"></div>
          <div style="flex:1;">
            <select id="disc-topic" class="disc-select">
              <option value="General">General Discussion</option>
              <option value="Theory">Theory Discussion</option>
              <option value="Chapter">Chapter Talk</option>
              <option value="Fan Art">Fan Art</option>
              <option value="Questions">Questions</option>
            </select>
          </div>
        </div>
        <textarea id="disc-text" class="disc-textarea" placeholder="Share your thoughts with the community..."></textarea>
        <div style="display:flex;justify-content:flex-end;">
          <button class="btn btn-p" onclick="submitDiscussion()">Post</button>
        </div>
      </div>
    </div>
    <div id="disc-posts" class="disc-list"></div>
  </div>
</section>

<!-- ══ THEORIES ══ -->
<section id="theories" class="sec">
  <div class="th-page-header">
    <h2>🔮 Fan Theory Submission</h2>
    <p>Share your theories about Gokurakugai with the community. Character backstories, plot predictions, hidden symbolism — we want to hear your ideas.</p>
  </div>

  <!-- Discord widget -->
  <div class="dc-wgt-v2">
    <div class="dc-wgt-v2-left">
      <div class="dc-wgt-v2-title">Gokurakugai Discord Server Online</div>
      <div class="dc-wgt-v2-count">
        <span class="od"></span>
        <span id="dc-online-ct">Loading...</span>
      </div>
    </div>
    <a href="https://x.com/i/communities/1923913403464286699" target="_blank" class="btn btn-dc" style="flex-shrink:0;">Join Server</a>
  </div>

  <!-- Submission guidelines -->
  <div class="th-guidelines">
    <h3>📋 Submission Guidelines</h3>
    <ul class="th-gl-list">
      <li>Theories must be original and your own work</li>
      <li>Include evidence from the manga to support your theory</li>
      <li>Mark spoilers appropriately if discussing recent chapters</li>
      <li>Be respectful — no bashing other theories or community members</li>
      <li>Approved theories will be featured in our community discussions</li>
    </ul>
  </div>

  <!-- Login/Join gate (shown when NOT logged in or NOT a member) -->
  <div id="theory-gate" class="gate" style="display:none;">
    <div class="gate-ico">🔒</div>
    <h3>Server Members Only</h3>
    <p>Submitting theories is exclusive to members of our Discord server. Join and log in to share your theories!</p>
    <div style="display:flex;gap:.65rem;justify-content:center;flex-wrap:wrap;">
      <button class="btn btn-dc" onclick="dcLogin()">Login with Discord</button>
      <a href="https://x.com/i/communities/1923913403464286699" target="_blank" class="btn">Join Server</a>
    </div>
  </div>

  <!-- Submit form (auto-filled when logged in) -->
  <div id="theory-submit-form" style="display:none;">
    <div class="th-submit-wrap">
      <div class="th-form-title">Submit Your Theory</div>

      <!-- Auto-filled identity fields (read-only) -->
      <div class="th-autofill-notice">
        <span>✦</span> Your identity is auto-filled from your Discord account
      </div>
      <div class="th-form-grid">
        <div class="th-form-group">
          <label>Username</label>
          <input type="text" id="th-username" class="th-readonly" readonly placeholder="Auto-filled from Discord">
        </div>
        <div class="th-form-group">
          <label>Display Name</label>
          <input type="text" id="th-displayname" class="th-readonly" readonly placeholder="Auto-filled from Discord">
        </div>
      </div>
      <div class="th-form-group">
        <label>User ID</label>
        <input type="text" id="th-userid" class="th-readonly" readonly placeholder="Auto-filled from Discord" style="font-family:monospace;font-size:.88rem;">
      </div>

      <div class="th-hr"></div>
      <div style="font-family:'Cinzel',serif;font-size:.82rem;color:var(--accent);letter-spacing:.1em;margin-bottom:1.1rem;">Theory Details</div>

      <div class="th-form-group">
        <label>Theory Title <span style="color:var(--accent)">*</span></label>
        <input type="text" id="th-title" placeholder="Give your theory a catchy title">
      </div>
      <div class="th-form-grid">
        <div class="th-form-group">
          <label>Category <span style="color:var(--accent)">*</span></label>
          <select id="th-tag">
            <option value="">Select a category</option>
            <option>Character Origins</option>
            <option>Plot Predictions</option>
            <option>Power System Analysis</option>
            <option>World Building</option>
            <option>Character Relationships</option>
            <option>Hidden Symbolism</option>
            <option>Villain Theories</option>
            <option>Ending Predictions</option>
            <option>Other</option>
          </select>
        </div>
        <div class="th-form-group">
          <label>Related Chapters</label>
          <input type="text" id="th-chapters" placeholder="e.g., Ch. 1–5, Ch. 42">
        </div>
      </div>
      <div class="th-form-group">
        <label>Your Theory <span style="color:var(--accent)">*</span></label>
        <textarea id="th-body" placeholder="Explain your theory in detail..." oninput="updateCount('th-body','th-body-count',500)"></textarea>
        <div class="th-char-count"><span id="th-body-count">0</span>/500 characters</div>
      </div>
      <div class="th-form-group">
        <label>Supporting Evidence</label>
        <textarea id="th-evidence" placeholder="List manga panels, dialogue, or other evidence..." oninput="updateCount('th-evidence','th-ev-count',500)"></textarea>
        <div class="th-char-count"><span id="th-ev-count">0</span>/500 characters</div>
      </div>

      <div class="th-hr"></div>
      <div class="th-check-row">
        <input type="checkbox" id="th-spoilers">
        <label for="th-spoilers"><span><strong>Contains Spoilers</strong> — Check if discussing recent chapters</span></label>
      </div>
      <div class="th-check-row">
        <input type="checkbox" id="th-agree">
        <label for="th-agree"><span><strong>I agree to the community guidelines</strong> <span style="color:var(--accent)">*</span></span></label>
      </div>

      <button class="th-submit-btn" onclick="submitTheory()">
        <span>➤</span> Submit Theory
      </button>
    </div>
  </div>

  <!-- Popular theories grid — no placeholders, only real submitted theories -->
  <div class="th-popular-title">🔥 Community Theories</div>
  <div id="theories-empty" style="text-align:center;padding:2.5rem;background:var(--surface);border:1px dashed var(--hr);margin-bottom:1.5rem;">
    <div style="font-size:2rem;margin-bottom:.6rem;">🔮</div>
    <p style="font-family:'Cinzel',serif;font-size:.82rem;color:var(--text-muted);letter-spacing:.1em;">No theories yet — be the first to submit one!</p>
  </div>
  <div class="th-grid" id="theories-list"></div>
</section>

<!-- ══ RULES ══ -->
<section id="rules" class="sec">
  <div class="rules-page-hdr">
    <h2>Community Rules</h2>
    <p>To maintain a welcoming and positive environment for all <strong style="color:var(--accent)">Gokurakugai</strong> fans, please follow these community guidelines. These are the extended rules that govern all our spaces — Discord, Reddit, social media, and this website.</p>
  </div>

  <div class="rules-card-grid">
    <div class="rule-card">
      <div class="rule-card-icon">🛡️</div>
      <div class="rule-card-body">
        <h4>1. Be Respectful</h4>
        <p>Treat all community members with respect and kindness. Harassment, hate speech, discrimination, or personal attacks of any kind will not be tolerated. We are all here because we love Gokurakugai — and that shared love should bring us together, not divide us. This applies across all platforms and channels, whether you're a new member or a founding one. No rank exempts anyone from basic decency.</p>
      </div>
    </div>
    <div class="rule-card">
      <div class="rule-card-icon">💬</div>
      <div class="rule-card-body">
        <h4>2. Stay On Topic</h4>
        <p>Keep discussions relevant to Gokurakugai and related topics. While off-topic conversations are fine in designated channels, please maintain focus in manga discussion areas. Flooding serious discussion channels with unrelated content makes it harder for members to find what they're looking for and disrupts the community's organization.</p>
      </div>
    </div>
    <div class="rule-card">
      <div class="rule-card-icon">⚠️</div>
      <div class="rule-card-body">
        <h4>3. No Spoilers Without Warning</h4>
        <p>Always use spoiler tags when discussing recent chapters or plot developments. Not everyone reads at the same pace, and not everyone has access to chapters at the same time globally. Use Discord's ||spoiler tags||, Reddit flair, and clear labels on this site. Members who deliberately spoil content will be treated as violating Rule 1 — ruining someone's experience is a form of disrespect.</p>
      </div>
    </div>
    <div class="rule-card">
      <div class="rule-card-icon">🚫</div>
      <div class="rule-card-body">
        <h4>4. No Spam or Self-Promotion</h4>
        <p>Avoid excessive posting, spam, or unsolicited self-promotion. Sharing your Gokurakugai fan content is encouraged in the right channels, but repeatedly dropping links, flooding chat with short messages, or advertising unrelated projects without staff approval is prohibited. If you'd like to collaborate or promote something, reach out to an admin directly.</p>
      </div>
    </div>
    <div class="rule-card">
      <div class="rule-card-icon">📖</div>
      <div class="rule-card-body">
        <h4>5. Support the Official Release</h4>
        <p>Do not share or request pirated scans, unauthorized translations, or illegal aggregator links. Gokurakugai is an ongoing series whose publication depends on reader engagement with official platforms. Read on Manga Plus (free) or VIZ Media, purchase volumes when you're able, and always direct members asking "where to read" toward official sources. Sano's work deserves to be supported.</p>
      </div>
    </div>
    <div class="rule-card">
      <div class="rule-card-icon">🎨</div>
      <div class="rule-card-body">
        <h4>6. Credit Artists &amp; Creators</h4>
        <p>Always credit the original artist when sharing fan art — name, link to source, and explicit permission where required. Many artists have requested their work not be reshared without permission; those wishes must be respected. Do not use artwork as avatars or banners without permission. When sharing manga content, keep it to brief excerpts only and always link to official platforms.</p>
      </div>
    </div>
    <div class="rule-card">
      <div class="rule-card-icon">🌐</div>
      <div class="rule-card-body">
        <h4>7. Keep Content Age-Appropriate</h4>
        <p>All content shared in community spaces must be appropriate for a general audience including members as young as thirteen. Explicit sexual content involving characters is strictly prohibited regardless of perceived character age. Extremely graphic violence beyond the manga's own content, shock content with no artistic merit, and content designed purely to disturb are not welcome. Mature thematic discussions are fine — graphic depictions are not.</p>
      </div>
    </div>
    <div class="rule-card">
      <div class="rule-card-icon">🏛️</div>
      <div class="rule-card-body">
        <h4>8. Respect Staff Decisions</h4>
        <p>Our administrators and moderators volunteer their time to maintain this space. If staff issue a warning, remove a message, or take moderation action, respect that decision — do not argue publicly, circumvent it, or retaliate. If you genuinely believe a decision was wrong, contact staff privately with a calm, constructive message. Public campaigns against staff authority are treated as a serious violation.</p>
      </div>
    </div>
    <div class="rule-card">
      <div class="rule-card-icon">🔇</div>
      <div class="rule-card-body">
        <h4>9. No Divisive Real-World Topics</h4>
        <p>Discussions of real-world politics, political figures, religious doctrine, or other divisive non-manga topics are not appropriate in any community channel. This community exists to be a shared space for all fans regardless of political or ideological background. If the manga explores themes with social resonance — which it does — those may be discussed as literary analysis, not as a vehicle for real-world argument.</p>
      </div>
    </div>
    <div class="rule-card">
      <div class="rule-card-icon">📋</div>
      <div class="rule-card-body">
        <h4>10. Platform Terms of Service</h4>
        <p>All members must abide by the Terms of Service of whatever platform they are using — Discord, Reddit, Instagram, Twitter/X, etc. This includes age requirements, prohibited content, and acceptable use policies. ToS violations may result in your account being reported to the platform in addition to community consequences. The community does not end at the server border; we represent it everywhere we interact publicly in connection with it.</p>
      </div>
    </div>
  </div>

  <!-- Consequences -->
  <div class="consequences-box">
    <div class="consequences-title">Consequences for Rule Violations</div>
    <div class="consequences-grid">
      <div class="cq-item">
        <div class="cq-icon">⚠️</div>
        <div class="cq-title">First Offense</div>
        <div class="cq-body"><strong>Warning:</strong> You will receive a verbal or written warning from moderators explaining the rule violation.</div>
      </div>
      <div class="cq-item">
        <div class="cq-icon">⏱️</div>
        <div class="cq-title">Second Offense</div>
        <div class="cq-body"><strong>Temporary Mute/Ban:</strong> Depending on severity, you may be temporarily muted or banned from the community.</div>
      </div>
      <div class="cq-item">
        <div class="cq-icon">🚫</div>
        <div class="cq-title">Severe/Repeated</div>
        <div class="cq-body"><strong>Permanent Ban:</strong> Severe violations or repeated offenses will result in permanent removal from the community.</div>
      </div>
    </div>
  </div>

  <!-- Full strike system -->
  <div class="strikes-wrap">
    <div class="strikes-title">Detailed Strike System</div>
    <p style="text-align:center;max-width:640px;margin:0 auto 1.4rem;font-size:.95rem;color:var(--text-dim);line-height:1.75;">Strikes are cumulative. Severe violations — including hate speech, doxxing, or targeted harassment — may bypass earlier strikes and result in immediate permanent action.</p>
    <div class="strikes-list">
      <div class="sk"><span class="sk-num s1">Strike 1</span><div class="sk-body"><h4>Mute — 1 to 2 Hours</h4><p>A short mute intended as a pause. Staff will send a direct message explaining the specific rule violated. No further action unless rules are broken again.</p></div></div>
      <div class="sk"><span class="sk-num s2">Strike 2</span><div class="sk-body"><h4>Mute — 6 Hours</h4><p>A formal written warning will accompany this mute, outlining the pattern of behavior and future consequences. The member is expected to acknowledge this warning.</p></div></div>
      <div class="sk"><span class="sk-num s3">Strike 3</span><div class="sk-body"><h4>Mute — 12 Hours</h4><p>The member's behavior is now actively monitored by all staff. Members are strongly urged to reach out to a moderator before the mute expires to discuss next steps constructively.</p></div></div>
      <div class="sk"><span class="sk-num s4">Strike 4</span><div class="sk-body"><h4>Mute or Temporary Ban — 48 Hours</h4><p>Either a 48-hour mute or ban at staff discretion. A full internal review of the member's history is conducted and formal documentation of all prior strikes is issued.</p></div></div>
      <div class="sk s5"><span class="sk-num s5">Strike 5</span><div class="sk-body"><h4>Temporary Ban — 1 Week</h4><p>A one-week ban across all community spaces. During the ban, an administrator will contact the member to evaluate whether continued membership is appropriate.</p></div></div>
      <div class="sk s6"><span class="sk-num s6">Strike 6</span><div class="sk-body"><h4>Permanent Ban — No Appeal</h4><p>A permanent ban from all community spaces with no possibility of appeal. Requires full moderation team consensus. All such bans are documented internally.</p></div></div>
    </div>
  </div>

  <!-- Notice -->
  <div style="padding:1.1rem 1.5rem;background:var(--surface);border:1px solid var(--accent);text-align:center;margin-bottom:1.5rem;">
    <p style="font-family:'Cinzel',serif;font-size:.68rem;letter-spacing:.14em;color:var(--accent);margin-bottom:.45rem;">IMPORTANT NOTICE</p>
    <p style="font-size:.95rem;line-height:1.75;color:var(--text-dim);">If a rule is broken in any channel that isn't being actively moderated, <strong style="color:var(--accent)">please notify any Admin or Moderator immediately</strong>. Do not handle the situation yourself. We will investigate and respond as quickly as possible.</p>
  </div>

  <!-- Questions box -->
  <div class="questions-box">
    <div class="qb-icon">✉️</div>
    <div class="qb-title">Questions or Concerns?</div>
    <div class="qb-body">If you have questions about these rules or need to report a violation, please contact our moderation team. We are here to help maintain a positive community for all <strong style="color:var(--accent)">Gokurakugai</strong> fans.</div>
    <a href="https://x.com/i/communities/1923913403464286699" target="_blank" class="btn btn-p" style="position:relative;">🎧 Contact Moderators</a>
  </div>
</section>

<!-- ══ INFO ══ -->
<section id="info" class="sec">
  <div class="sec-hdr">
    <span class="jp">コミュニティ情報</span>
    <span class="en">Community Info</span>
  </div>
  <div class="sdiv"><span>✦</span></div>
  <div class="orn">❧ About the Author ❧</div>
  <div class="au-card" style="margin-bottom:2.5rem;">
    <img src="assets/images/yuto-sano.jpg" alt="Yuto Sano" class="au-img" id="au-img">
    <div class="au-info">
      <h3>Yuto Sano</h3>
      <div class="au-jp">佐野勇斗</div>
      <p>Yuto Sano is a manga artist known for his dynamic action sequences, intricate worldbuilding, and distinctive character designs blending East Asian aesthetics with dark fantasy. <em>Gokurakugai</em> began as a oneshot in Jump SQ Rise (Winter 2020) before launching as a serialization in Jump Square.</p>
      <div style="display:flex;gap:.65rem;flex-wrap:wrap;">
        <a href="https://www.instagram.com/yuto__sano" target="_blank" class="btn btn-sm">Instagram</a>
        <a href="https://x.com/Yuto___Sano" target="_blank" class="btn btn-sm">Twitter / X</a>
      </div>
    </div>
  </div>
  <div class="orn">❧ Community Platforms ❧</div>
  <div class="ls-sec">
    <h3>Official Community</h3>
    <div class="sl-grid">
      <a href="https://x.com/gokurakugainews" target="_blank" class="sl"><span class="sl-ico">𝕏</span><div><div class="sl-name">Twitter / X</div><div class="sl-sub">@gokurakugainews</div></div></a>
      <a href="https://x.com/i/communities/1923913403464286699" target="_blank" class="sl"><span class="sl-ico">👥</span><div><div class="sl-name">X Community</div><div class="sl-sub">Join our Community</div></div></a>
      <a href="https://www.facebook.com/gokurakugai" target="_blank" class="sl"><span class="sl-ico">📘</span><div><div class="sl-name">Facebook Page</div><div class="sl-sub">/gokurakugai</div></div></a>
      <a href="https://www.facebook.com/groups/gokurakugai" target="_blank" class="sl"><span class="sl-ico">👥</span><div><div class="sl-name">Facebook Group</div><div class="sl-sub">/groups/gokurakugai</div></div></a>
      <a href="https://www.instagram.com/gokurakugaiwiki" target="_blank" class="sl"><span class="sl-ico">📸</span><div><div class="sl-name">Instagram</div><div class="sl-sub">@gokurakugaiwiki</div></div></a>
      <a href="https://bsky.app/profile/gokurakugai.bsky.social" target="_blank" class="sl"><span class="sl-ico">🦋</span><div><div class="sl-name">Bluesky</div><div class="sl-sub">@gokurakugai.bsky.social</div></div></a>
      <a href="https://www.threads.com/@gokurakugaiwiki" target="_blank" class="sl"><span class="sl-ico">🔗</span><div><div class="sl-name">Threads</div><div class="sl-sub">@gokurakugaiwiki</div></div></a>
      <a href="https://www.tiktok.com/@gokurakugai" target="_blank" class="sl"><span class="sl-ico">🎵</span><div><div class="sl-name">TikTok</div><div class="sl-sub">@gokurakugai</div></div></a>
      <a href="https://www.reddit.com/r/Saragi/" target="_blank" class="sl"><span class="sl-ico">🤖</span><div><div class="sl-name">Reddit</div><div class="sl-sub">r/Saragi</div></div></a>
    </div>
  </div>
  <div class="orn">❧ Official Manga ❧</div>
  <div class="ls-sec">
    <h3>Read Official</h3>
    <div class="sl-grid">
      <a href="https://jumpsq.shueisha.co.jp/sqrise/2020winter/gokuraku.html" target="_blank" class="sl"><span class="sl-ico">✨</span><div><div class="sl-name">Original Oneshot</div><div class="sl-sub">Jump SQ Rise, 2020</div></div></a>
      <a href="https://jumpsq.shueisha.co.jp/rensai/gokurakugai/" target="_blank" class="sl"><span class="sl-ico">📰</span><div><div class="sl-name">Jump Square</div><div class="sl-sub">Official JP Serialization</div></div></a>
      <a href="https://www.viz.com/shonenjump/chapters/gokurakugai" target="_blank" class="sl"><span class="sl-ico">🇺🇸</span><div><div class="sl-name">VIZ Media</div><div class="sl-sub">Official English</div></div></a>
      <a href="https://mangaplus.shueisha.co.jp/titles/100230" target="_blank" class="sl"><span class="sl-ico">📖</span><div><div class="sl-name">Manga Plus</div><div class="sl-sub">Free · Official · English</div></div></a>
    </div>
  </div>
</section>

<!-- ══ STAFF ══ -->
<section id="staff" class="sec">
  <div class="sec-hdr">
    <span class="jp">スタッフ紹介</span>
    <span class="en">Our Staff</span>
    <span class="sub">Meet the dedicated volunteers behind the Gokurakugai Fan Community. Click any card to view their full profile.</span>
  </div>
  <div class="sdiv"><span>✦</span></div>
  <div class="orn">❧ Administration ❧</div>
  <div class="staff-grid">
    <div class="sc" onclick="openModal('m1')">
      <img src="assets/images/staff1.png" alt="Ichirou" id="s1-img">
      <div class="sc-body"><div class="sc-role">Founder · Administrator</div><div class="sc-name">Ichirou</div><div class="sc-handle">@ichirou_gkg</div></div>
      <button class="sc-view">View Profile</button>
    </div>
    <div class="sc" onclick="openModal('m2')">
      <img src="assets/images/staff2.png" alt="Shirogane" id="s2-img">
      <div class="sc-body"><div class="sc-role">Co-Founder · Administrator</div><div class="sc-name">Shirogane</div><div class="sc-handle">@shirogane_gkg</div></div>
      <button class="sc-view">View Profile</button>
    </div>
    <div class="sc" onclick="openModal('m3')">
      <img src="assets/images/staff3.png" alt="Kanzaki" id="s8-img">
      <div class="sc-body"><div class="sc-role">Administrator</div><div class="sc-name">Kanzaki</div><div class="sc-handle">@kanzaki_gkg</div></div>
      <button class="sc-view">View Profile</button>
    </div>
  </div>
  <div class="orn">❧ Moderation Team ❧</div>
  <div class="staff-grid">
    <div class="sc" onclick="openModal('m4')">
      <img src="assets/images/staff4.png" alt="Shiro" id="s3-img">
      <div class="sc-body"><div class="sc-role">Senior Moderator</div><div class="sc-name">Shiro</div><div class="sc-handle">@shiro_gkg</div></div>
      <button class="sc-view">View Profile</button>
    </div>
    <div class="sc" onclick="openModal('m5')">
      <img src="assets/images/staff5.png" alt="Nagi" id="s4-img">
      <div class="sc-body"><div class="sc-role">Moderator</div><div class="sc-name">Nagi</div><div class="sc-handle">@nagi_gkg</div></div>
      <button class="sc-view">View Profile</button>
    </div>
    <div class="sc" onclick="openModal('m6')">
      <img src="assets/images/staff6.png" alt="Shinju" id="s5-img">
      <div class="sc-body"><div class="sc-role">Moderator</div><div class="sc-name">Shinju</div><div class="sc-handle">@shinju_gkg</div></div>
      <button class="sc-view">View Profile</button>
    </div>
    <div class="sc" onclick="openModal('m7')">
      <img src="assets/images/staff7.png" alt="Kurona" id="s6-img">
      <div class="sc-body"><div class="sc-role">Moderator</div><div class="sc-name">Kurona</div><div class="sc-handle">@kurona_gkg</div></div>
      <button class="sc-view">View Profile</button>
    </div>
    <div class="sc" onclick="openModal('m8')">
      <img src="assets/images/staff8.png" alt="Momo" id="s7-img">
      <div class="sc-body"><div class="sc-role">Content Creator</div><div class="sc-name">Momo</div><div class="sc-handle">@momo_gkg</div></div>
      <button class="sc-view">View Profile</button>
    </div>
    <div class="sc" onclick="openModal('m9')">
      <img src="assets/images/staff9.png" alt="Yomi" id="s9-img">
      <div class="sc-body"><div class="sc-role">Content Creator</div><div class="sc-name">Yomi</div><div class="sc-handle">@yomi_gkg</div></div>
      <button class="sc-view">View Profile</button>
    </div>
  </div>

  <!-- ── Join the Staff Team (integrated) ── -->
  <div class="sdiv" style="margin-top:2.5rem;"><span>✦</span></div>
  <div class="sec-hdr" style="padding-top:1rem;">
    <span class="jp">スタッフ募集</span>
    <span class="en">Join the Staff Team</span>
    <span class="sub">We're always looking for passionate fans to help manage and grow the Gokurakugai community. <strong style="color:var(--accent)">You must be a Discord server member to apply.</strong></span>
  </div>
  <div class="apply-wrap">
    <div id="apply-gate" class="gate" style="display:none">
      <div class="gate-ico">🔒</div>
      <h3>Discord Login Required</h3>
      <p>To submit a staff application, you must be logged in with Discord and be a member of our server.</p>
      <div style="display:flex;gap:.65rem;justify-content:center;flex-wrap:wrap;">
        <button class="btn btn-dc" onclick="dcLogin()">Login with Discord</button>
        <a href="https://x.com/i/communities/1923913403464286699" target="_blank" class="btn">Join Server First</a>
      </div>
    </div>
    <form id="apply-form" class="af" onsubmit="submitApplication(event)">
      <div class="fbox" style="margin-bottom:1.8rem;padding:1.2rem 1.5rem;">
        <p style="font-size:.9rem;color:var(--text-dim);line-height:1.72;">Your application will be submitted to our private staff channel on Discord. Please answer all questions thoroughly — we value depth over brevity. Review time is typically 1–2 weeks.</p>
      </div>
      <div class="fg">
        <div class="fr"><label>Discord Username *</label><input type="text" id="af-disc" placeholder="e.g. username#0000" required></div>
        <div class="fr"><label>Age *</label><input type="number" id="af-age" placeholder="Must be 15+" min="15" required></div>
      </div>
      <div class="fg">
        <div class="fr"><label>Timezone *</label><input type="text" id="af-tz" placeholder="e.g. UTC+8 / JST" required></div>
        <div class="fr"><label>Position Applying For *</label>
          <select id="af-pos" required>
            <option value="">— Select a role —</option>
            <option>Moderator</option>
            <option>Senior Moderator</option>
            <option>Content Creator</option>
            <option>Social Media Manager</option>
            <option>Event Coordinator</option>
            <option>Translator</option>
          </select>
        </div>
      </div>
      <div class="fr"><label>How long have you been a member of this community? *</label>
        <select id="af-tenure" required>
          <option value="">— Select —</option>
          <option>Less than 1 month</option>
          <option>1–3 months</option>
          <option>3–6 months</option>
          <option>6–12 months</option>
          <option>Over 1 year</option>
        </select>
      </div>
      <div class="fr"><label>Hours per week available for staff duties? *</label>
        <select id="af-hours" required>
          <option value="">— Select —</option>
          <option>1–3 hours</option>
          <option>4–7 hours</option>
          <option>8–14 hours</option>
          <option>15+ hours</option>
        </select>
      </div>
      <div class="fr"><label>Prior moderation or community experience? *</label>
        <textarea id="af-exp" placeholder="Describe any previous experience. If none, say so — it won't disqualify you." required></textarea>
      </div>
      <div class="fr"><label>Why do you want to join the staff team? *</label>
        <textarea id="af-why" placeholder="Tell us why you're passionate about this community..." required></textarea>
      </div>
      <div class="fr"><label>How would you handle two members arguing aggressively in a public channel? *</label>
        <textarea id="af-scenario" placeholder="Walk us through your step-by-step approach..." required></textarea>
      </div>
      <div class="fr"><label>Anything else you'd like us to know?</label>
        <textarea id="af-extra" placeholder="Optional — additional information or context..."></textarea>
      </div>
      <div style="display:flex;gap:.8rem;flex-wrap:wrap;align-items:center;">
        <button type="submit" class="btn btn-p">Submit Application</button>
        <span style="font-size:.82rem;color:var(--text-muted);font-style:italic;">Sent directly to our Discord staff channel.</span>
      </div>
    </form>
    <div class="apply-ok" id="apply-ok">
      <div class="ao-ico">✦</div>
      <h3>Application Submitted!</h3>
      <p>Thank you for applying to join the Gokurakugai staff team. We review all applications carefully and will reach out to you via Discord within 1–2 weeks.</p>
    </div>
  </div>
</section>



</main>

<!-- ════ STAFF MODALS ════ -->
<div class="m-ov" id="modal-overlay" onclick="closeModalOutside(event)">
  <div class="modal" id="modal-box">
    <button class="m-close" onclick="closeModal()">✕</button>
    <div class="m-hdr">
      <img src="" alt="" class="m-hdr-img" id="m-img">
      <div class="m-hdr-info">
        <div class="m-role" id="m-role">Role</div>
        <div class="m-name" id="m-name">Name</div>
        <div class="m-handle" id="m-handle">@handle</div>
        <span class="m-badge" id="m-badge">Staff</span>
      </div>
    </div>
    <div class="m-body">
      <div class="m-sec"><h4>About</h4><p id="m-about"></p></div>
      <div class="m-sec"><h4>Responsibilities</h4><p id="m-resp"></p></div>
      <div class="m-sec"><h4>Favorite Aspect of Gokurakugai</h4><p id="m-fav"></p></div>
      <div class="m-sec"><h4>Specialties</h4><div class="m-tags" id="m-tags"></div></div>
    </div>
  </div>
</div>

<!-- ════ TOAST ════ -->
<div id="toast"></div>

<!-- ════ FOOTER ════ -->
<footer id="ft">
  <div class="ft-grid">
    <!-- Col 1: Brand -->
    <div class="ft-col">
      <div class="ft-col-brand">GOKURAKUGAI</div>
      <p class="ft-col-desc">A fan community dedicated to Gokurakugai by Yuto Sano. This is an unofficial fan site. All rights to the manga belong to the author and publishers.</p>
    </div>
    <!-- Col 2: Community Links -->
    <div class="ft-col">
      <div class="ft-col-title">Community Links</div>
      <ul>
        <li><a href="https://x.com/gokurakugainews" target="_blank">Twitter</a></li>
        <li><a href="https://x.com/i/communities/1923913403464286699" target="_blank">Twitter Community</a></li>
        <li><a href="https://www.facebook.com/gokurakugai" target="_blank">Facebook</a></li>
        <li><a href="https://www.facebook.com/groups/gokurakugai" target="_blank">Facebook Group</a></li>
        <li><a href="https://www.instagram.com/gokurakugaiwiki" target="_blank">Instagram</a></li>
        <li><a href="https://bsky.app/profile/gokurakugai.bsky.social" target="_blank">Bluesky</a></li>
        <li><a href="https://www.threads.com/@gokurakugaiwiki" target="_blank">Threads</a></li>
        <li><a href="https://www.tiktok.com/@gokurakugai" target="_blank">TikTok</a></li>
        <li><a href="https://www.reddit.com/r/Saragi/" target="_blank">Reddit</a></li>
      </ul>
    </div>
    <!-- Col 3: Official Manga -->
    <div class="ft-col">
      <div class="ft-col-title">Official Manga</div>
      <ul>
        <li><a href="https://jumpsq.shueisha.co.jp/sqrise/2020winter/gokuraku.html" target="_blank">Oneshot (SQ Rise)</a></li>
        <li><a href="https://jumpsq.shueisha.co.jp/rensai/gokurakugai/" target="_blank">Serialization (Jump SQ)</a></li>
        <li><a href="https://www.viz.com/shonenjump/chapters/gokurakugai" target="_blank">VIZ Media</a></li>
        <li><a href="https://mangaplus.shueisha.co.jp/titles/100230" target="_blank">MANGA Plus</a></li>
      </ul>
    </div>
    <!-- Col 4: Author + Discord -->
    <div class="ft-col">
      <div class="ft-col-title">Author – Yuto Sano</div>
      <ul style="margin-bottom:1.4rem;">
        <li><a href="https://www.instagram.com/yuto__sano" target="_blank">Instagram</a></li>
        <li><a href="https://x.com/Yuto___Sano" target="_blank">Twitter/X</a></li>
      </ul>
      <div class="ft-disc-label">Discord Server</div>
      <a href="https://x.com/i/communities/1923913403464286699" target="_blank" class="ft-disc-btn">
        <span>🎮</span> Join Server
      </a>
    </div>
  </div>
  <div class="ft-divider"></div>
  <div class="ft-bottom">
    <p class="ft-copy">© 2026 Gokurakugai Fan Community. This is a fan-made site. Gokurakugai © Yuto Sano / Shueisha.</p>
    <p class="ft-rights">All rights reserved to their respective owners.</p>
  </div>
</footer>

<script>
/* ════════════════════════════════════════
   CONFIG — edit these values
════════════════════════════════════════ */
const CFG = {
  // Discord OAuth2: create app at https://discord.com/developers/applications
  // Set redirect URI to this page's URL, enable "identify" and "guilds" scopes
  DISCORD_CLIENT_ID: 'YOUR_CLIENT_ID_HERE',
  // Discord server (guild) ID
  GUILD_ID: '995737046725443686',
  // Discord Widget API
  WIDGET_API: 'https://discord.com/api/guilds/995737046725443686/widget.json',
  // Webhook URL for staff applications — create in Discord channel settings > Integrations
  WEBHOOK_URL: 'YOUR_WEBHOOK_URL_HERE',
  // Countdown target: next Jump SQ release (update monthly)
  COUNTDOWN_DATE: new Date('2025-03-04T00:00:00+09:00'),
  COUNTDOWN_LABEL: 'Next Chapter Release'
};

/* ════════════════════════════════════════
   THEME
════════════════════════════════════════ */
const html = document.documentElement;
const tt = document.getElementById('tt');

function setTheme(t){
  html.setAttribute('data-theme',t);
  localStorage.setItem('gkg-theme',t);
}
function toggleTheme(){
  const current = html.getAttribute('data-theme');
  const next = current === 'dark' ? 'light' : 'dark';
  setTheme(next);
}
tt.addEventListener('click', toggleTheme);
tt.addEventListener('keydown',e=>{ if(e.key==='Enter'||e.key===' '){e.preventDefault();tt.click();}});
setTheme(localStorage.getItem('gkg-theme')||'dark');

/* ════════════════════════════════════════
   COUNTDOWN — auto-calculates next 4th JST
════════════════════════════════════════ */
(function(){
  const bar = document.getElementById('cd-bar');
  const closeBtn = document.getElementById('cd-x');
  closeBtn.addEventListener('click',()=>{ bar.classList.add('hidden'); });

  // Base chapter: chapter 34 released March 4, 2024 JST
  const BASE_CHAPTER = 34;
  const BASE_DATE_JST = new Date('2024-03-04T00:00:00+09:00');

  function getNextTarget(){
    const nowUTC = Date.now();
    // Find the next 4th of any month at 00:00 JST (UTC+9 = UTC-9 offset)
    // Try current month's 4th, if past try next month
    const nowJST = new Date(nowUTC + 9*3600*1000); // approximate JST
    let y = nowJST.getUTCFullYear();
    let mo = nowJST.getUTCMonth(); // 0-indexed
    let candidate = new Date(Date.UTC(y, mo, 4) - 9*3600*1000); // 4th 00:00 JST in UTC
    if(nowUTC >= candidate.getTime() + 24*3600*1000){
      // Past 24h window, move to next month
      mo++;
      if(mo > 11){ mo=0; y++; }
      candidate = new Date(Date.UTC(y, mo, 4) - 9*3600*1000);
    }
    // Calculate chapter number
    const monthsDiff = (y - BASE_DATE_JST.getUTCFullYear())*12 + (mo - BASE_DATE_JST.getUTCMonth());
    const chapterNum = BASE_CHAPTER + monthsDiff;
    return { target: candidate, chapter: chapterNum, isReleased: (nowUTC >= candidate.getTime() && nowUTC < candidate.getTime()+24*3600*1000) };
  }

  const labelEl = document.querySelector('.cd-label');

  function tick(){
    const { target, chapter, isReleased } = getNextTarget();
    if(isReleased){
      if(labelEl) labelEl.textContent = `Chapter ${chapter} — RELEASED!`;
      document.getElementById('cd-d').textContent='✦✦';
      document.getElementById('cd-h').textContent='✦✦';
      document.getElementById('cd-m').textContent='✦✦';
      document.getElementById('cd-s').textContent='✦✦';
      return;
    }
    if(labelEl) labelEl.textContent = `Chapter ${chapter} Release`;
    let diff = target.getTime() - Date.now();
    if(diff < 0) diff = 0;
    const d = Math.floor(diff/86400000); diff%=86400000;
    const h = Math.floor(diff/3600000); diff%=3600000;
    const m = Math.floor(diff/60000); diff%=60000;
    const s = Math.floor(diff/1000);
    document.getElementById('cd-d').textContent=String(d).padStart(2,'0');
    document.getElementById('cd-h').textContent=String(h).padStart(2,'0');
    document.getElementById('cd-m').textContent=String(m).padStart(2,'0');
    document.getElementById('cd-s').textContent=String(s).padStart(2,'0');
  }
  tick(); setInterval(tick,1000);
})();

/* ════════════════════════════════════════
   TAB NAVIGATION
════════════════════════════════════════ */
const tabLinks = document.querySelectorAll('.tab');
const sections = document.querySelectorAll('.sec');
const subLinks = document.querySelectorAll('.sl-link');

// Track active subs per parent
const activeSubs = { manga:'gallery', news:'nfeed' };

function activateTab(tabId, scroll=true){
  sections.forEach(s=>s.classList.remove('active'));
  tabLinks.forEach(l=>l.classList.remove('active'));
  const sec = document.getElementById(tabId);
  if(sec) sec.classList.add('active');
  tabLinks.forEach(l=>{ if(l.dataset.tab===tabId) l.classList.add('active'); });
  subLinks.forEach(l=>l.classList.remove('active'));
  // Restore active sub
  if(activeSubs[tabId]){
    const sub = document.getElementById(activeSubs[tabId]);
    if(sub){ sub.classList.add('active'); }
    subLinks.forEach(l=>{ if(l.dataset.tab===tabId && l.dataset.sub===activeSubs[tabId]) l.classList.add('active'); });
    // Sync subnav buttons
    document.querySelectorAll('.sn-btn').forEach(b=>{ b.classList.toggle('active', b.dataset.sub===activeSubs[tabId] && b.dataset.parent===tabId); });
  }
  if(scroll){
    const nav = document.getElementById('nav');
    window.scrollTo({top: nav.offsetTop - 2, behavior:'smooth'});
  }
  // Load discord widget when relevant tabs open
  if(tabId==='theories') loadDiscordWidget();
}

tabLinks.forEach(l=>{
  l.addEventListener('click',e=>{
    e.preventDefault();
    activateTab(l.dataset.tab);
  });
});

subLinks.forEach(l=>{
  l.addEventListener('click',e=>{
    e.preventDefault();
    activeSubs[l.dataset.tab] = l.dataset.sub;
    activateTab(l.dataset.tab);
  });
});

// Subnav buttons
document.querySelectorAll('.sn-btn').forEach(b=>{
  b.addEventListener('click',()=>{
    const parent = b.dataset.parent;
    const sub = b.dataset.sub;
    activeSubs[parent] = sub;
    // Hide all subsections in this parent
    document.querySelectorAll(`#${parent} .subsec`).forEach(s=>s.classList.remove('active'));
    const target = document.getElementById(sub);
    if(target) target.classList.add('active');
    document.querySelectorAll(`#${parent} .sn-btn`).forEach(x=>x.classList.toggle('active',x===b));
  });
});

/* ════════════════════════════════════════
   DISCORD OAUTH2
════════════════════════════════════════ */
let dcUser = null;
let isMember = false;

function dcLogin(){
  // Store current tab to restore after OAuth
  localStorage.setItem('gkg-pretab', getCurrentTab());
  const redirectUri = encodeURIComponent(window.location.href.split('#')[0].split('?')[0]);
  const scope = encodeURIComponent('identify guilds');
  const url = `https://discord.com/api/oauth2/authorize?client_id=${CFG.DISCORD_CLIENT_ID}&redirect_uri=${redirectUri}&response_type=token&scope=${scope}`;
  window.location.href = url;
}

function getCurrentTab(){
  for(const s of sections){
    if(s.classList.contains('active')) return s.id;
  }
  return 'about';
}

async function fetchDiscordUser(token){
  const r = await fetch('https://discord.com/api/users/@me', {
    headers:{'Authorization':'Bearer '+token}
  });
  if(!r.ok) throw new Error('User fetch failed');
  return r.json();
}

async function checkGuildMembership(token){
  try{
    const r = await fetch('https://discord.com/api/users/@me/guilds', {
      headers:{'Authorization':'Bearer '+token}
    });
    if(!r.ok) return false;
    const guilds = await r.json();
    return guilds.some(g=>g.id===CFG.GUILD_ID);
  } catch(e){ return false; }
}

function setDcUser(user, member){
  dcUser = user; isMember = member;
  document.getElementById('dc-login-btn').style.display='none';
  document.getElementById('dc-user-wrap').style.display='block';

  const initials = (user.username||'U')[0].toUpperCase();
  document.getElementById('dc-uname').textContent = user.username||user.global_name||'User';

  if(user.avatar){
    const url = `https://cdn.discordapp.com/avatars/${user.id}/${user.avatar}.png?size=64`;
    const img = document.getElementById('dc-av-img');
    img.src=url; img.style.display='block';
    document.getElementById('dc-av-ph').style.display='none';
  } else {
    document.getElementById('dc-av-ph').textContent=initials;
  }
  if(member) document.getElementById('dc-dot').style.display='block';

  // Populate profile card
  populateProfileCard(user);
  updateGateUI();
  localStorage.setItem('gkg-dc-user', JSON.stringify(user));
  localStorage.setItem('gkg-dc-member', member?'1':'0');
}

function updateGateUI(){
  const loggedIn  = !!dcUser;
  const canPost   = loggedIn && isMember;
  const showGate  = !canPost; // gate = not able to post

  // ── Discussion ──
  const discGate = document.getElementById('disc-gate');
  const discForm = document.getElementById('disc-post-form');
  if(discGate) discGate.style.display = showGate ? 'block' : 'none';
  if(discForm) discForm.style.display = showGate ? 'none' : 'block';
  // Update discussion avatar when logged in
  if(loggedIn){
    const av = document.getElementById('disc-form-av');
    if(av) av.innerHTML = dcUser.avatar
      ? `<img src="https://cdn.discordapp.com/avatars/${dcUser.id}/${dcUser.avatar}.png?size=64" alt="">`
      : (dcUser.username||'U')[0].toUpperCase();
  }

  // ── Theories ──
  // Show gate if not logged in or not a member
  // Show form ONLY if logged in AND member
  const thGate = document.getElementById('theory-gate');
  const thForm = document.getElementById('theory-submit-form');
  if(thGate) thGate.style.display = showGate ? 'block' : 'none';
  if(thForm) thForm.style.display = canPost  ? 'block' : 'none';
  // Auto-fill read-only identity fields
  if(canPost){
    const unEl = document.getElementById('th-username');
    const dnEl = document.getElementById('th-displayname');
    const idEl = document.getElementById('th-userid');
    if(unEl){ unEl.value = dcUser.username || ''; }
    if(dnEl){ dnEl.value = dcUser.global_name || dcUser.username || ''; }
    if(idEl){ idEl.value = dcUser.id || ''; }
  }

  // ── Apply form ──
  const applyGate = document.getElementById('apply-gate');
  const applyForm = document.getElementById('apply-form');
  if(applyGate) applyGate.style.display = showGate ? 'block' : 'none';
  if(applyForm) applyForm.style.display = canPost  ? 'block' : 'none';
  if(loggedIn && document.getElementById('af-disc')){
    document.getElementById('af-disc').value = dcUser.username || '';
  }

  // ── Theories empty state ──
  const tList  = document.getElementById('theories-list');
  const tEmpty = document.getElementById('theories-empty');
  if(tList && tEmpty) tEmpty.style.display = tList.children.length === 0 ? 'block' : 'none';
}

// OAuth token from URL hash
(function handleOAuthRedirect(){
  const hash = window.location.hash;
  if(!hash) return;
  const params = new URLSearchParams(hash.substring(1));
  const token = params.get('access_token');
  if(!token) return;
  // Clean URL
  history.replaceState(null,null,window.location.pathname);
  localStorage.setItem('gkg-dc-token', token);
  // Restore tab
  const preTab = localStorage.getItem('gkg-pretab');
  if(preTab) activateTab(preTab, false);
  // Fetch user
  fetchDiscordUser(token).then(user=>{
    return checkGuildMembership(token).then(member=>{ setDcUser(user,member); });
  }).catch(()=>{ showToast('Discord login failed. Please try again.','err'); });
})();

// Restore from localStorage
(function restoreSession(){
  const token = localStorage.getItem('gkg-dc-token');
  const userData = localStorage.getItem('gkg-dc-user');
  if(token && userData){
    try{
      const user = JSON.parse(userData);
      const member = localStorage.getItem('gkg-dc-member')==='1';
      setDcUser(user,member);
      // Refresh member status in background
      checkGuildMembership(token).then(m=>{
        isMember=m;
        localStorage.setItem('gkg-dc-member',m?'1':'0');
        updateGateUI();
        populateProfileCard(dcUser);
        if(m) document.getElementById('dc-dot').style.display='block';
      });
    } catch(e){}
  } else {
    updateGateUI();
  }
})();

// Dropdown toggle
document.getElementById('dc-btn')?.addEventListener('click',e=>{
  e.stopPropagation();
  document.getElementById('dc-dd').classList.toggle('open');
});
document.addEventListener('click',()=> document.getElementById('dc-dd')?.classList.remove('open'));

document.getElementById('dc-login-btn')?.addEventListener('click',dcLogin);

document.getElementById('dc-logout')?.addEventListener('click',()=>{
  localStorage.removeItem('gkg-dc-token');
  localStorage.removeItem('gkg-dc-user');
  localStorage.removeItem('gkg-dc-member');
  dcUser=null; isMember=false;
  document.getElementById('dc-login-btn').style.display='flex';
  document.getElementById('dc-user-wrap').style.display='none';
  document.getElementById('dc-dd').classList.remove('open');
  updateGateUI();
  showToast('Logged out successfully.');
});

// Profile card — populate when user logs in
function populateProfileCard(user){
  const av = document.getElementById('dpc-av');
  if(av){
    if(user.avatar) av.innerHTML=`<img src="https://cdn.discordapp.com/avatars/${user.id}/${user.avatar}.png?size=128" alt="">`;
    else av.textContent=(user.global_name||user.username||'?')[0].toUpperCase();
  }
  const dn = document.getElementById('dpc-displayname');
  if(dn) dn.textContent = user.global_name || user.username || '—';
  const un = document.getElementById('dpc-username');
  if(un) un.textContent = '@'+(user.username||'—');
  const uid = document.getElementById('dpc-uid');
  if(uid) uid.textContent = user.id || '—';
  const joined = document.getElementById('dpc-joined');
  if(joined) joined.textContent = isMember ? 'Gokurakugai Community' : 'Not a server member';
  // Roles
  const rolesEl = document.getElementById('dpc-roles');
  if(rolesEl){
    rolesEl.innerHTML = '<span class="dpc-role dpc-role-member">Member</span>';
    if(isMember) rolesEl.innerHTML += ' <span class="dpc-role dpc-role-staff">Server Member</span>';
  }
}

/* ════════════════════════════════════════
   DISCORD WIDGET — count only
════════════════════════════════════════ */
let widgetLoaded = false;
function loadDiscordWidget(){
  if(widgetLoaded) return;
  widgetLoaded=true;
  const ctTargets = ['dc-online-ct'];
  fetch(CFG.WIDGET_API)
    .then(r=>r.json())
    .then(data=>{
      const count = data.presence_count || (data.members||[]).length;
      ctTargets.forEach(id=>{ const el=document.getElementById(id); if(el) el.textContent=count+' members online'; });
    })
    .catch(()=>{
      ctTargets.forEach(id=>{ const el=document.getElementById(id); if(el) el.textContent='Widget unavailable'; });
    });
}

/* ════════════════════════════════════════
   DISCUSSION SUBMIT
════════════════════════════════════════ */
const placeholderPosts = [];
function submitDiscussion(){
  if(!dcUser||!isMember){ showToast('You must be a server member to post.','err'); return; }
  const text = document.getElementById('disc-text').value.trim();
  const topic = document.getElementById('disc-topic').value;
  if(!text){ showToast('Please write something first.','err'); return; }
  const post = document.createElement('div');
  post.className='dp';
  const initials=(dcUser.username||'U')[0].toUpperCase();
  const avatarHtml = dcUser.avatar
    ? `<img src="https://cdn.discordapp.com/avatars/${dcUser.id}/${dcUser.avatar}.png?size=64" alt="">`
    : initials;
  post.innerHTML=`
    <div class="dp-top">
      <div class="dp-av">${avatarHtml}</div>
      <div><div class="dp-n">${escHtml(dcUser.username||'User')}</div><div class="dp-t">Just now · ${topic}</div></div>
    </div>
    <div class="dp-body">${escHtml(text)}</div>
    <div class="dp-acts"><button class="dp-act">♡ 0</button><button class="dp-act">↩ Reply</button></div>`;
  const list = document.getElementById('disc-posts');
  list.insertBefore(post, list.firstChild);
  document.getElementById('disc-text').value='';
  showToast('Comment posted!');
}

/* ════════════════════════════════════════
   THEORY SUBMIT & VOTING
════════════════════════════════════════ */
// Track votes per user per theory: Map<theoryId, 'up'|'down'>
const theoryVotes = new Map();
let theoryCounter = 0;

function submitTheory(){
  if(!dcUser||!isMember){ showToast('Server members only.','err'); return; }
  const title = document.getElementById('th-title').value.trim();
  const body  = document.getElementById('th-body').value.trim();
  const tag   = document.getElementById('th-tag').value;
  const agree = document.getElementById('th-agree').checked;
  if(!title||!body){ showToast('Please fill in title and theory.','err'); return; }
  if(!tag){ showToast('Please select a category.','err'); return; }
  if(!agree){ showToast('Please agree to the community guidelines.','err'); return; }

  const tid = 'th-' + (++theoryCounter);
  const el = document.createElement('div');
  el.className = 'th-gc';
  el.dataset.tid = tid;
  const spoilerBadge = document.getElementById('th-spoilers').checked
    ? '<span class="th-gc-cat" style="background:rgba(192,39,45,.2);color:var(--crimson-bright);border-color:rgba(192,39,45,.4);">⚠ Spoilers</span>' : '';
  const initScore = 1; // author's own upvote
  theoryVotes.set(dcUser.id + '_' + tid, 'up');
  const avatarHtml = dcUser.avatar
    ? `<img src="https://cdn.discordapp.com/avatars/${dcUser.id}/${dcUser.avatar}.png?size=64" alt="" style="width:100%;height:100%;object-fit:cover;">`
    : (dcUser.username||'U')[0].toUpperCase();
  el.innerHTML = `
    <div class="th-gc-top">
      <span class="th-gc-cat">${escHtml(tag)}</span>
      ${spoilerBadge}
    </div>
    <div class="th-gc-title">${escHtml(title)}</div>
    <div class="th-gc-body">${escHtml(body.substring(0,140))}${body.length>140?'...':''}</div>
    <div class="th-gc-meta">
      <div class="th-gc-av">${avatarHtml}</div>
      <span class="th-gc-footer">by ${escHtml(dcUser.username||'You')}</span>
      <span class="th-gc-date">· Just now</span>
    </div>
    <div class="th-gc-actions">
      <button class="th-vote-up active" onclick="castVote(this,'up','${tid}')" title="Upvote">▲ <span>1</span></button>
      <button class="th-vote-down" onclick="castVote(this,'down','${tid}')" title="Downvote">▼ <span>0</span></button>
      <span class="th-vote-score">1</span>
    </div>`;
  const list = document.getElementById('theories-list');
  list.insertBefore(el, list.firstChild);
  // Hide empty state
  const empty = document.getElementById('theories-empty');
  if(empty) empty.style.display = 'none';
  // Reset form
  ['th-title','th-body','th-evidence','th-chapters'].forEach(id=>{ const e=document.getElementById(id); if(e) e.value=''; });
  document.getElementById('th-tag').value='';
  document.getElementById('th-agree').checked=false;
  document.getElementById('th-spoilers').checked=false;
  document.getElementById('th-body-count').textContent='0';
  document.getElementById('th-ev-count').textContent='0';
  showToast('Theory submitted! ✦');
}

function castVote(btn, dir, tid){
  if(!dcUser){ showToast('Log in to vote.','err'); return; }
  const key = dcUser.id + '_' + tid;
  const card = btn.closest('.th-gc');
  const upBtn  = card.querySelector('.th-vote-up');
  const downBtn = card.querySelector('.th-vote-down');
  const scoreEl = card.querySelector('.th-vote-score');
  const upCount   = parseInt(upBtn.querySelector('span').textContent)||0;
  const downCount = parseInt(downBtn.querySelector('span').textContent)||0;
  const prevVote  = theoryVotes.get(key);

  let ups = upCount, downs = downCount;
  if(prevVote === dir){
    // Undo vote
    if(dir==='up') ups--; else downs--;
    theoryVotes.delete(key);
    upBtn.classList.remove('active');
    downBtn.classList.remove('active');
  } else {
    // Switch or new vote
    if(prevVote==='up') ups--;
    if(prevVote==='down') downs--;
    if(dir==='up'){ ups++; upBtn.classList.add('active'); downBtn.classList.remove('active'); }
    else          { downs++; downBtn.classList.add('active'); upBtn.classList.remove('active'); }
    theoryVotes.set(key, dir);
  }
  upBtn.querySelector('span').textContent = ups;
  downBtn.querySelector('span').textContent = downs;
  if(scoreEl) scoreEl.textContent = ups - downs;
}

function filterNews(btn, cat){
  document.querySelectorAll('.nf-btn').forEach(b=>b.classList.remove('active'));
  btn.classList.add('active');
  document.querySelectorAll('#news-grid .ngc, #news-grid .news-pinned').forEach(card=>{
    card.style.display = (cat==='all' || card.dataset.cat===cat) ? '' : 'none';
  });
}

function updateCount(textareaId, countId, max){
  const val = document.getElementById(textareaId)?.value.length || 0;
  document.getElementById(countId).textContent = val;
}


/* ════════════════════════════════════════
   STAFF APPLICATION
════════════════════════════════════════ */
async function submitApplication(e){
  e.preventDefault();
  if(!dcUser||!isMember){ showToast('Server members only.','err'); return; }
  const data = {
    discord: document.getElementById('af-disc').value,
    age: document.getElementById('af-age').value,
    timezone: document.getElementById('af-tz').value,
    position: document.getElementById('af-pos').value,
    tenure: document.getElementById('af-tenure').value,
    hours: document.getElementById('af-hours').value,
    experience: document.getElementById('af-exp').value,
    why: document.getElementById('af-why').value,
    scenario: document.getElementById('af-scenario').value,
    extra: document.getElementById('af-extra').value||'None'
  };
  const embed = {
    title:'📋 New Staff Application',
    color:0xC9A84C,
    fields:[
      {name:'Discord',value:data.discord,inline:true},
      {name:'Age',value:data.age,inline:true},
      {name:'Timezone',value:data.timezone,inline:true},
      {name:'Position',value:data.position,inline:true},
      {name:'Tenure in Community',value:data.tenure,inline:true},
      {name:'Hours/Week',value:data.hours,inline:true},
      {name:'Prior Experience',value:data.experience||'None',inline:false},
      {name:'Why They Want to Join',value:data.why,inline:false},
      {name:'Conflict Resolution Scenario',value:data.scenario,inline:false},
      {name:'Additional Notes',value:data.extra,inline:false}
    ],
    footer:{text:'Submitted via Gokurakugai Fan Site'},
    timestamp:new Date().toISOString()
  };
  if(CFG.WEBHOOK_URL && CFG.WEBHOOK_URL !== 'YOUR_WEBHOOK_URL_HERE'){
    try{
      await fetch(CFG.WEBHOOK_URL,{
        method:'POST',
        headers:{'Content-Type':'application/json'},
        body:JSON.stringify({embeds:[embed]})
      });
    }catch(err){
      showToast('Submission failed. Please try again.','err'); return;
    }
  }
  document.getElementById('apply-form').style.display='none';
  document.getElementById('apply-ok').style.display='block';
  showToast('Application submitted! ✦');
}

/* ════════════════════════════════════════
   STAFF MODAL DATA
════════════════════════════════════════ */
const STAFF_DATA = {
  m1:{img:'staff1.png',role:'Founder · Administrator',name:'Ichirou',handle:'@ichirou_gkg',badge:'Founder',
    about:'Ichirou founded the Gokurakugai Fan Community after discovering the series during its oneshot debut in 2020. A lifelong manga reader with a particular love for dark fantasy and atmospheric storytelling, they built this community from the ground up with the vision of creating a respectful, passionate, and creatively vibrant space for fans worldwide.',
    resp:'Oversees all aspects of community operation, sets long-term direction, manages staff team, handles escalated moderation cases, manages official partnerships and collaborations.',
    fav:'The relationship between Tao and Alma — specifically the way Sano conveys their dynamic through body language and visual storytelling rather than exposition.',
    tags:['Community Design','Moderation Policy','Partnerships','Long-form Analysis']},
  m2:{img:'staff2.png',role:'Co-Founder · Administrator',name:'Shirogane',handle:'@shirogane_gkg',badge:'Co-Founder',
    about:'Shirogane joined Ichirou as co-founder in the community\'s earliest days, bringing expertise in community management and a deep encyclopedic knowledge of the manga. They have been instrumental in shaping the community\'s culture of thoughtful, evidence-based discussion and creative enthusiasm.',
    resp:'Co-administers the community alongside Ichirou, manages the Discord server structure and channels, leads the theory and discussion culture, oversees event planning.',
    fav:'The worldbuilding. The way Sano has constructed the district as a living ecosystem of supernatural and human elements, with its own internal logic and history, is genuinely remarkable.',
    tags:['Worldbuilding Deep Dives','Discord Management','Event Planning','Theory Curation']},
  m3:{img:'staff8.png',role:'Administrator',name:'Kanzaki',handle:'@kanzaki_gkg',badge:'Admin',
    about:'Kanzaki joined the staff team as a moderator and quickly rose to administrator thanks to their exceptional consistency, level-headedness under pressure, and deep familiarity with community management challenges. They are often the first point of contact for complex moderation situations.',
    resp:'Handles day-to-day server administration, manages moderation escalations, maintains community documentation and rules, onboards new staff members.',
    fav:'The antagonists. Sano writes villains with genuine menace and internal logic — they\'re not evil for evil\'s sake, they have coherent worldviews that happen to collide catastrophically with the protagonists.',
    tags:['Escalation Management','Staff Training','Documentation','Conflict Resolution']},
  m4:{img:'staff3.png',role:'Senior Moderator',name:'Shiro',handle:'@shiro_gkg',badge:'Sr. Mod',
    about:'Shiro has been a community member since near the beginning and earned the Senior Moderator role through consistent, fair, and thorough moderation. Known for their patient and measured approach to difficult situations, Shiro serves as a mentor to newer moderators on the team.',
    resp:'Moderates all primary community channels, mentors junior moderators, handles spoiler violations and content flags, assists with event moderation.',
    fav:'The art direction. Every chapter has at least one panel that stops me completely — Sano\'s use of negative space and shadow to create atmosphere is unlike anything else in current shōnen.',
    tags:['Channel Moderation','Spoiler Enforcement','Mentorship','Visual Analysis']},
  m5:{img:'staff4.png',role:'Moderator',name:'Nagi',handle:'@nagi_gkg',badge:'Moderator',
    about:'Nagi brings a warm and welcoming energy to the moderation team, specializing in community engagement and making new members feel at home. Their approachable style helps de-escalate tensions before they become major issues.',
    resp:'Moderates community channels with a focus on tone and culture, welcomes new members, maintains community engagement, handles low-to-medium tier moderation cases.',
    fav:'Alma, obviously. Her character writing is so carefully balanced — genuinely terrifying potential, genuine sweetness, genuine loneliness. She\'s the emotional core of the whole series.',
    tags:['Community Engagement','New Member Welcome','Culture Maintenance']},
  m6:{img:'staff5.png',role:'Moderator',name:'Shinju',handle:'@shinju_gkg',badge:'Moderator',
    about:'Shinju is the community\'s unofficial food and aesthetics enthusiast — fittingly named after the series\' beloved dim sum restaurateur. They bring a creative eye to content curation and maintain the fan art channels with consistent enthusiasm.',
    resp:'Moderates fan art and creative content channels, curates gallery content, enforces artist credit policies, assists with community events and content contests.',
    fav:'The food. I\'m serious. Every time taiyaki appears in the manga I immediately need to eat. But also Shinju\'s restaurant scenes have some of the warmest linework in the whole series.',
    tags:['Fan Art Curation','Artist Credit Enforcement','Content Contests','Creative Events']},
  m7:{img:'staff6.png',role:'Moderator',name:'Kurona',handle:'@kurona_gkg',badge:'Moderator',
    about:'Kurona joined the staff team with a background in online community management and brings analytical rigor to moderation decisions. Known for thorough, documented approaches to complex situations, they are invaluable in cases that require careful review.',
    resp:'Handles moderation escalations requiring documentation, maintains the moderation log, reviews ban appeals, enforces platform ToS compliance.',
    fav:'The power system. The more I analyze it the more I\'m convinced Sano has everything meticulously planned — there are rules to how the supernatural works in this universe that are hinted at long before they\'re explained.',
    tags:['Documentation','Ban Appeals','ToS Compliance','Power System Analysis']},
  m8:{img:'staff7.png',role:'Content Creator',name:'Momo',handle:'@momo_gkg',badge:'Creator',
    about:'Momo is the community\'s lead content creator, responsible for social media posts, graphics, and community announcements. Their eye for design and knack for condensing complex information into engaging, shareable content has been instrumental in growing the community\'s social media presence.',
    resp:'Creates social media content for all platforms, designs community graphics and banners, writes announcement posts, manages content calendar.',
    fav:'The character designs. Each character is visually distinct and their outfits communicate so much about their personalities and roles before a single word of dialogue. Tao\'s whole look is just perfect.',
    tags:['Graphic Design','Social Media','Content Calendar','Announcements']},
  m9:{img:'staff9.png',role:'Content Creator',name:'Yomi',handle:'@yomi_gkg',badge:'Creator',
    about:'Yomi specializes in long-form written content — analysis articles, theory write-ups, and community newsletters. Their deep readings of the manga have become some of the community\'s most-shared content, drawing new readers and deepening existing fans\' appreciation of the series.',
    resp:'Writes featured analysis articles and theory posts, produces the community newsletter, creates long-form engagement content, assists with community documentation.',
    fav:'The themes. Gokurakugai is fundamentally about belonging and the cost of existing outside the boundaries of what society considers acceptable. As someone who thinks a lot about those questions, it hits differently.',
    tags:['Long-form Analysis','Theory Writing','Newsletter','Community Documentation']}
};

function openModal(id){
  const d = STAFF_DATA[id];
  if(!d) return;
  document.getElementById('m-img').src = d.img;
  document.getElementById('m-role').textContent = d.role;
  document.getElementById('m-name').textContent = d.name;
  document.getElementById('m-handle').textContent = d.handle;
  document.getElementById('m-badge').textContent = d.badge;
  document.getElementById('m-about').textContent = d.about;
  document.getElementById('m-resp').textContent = d.resp;
  document.getElementById('m-fav').textContent = d.fav;
  document.getElementById('m-tags').innerHTML = d.tags.map(t=>`<span class="m-tag">${t}</span>`).join('');
  document.getElementById('modal-overlay').classList.add('open');
  document.body.style.overflow='hidden';
}

function closeModal(){
  document.getElementById('modal-overlay').classList.remove('open');
  document.body.style.overflow='';
}

function closeModalOutside(e){
  if(e.target===document.getElementById('modal-overlay')) closeModal();
}

document.addEventListener('keydown',e=>{ if(e.key==='Escape') closeModal(); });

/* ════════════════════════════════════════
   TOAST
════════════════════════════════════════ */
let toastTimer;
function showToast(msg, type=''){
  const t = document.getElementById('toast');
  t.textContent=msg;
  t.className='show'+(type?' '+type:'');
  clearTimeout(toastTimer);
  toastTimer=setTimeout(()=>t.className='',3000);
}

/* ════════════════════════════════════════
   HELPERS
════════════════════════════════════════ */
function escHtml(s){ return s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;'); }

// Initial gate state
updateGateUI();

/* ════════════════════════════════════════
   COMMUNITY STATS
════════════════════════════════════════ */
(function loadCommunityStats(){
  // 1. Staff count — count live sc cards
  const staffCount = document.querySelectorAll('.sc').length;
  const statStaff = document.getElementById('stat-staff');
  if(statStaff) statStaff.textContent = staffCount || '9';

  // 2. Discord member count via widget
  fetch(CFG.WIDGET_API)
    .then(r=>r.json())
    .then(data=>{
      const el = document.getElementById('stat-discord');
      if(el){
        // approximate_member_count or presence_count
        const count = data.approximate_member_count || data.presence_count || '—';
        el.textContent = typeof count==='number' ? count.toLocaleString() : count;
      }
    })
    .catch(()=>{ const el=document.getElementById('stat-discord'); if(el) el.textContent='—'; });

  // 3. Chapter count — derive from current countdown logic
  // Use same BASE_CHAPTER + months formula as countdown
  (function(){
    const BASE_CHAPTER = 34;
    const BASE_DATE = new Date('2024-03-04T00:00:00+09:00');
    const now = new Date();
    const y = now.getUTCFullYear(), mo = now.getUTCMonth();
    const by = BASE_DATE.getUTCFullYear(), bmo = BASE_DATE.getUTCMonth();
    const monthsDiff = (y - by)*12 + (mo - bmo);
    // Check if this month's 4th has passed JST
    const thisFourth = new Date(Date.UTC(y, mo, 4) - 9*3600*1000);
    const chapter = BASE_CHAPTER + monthsDiff + (Date.now() >= thisFourth.getTime() ? 0 : -1);
    const el = document.getElementById('stat-chapters');
    if(el) el.textContent = Math.max(chapter, BASE_CHAPTER);
  })();

  // 4. Volume count — stored as constant; update when known
  // Currently 6 volumes. We attempt a CORS-safe fetch via a proxy-free approach.
  // Since Amazon Japan blocks direct fetching, we use a known reliable fallback.
  // The value is set in HTML as 6; update below only if we can confirm higher.
  const volEl = document.getElementById('stat-volumes');
  if(volEl && !volEl.dataset.set){
    // Try fetching MangaPlus title page to count volumes
    fetch('https://api.allorigins.win/raw?url=' + encodeURIComponent('https://mangaplus.shueisha.co.jp/titles/100230'), {signal: AbortSignal.timeout(5000)})
      .then(r=>r.text())
      .then(text=>{
        // Look for volume count patterns
        const match = text.match(/(\d+)\s*(?:巻|volumes?)/i);
        if(match && parseInt(match[1]) >= 6){
          volEl.textContent = parseInt(match[1]);
        }
      })
      .catch(()=>{/* keep default 6 */});
    }
})();

/* ════════════════════════════════════════
   MOBILE NAVIGATION
════════════════════════════════════════ */
(function(){
  const menuBtn  = document.getElementById('mob-menu-btn');
  const drawerOv = document.getElementById('mob-drawer-ov');
  const drawer   = document.getElementById('mob-drawer');

  if(!menuBtn || !drawer) return;

  function openMobDrawer(){
    drawer.classList.add('open');
    drawerOv.classList.add('open');
    document.body.style.overflow='hidden';
  }
  window.closeMobDrawer = function(){
    drawer.classList.remove('open');
    drawerOv.classList.remove('open');
    document.body.style.overflow='';
  };
  window.openMobDrawer = openMobDrawer;

  menuBtn.addEventListener('click', openMobDrawer);

  // Clone desktop controls (theme toggle + Discord) into drawer footer
  const desktopCtrl = document.querySelector('.nav-ctrl');
  const drawerCtrl  = document.getElementById('mob-drawer-ctrl');
  if(desktopCtrl && drawerCtrl){

  // Clone controls safely
  const clone = desktopCtrl.cloneNode(true);
  drawerCtrl.innerHTML = '';
  drawerCtrl.appendChild(clone);

  // ── Re-wire Theme Toggle ──
  const cloneTrack = drawerCtrl.querySelector('.tt-track');
if(cloneTrack){
  cloneTrack.addEventListener('click', toggleTheme);
}

  // ── Re-wire Discord Login ──
  const cloneLoginBtn = drawerCtrl.querySelector('#dc-login-btn');
  if(cloneLoginBtn){
    cloneLoginBtn.addEventListener('click', dcLogin);
  }

  // ── Re-wire Discord Dropdown ──
  const cloneDcBtn = drawerCtrl.querySelector('#dc-btn');
  const cloneDcDd  = drawerCtrl.querySelector('#dc-dd');

  if(cloneDcBtn && cloneDcDd){
    cloneDcBtn.addEventListener('click', e=>{
      e.stopPropagation();
      cloneDcDd.classList.toggle('open');
    });

    document.addEventListener('click', ()=>{
      cloneDcDd.classList.remove('open');
    });
  }

  // ── Re-wire Logout ──
  const cloneLogout = drawerCtrl.querySelector('#dc-logout');
  if(cloneLogout){
    cloneLogout.addEventListener('click', ()=>{
      localStorage.removeItem('gkg-dc-token');
      localStorage.removeItem('gkg-dc-user');
      localStorage.removeItem('gkg-dc-member');
      dcUser=null; 
      isMember=false;

      updateGateUI();
      showToast('Logged out successfully.');
    });
  }
}

  // Helper: sync mobile active state
  function syncMobActive(tab){
    document.querySelectorAll('.mob-nav-item').forEach(i=>{
      i.classList.toggle('active', i.dataset.tab===tab);
    });
  }

  // Wire non-submenu items
  document.querySelectorAll('.mob-nav-item:not(.has-sub)').forEach(item=>{
    item.addEventListener('click', ()=>{
      const tab = item.dataset.tab;
      if(!tab) return;
      syncMobActive(tab);
      if(typeof activateTab==='function') activateTab(tab);
      closeMobDrawer();
    });
  });

  // Wire Manga submenu toggle
  const mangaItem = document.querySelector('.mob-nav-item.has-sub');
  if(mangaItem){
    mangaItem.querySelector('.mob-nav-row').addEventListener('click', e=>{
      e.stopPropagation();
      const sub = document.getElementById('mob-manga-sub');
      const isOpen = mangaItem.classList.contains('sub-open');
      mangaItem.classList.toggle('sub-open', !isOpen);
      if(sub) sub.style.display = isOpen ? 'none' : 'block';
    });
  }

  // Wire sub-items (Gallery, Characters)
  document.querySelectorAll('.mob-sub-item').forEach(si=>{
    si.addEventListener('click', ()=>{
      const tab = si.dataset.tab;
      const sub = si.dataset.sub;
      syncMobActive(tab);
      if(typeof activateTab==='function') activateTab(tab);
      // Switch to correct sub-section
      setTimeout(()=>{
        document.querySelectorAll('.sn-btn').forEach(b=>{
          b.classList.toggle('active', b.dataset.sub===sub && b.dataset.parent===tab);
        });
        document.querySelectorAll('#manga .subsec').forEach(s=>s.classList.remove('active'));
        const target = document.getElementById(sub);
        if(target) target.classList.add('active');
      }, 50);
      closeMobDrawer();
    });
  });

  // Keep mobile active state in sync when desktop tabs are clicked
  document.querySelectorAll('a.tab[data-tab], button.tab[data-tab]').forEach(el=>{
    el.addEventListener('click', ()=> syncMobActive(el.dataset.tab));
  });
})();

/* ════════════════════════════════════════
   NEWS RENDERING SYSTEM
   No placeholders — only add real articles
   via addNewsArticle() / addNewsArticles()
════════════════════════════════════════ */
const NEWS_DB = [
  /* Add real articles here when ready:
  {
    id: 'news-001',
    cat: 'announcement',        // chapter|announcement|community|official
    pinned: false,
    badge: 'ANNOUNCEMENT',
    badgeColor: '#2ECC71',
    heroEmoji: '🎉',
    heroGrad: 'linear-gradient(135deg,#1a2a10,#2ECC71)',
    title: 'Article Title',
    excerpt: 'Short preview...',
    author: 'AuthorName',
    authorInit: 'A',
    date: 'March 2025',
    readTime: '3 min',
    tags: ['Tag1'],
    likes: 0,
    comments: 0,
    body: `<p>Full article content...</p>`,
    commentsData: []
  }
  */
];

const ARTICLE_DB = [
  /* Add real articles for the Articles tab here:
  {
    id: 'art-001',
    badge: 'ANALYSIS',
    heroEmoji: '🏛',
    title: 'Article Title',
    author: 'Author',
    authorInit: 'A',
    date: 'Jan 2025',
    readTime: '8 min',
    likes: 0,
    comments_count: 0,
    body: `<p>...</p>`,
    comments: []
  }
  */
];

function renderNewsGrid(){
  const grid  = document.getElementById('news-grid');
  const empty = document.getElementById('news-empty');
  if(!grid) return;
  grid.innerHTML = '';
  const articles = NEWS_DB;
  if(!articles.length){
    if(empty) empty.style.display = 'block';
    return;
  }
  if(empty) empty.style.display = 'none';

  // Sort: pinned first, then by date order
  const pinned  = articles.filter(a=>a.pinned);
  const regular = articles.filter(a=>!a.pinned);

  pinned.forEach(a=>{ grid.insertAdjacentHTML('beforeend', renderPinnedCard(a)); });
  regular.forEach(a=>{ grid.insertAdjacentHTML('beforeend', renderNewsCard(a)); });

  // Attach click handlers
  grid.querySelectorAll('[data-article-id]').forEach(el=>{
    el.addEventListener('click', e=>{
      if(e.target.closest('.ngc-share-btn')) return; // don't open modal on share click
      const id = el.dataset.articleId;
      const art = NEWS_DB.find(a=>a.id===id) || ARTICLE_DB.find(a=>a.id===id);
      if(art) openArtModal(id, art);
    });
  });

  // Attach share handlers
  grid.querySelectorAll('.ngc-share-btn').forEach(btn=>{
    btn.addEventListener('click', e=>{
      e.stopPropagation();
      handleShare(btn);
    });
  });
}

function renderArticlesGrid(){
  const grid  = document.getElementById('articles-grid');
  const empty = document.getElementById('articles-empty');
  if(!grid) return;
  grid.innerHTML = '';
  if(!ARTICLE_DB.length){
    if(empty) empty.style.display = 'block';
    return;
  }
  if(empty) empty.style.display = 'none';
  ARTICLE_DB.forEach(a=>{ grid.insertAdjacentHTML('beforeend', renderNewsCard(a, true)); });
  grid.querySelectorAll('[data-article-id]').forEach(el=>{
    el.addEventListener('click', e=>{
      if(e.target.closest('.ngc-share-btn')) return;
      const art = ARTICLE_DB.find(a=>a.id===el.dataset.articleId);
      if(art) openArtModal(el.dataset.articleId, art);
    });
  });
}

function renderPinnedCard(a){
  const shareUrl = encodeURIComponent(window.location.href + '#' + a.id);
  return `
  <div class="news-pinned" data-article-id="${a.id}" data-cat="${a.cat||''}">
    <span class="news-pin-badge">📌 PINNED</span>
    <div class="news-pin-img">
      <div class="news-pin-img-bg" style="background:${a.heroGrad||'linear-gradient(135deg,#3a0505,#C0272D)'};display:flex;align-items:center;justify-content:center;">
        <span style="font-size:5rem;opacity:.38;">${a.heroEmoji||'📕'}</span>
      </div>
      <div class="news-pin-timer">⏱ ${a.readTime||'5 min'} read</div>
    </div>
    <div class="news-pin-content">
      <div class="news-pin-badges">
        <span class="nb nb-featured">${a.badge||'NEWS'}</span>
        <span class="nb nb-ep">★ FEATURED</span>
      </div>
      <div class="news-pin-title">${escHtml(a.title)}</div>
      <div class="news-pin-body">${escHtml(a.excerpt||'')}</div>
      <div class="news-pin-author">
        <div class="news-pin-av">${a.authorInit||'?'}</div>
        <span class="news-pin-aname">${escHtml(a.author||'Author')}</span>
        <span class="news-pin-date">· ${a.date||''}</span>
        <div class="news-pin-stats">♡ ${a.likes||0} &nbsp; 💬 ${a.comments||0}</div>
      </div>
      <div style="margin-top:.8rem;display:flex;gap:.6rem;align-items:center;flex-wrap:wrap;">
        <button class="ngc-read-btn" style="margin:0;">Read More →</button>
        <div class="ngc-share" style="position:static;display:flex;gap:.4rem;">
          <button class="ngc-share-btn" data-share="x" data-url="${shareUrl}" data-title="${encodeURIComponent(a.title)}" title="Share on X" style="background:#1DA1F2;">𝕏</button>
          <button class="ngc-share-btn" data-share="discord" data-url="${shareUrl}" title="Share on Discord" style="background:#5865F2;">🎮</button>
          <button class="ngc-share-btn" data-share="copy" data-url="${decodeURIComponent(shareUrl)}" title="Copy link" style="background:#555;">🔗</button>
        </div>
      </div>
    </div>
  </div>`;
}

function renderNewsCard(a, isArticle=false){
  const shareUrl = encodeURIComponent(window.location.href + '#' + a.id);
  return `
  <div class="ngc" data-cat="${a.cat||''}" data-article-id="${a.id}">
    <div class="ngc-img">
      <div class="ngc-img-inner" style="background:${a.heroGrad||'linear-gradient(135deg,#1a0505,var(--accent))'};display:flex;align-items:center;justify-content:center;">
        <span style="font-size:3rem;opacity:.35;">${a.heroEmoji||'📰'}</span>
      </div>
      <span class="ngc-badge" style="background:${a.badgeColor||'var(--accent)'};">${a.badge||'NEWS'}</span>
      <div class="ngc-share">
        <button class="ngc-share-btn" data-share="x" data-url="${shareUrl}" data-title="${encodeURIComponent(a.title)}" title="Share on X" style="background:#1DA1F2;">𝕏</button>
        <button class="ngc-share-btn" data-share="discord" data-url="${shareUrl}" title="Share on Discord" style="background:#5865F2;">🎮</button>
        <button class="ngc-share-btn" data-share="copy" data-url="${decodeURIComponent(shareUrl)}" title="Copy link" style="background:#555;">🔗</button>
      </div>
      <div class="ngc-timer">⏱ ${a.readTime||'5 min'}</div>
    </div>
    <div class="ngc-body">
      <div class="ngc-meta">
        <div class="ngc-av">${a.authorInit||'?'}</div>
        <span class="ngc-author">${escHtml(a.author||'Author')}</span>
        <span class="ngc-date">· ${a.date||''}</span>
      </div>
      <div class="ngc-title">${escHtml(a.title)}</div>
      <div class="ngc-excerpt">${escHtml(a.excerpt||'')}</div>
      ${(a.tags||[]).length ? `<div class="ngc-tags">${a.tags.map(t=>`<span class="ngc-tag">${escHtml(t)}</span>`).join('')}</div>` : ''}
      <div class="ngc-footer">
        <span class="ngc-likes">♡ ${a.likes||0} &nbsp; 💬 ${a.comments||0}</span>
        <button class="ngc-read-btn">Read More →</button>
      </div>
    </div>
  </div>`;
}

function handleShare(btn){
  const type = btn.dataset.share;
  const url  = btn.dataset.url ? decodeURIComponent(btn.dataset.url) : window.location.href;
  const title = btn.dataset.title ? decodeURIComponent(btn.dataset.title) : 'Gokurakugai Community';
  if(type === 'x'){
    window.open(`https://x.com/intent/tweet?text=${encodeURIComponent(title)}&url=${encodeURIComponent(url)}`, '_blank', 'width=600,height=450');
  } else if(type === 'discord'){
    navigator.clipboard.writeText(url).then(()=>showToast('Link copied — paste it in Discord!')).catch(()=>showToast('Copy failed','err'));
  } else if(type === 'copy'){
    navigator.clipboard.writeText(url).then(()=>showToast('Link copied!')).catch(()=>showToast('Copy failed','err'));
  }
}

// Render grids on load
renderNewsGrid();
renderArticlesGrid();

// Show theories empty state on load
(function(){
  const list = document.getElementById('theories-list');
  const empty = document.getElementById('theories-empty');
  if(list && empty) empty.style.display = list.children.length===0 ? 'block' : 'none';
})();

// Open article modal with dynamic data
function openArtModal(id, data){
  const d = data;
  if(!d) return;
  const ov = document.getElementById('art-modal-ov');
  document.getElementById('am-hero-bg').innerHTML = `<span>${d.heroEmoji||'📰'}</span>`;
  document.getElementById('am-badges').innerHTML = `<span class="nb nb-featured">${d.badge||'NEWS'}</span>`;
  document.getElementById('am-title').textContent = d.title;
  document.getElementById('am-av').textContent = d.authorInit||'?';
  document.getElementById('am-name').textContent = d.author||'Author';
  document.getElementById('am-date').innerHTML = `${d.date||''} &nbsp;·`;
  document.getElementById('am-read').innerHTML = `⏱ ${d.readTime||d.read||'5 min read'}`;
  document.getElementById('am-stats').innerHTML = `<span>♡ ${d.likes||0}</span><span>💬 ${(d.commentsData||d.comments_count||d.comments||0)}</span>`;
  document.getElementById('am-body').innerHTML = d.body || '<p>Full article content coming soon.</p>';

  const comments = d.commentsData || d.comments || [];
  const commentsList = document.getElementById('am-comments-list');
  const commentsTitle = document.getElementById('am-comments-title');
  const commentCount = Array.isArray(comments) ? comments.length : (typeof comments === 'number' ? comments : 0);
  commentsTitle.innerHTML = `💬 Comments (${commentCount})`;
  if(Array.isArray(comments)){
    commentsList.innerHTML = comments.map(c=>`
      <div class="ac">
        <div class="ac-top">
          <div class="ac-av">${c.init||'?'}</div>
          <div class="ac-name">${escHtml(c.name||'User')}</div>
          ${c.role ? `<span class="ac-role ${c.role==='Staff'?'staff':''}">${c.role}</span>` : ''}
          <div class="ac-date">${c.date||''}</div>
        </div>
        <div class="ac-body">${escHtml(c.body||'')}</div>
        <div class="ac-acts">
          <button class="ac-act">♡ ${c.likes||0}</button>
          <button class="ac-act">↩ Reply</button>
        </div>
      </div>`).join('');
  }

  // Comment form
  const formWrap = document.getElementById('am-comment-form');
  if(dcUser && isMember){
    formWrap.innerHTML = `
      <div style="margin-bottom:.6rem;font-family:'Cinzel',serif;font-size:.65rem;letter-spacing:.14em;color:var(--accent);text-transform:uppercase;">Leave a Comment</div>
      <textarea class="art-comment-input" id="am-comment-text" placeholder="Share your thoughts on this article..."></textarea>
      <button class="btn btn-p btn-sm" onclick="submitArtComment('${id}')">Post Comment</button>`;
  } else if(dcUser && !isMember){
    formWrap.innerHTML = `
      <div class="art-disc-cta">
        <p>Join the Discord server to comment.</p>
        <a href="https://x.com/i/communities/1923913403464286699" target="_blank" class="btn btn-p">🎮 Join Server</a>
      </div>`;
  } else {
    formWrap.innerHTML = `
      <div class="art-disc-cta">
        <p>Log in with Discord to join the discussion.</p>
        <button class="btn btn-dc" onclick="dcLogin()">Login with Discord</button>
      </div>`;
  }

  // Share bar
  const shareUrl = encodeURIComponent(window.location.href + '#' + id);
  document.querySelectorAll('.art-share-btn').forEach((btn,i)=>{
    btn.onclick = null;
    if(i===0) btn.onclick=()=>window.open(`https://x.com/intent/tweet?text=${encodeURIComponent(d.title)}&url=${encodeURIComponent(window.location.href+'#'+id)}`, '_blank','width=600,height=450');
    if(i===1) btn.onclick=()=>navigator.clipboard.writeText(window.location.href+'#'+id).then(()=>showToast('Link copied — paste it in Discord!'));
    if(i===2) btn.onclick=()=>navigator.clipboard.writeText(window.location.href+'#'+id).then(()=>showToast('Link copied!'));
  });

  ov.classList.add('open');
  document.body.style.overflow='hidden';
  setTimeout(()=>{ document.getElementById('art-modal-box').scrollTop=0; },10);
}
</script>
<!-- ════ ARTICLE MODAL ════ -->
<div class="art-modal-ov" id="art-modal-ov" onclick="closeArtModalOutside(event)">
  <div class="art-modal" id="art-modal-box">
    <button class="art-modal-close" onclick="closeArtModal()">✕</button>
    <div class="art-modal-hero">
      <div class="art-modal-hero-bg" id="am-hero-bg"></div>
      <div class="art-modal-hero-overlay"></div>
      <div class="art-modal-hero-content">
        <div class="art-modal-badges" id="am-badges"></div>
        <div class="art-modal-title" id="am-title"></div>
      </div>
    </div>
    <div class="art-modal-meta-bar">
      <div class="am-av" id="am-av">?</div>
      <div>
        <div class="am-name" id="am-name"></div>
        <div class="am-date" id="am-date"></div>
      </div>
      <div class="am-read" id="am-read"></div>
      <div class="am-stats" id="am-stats"></div>
    </div>
    <div class="art-modal-body" id="am-body"></div>
    <div class="art-share-bar">
      <span class="art-share-label">Share This Post</span>
      <div class="art-share-btns">
        <button class="art-share-btn" title="Share on X">𝕏</button>
        <button class="art-share-btn" title="Share on Discord">🎮</button>
        <button class="art-share-btn" title="Copy link" onclick="showToast('Link copied!')">🔗</button>
      </div>
    </div>
    <div class="art-comments" id="am-comments-wrap">
      <div class="art-comments-title" id="am-comments-title">💬 Comments</div>
      <div id="am-comments-list"></div>
    </div>
    <div class="art-comment-form" id="am-comment-form">
      <!-- filled by JS based on member status -->
    </div>
  </div>
</div>

<script>
function submitArtComment(articleId){
  if(!dcUser||!isMember){ showToast('Server members only.','err'); return; }
  const text = document.getElementById('am-comment-text').value.trim();
  if(!text){ showToast('Please write something.','err'); return; }
  const list = document.getElementById('am-comments-list');
  const el = document.createElement('div');
  el.className='ac';
  const avatarHtml = dcUser.avatar
    ? `<img src="https://cdn.discordapp.com/avatars/${dcUser.id}/${dcUser.avatar}.png?size=64" alt="">`
    : (dcUser.username||'U')[0].toUpperCase();
  el.innerHTML=`
    <div class="ac-top">
      <div class="ac-av">${avatarHtml}</div>
      <div class="ac-name">${escHtml(dcUser.username||'You')}</div>
      <div class="ac-date">Just now</div>
    </div>
    <div class="ac-body">${escHtml(text)}</div>
    <div class="ac-acts">
      <button class="ac-act">♡ 0</button>
      <button class="ac-act">↩ Reply</button>
    </div>`;
  list.appendChild(el);
  document.getElementById('am-comment-text').value='';
  const t = document.getElementById('am-comments-title');
  const num = (t.textContent.match(/\d+/)||[0])[0];
  t.innerHTML = `💬 Comments (${parseInt(num)+1})`;
  showToast('Comment posted!');
}
function closeArtModal(){
  document.getElementById('art-modal-ov').classList.remove('open');
  document.body.style.overflow='';
}
function closeArtModalOutside(e){
  if(e.target===document.getElementById('art-modal-ov')) closeArtModal();
}
</script>
